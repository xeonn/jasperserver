TouchController=function(t,e,i){if(this.element=t,this.parent=e,this.children=[],this.hbar=null,this.vbar=null,i=i||{},this.element.style.position=i.absolute?"absolute":"relative",this.useParent=this.observer=i.useParent?e:t,this.translate3d=i.translate3d!==!1?!0:!1,this.forceLayout=i.forceLayout!==!0?!1:!0,this.use2Fingers=i.use2Fingers!==!0?!1:!0,this.fit=i.fit,i.debug&&(e.style.border="solid 1px #f00",t.style.border="solid 1px #00f"),this.translate3d&&!i.noInit3d){var s=jQuery(t).position();t.style.webkitTransform="translate3d("+s.left+"px,"+s.top+"px,0)",t.style.top="",t.style.left=""}if(i.scrollbars===!0){var h=jQuery('<div style="position:absolute;bottom:4px;left:0;right:0;"><div style="position:relative;background:#3fb8fa;min-height:4px;width:24px;opacity:0.4;"></div></div>').appendTo(e),n=jQuery('<div style="position:absolute;top:0;bottom:0;right:4px;"><div style="position:relative;background:#3fb8fa;min-width:4px;height:24px;opacity:0.4;"></div></div>').appendTo(e);this.hbar=h.children().eq(0),this.vbar=n.children().eq(0)}this.computeBoundaries(),this.dragging=!1,this.drag_sensitivity=20,this.scale=1,this.element.style.top=0,this.element.style.left=0,this.maxX=0,this.maxY=0,this.startTouchY=0,this.startTouchX=0,this.contentOffsetX=0,this.contentOffsetY=0,this.observer.addEventListener("touchstart",this,!1),this.observer.addEventListener("touchmove",this,!1),this.observer.addEventListener("touchend",this,!1)},TouchController.prototype.handleEvent=function(t){switch(t.type){case"touchstart":this.onTouchStart(t);break;case"touchmove":this.onTouchMove(t);break;case"touchend":this.onTouchEnd(t)}},TouchController.prototype.computeBoundaries=function(){this.maxX=this.parent.clientWidth-this.element.clientWidth,this.maxY=this.parent.clientHeight-this.element.clientHeight,this.maxX=this.maxX<0?this.maxX:0,this.maxY=this.maxY<0?this.maxY:0,this.hbar&&0!==this.maxX?(this.hratio=this.parent.clientWidth/this.element.clientWidth,this.hbar.width(this.hratio*this.parent.clientWidth),this.hbar.show()):this.hbar&&this.hbar.hide(),this.vbar&&0!==this.maxY?(this.vratio=this.parent.clientHeight/this.element.clientHeight,this.vbar.height(this.vratio*this.parent.clientHeight),this.vbar.show()):this.vbar&&this.vbar.hide(),0===this.maxX&&0===this.maxY&&(this.element.style.minWidth=this.parent.clientWidth+"px",this.element.style.minHeight=this.parent.clientHeight+"px","reportContainer"===this.element.id&&(this.element.style.maxWidth=this.parent.clientWidth+"px",this.element.style.maxHeight=this.parent.clientHeight+"px"))},TouchController.prototype.onTouchStart=function(t){this.scale_pre=!1,this.computeBoundaries(),this.startTouchX=t.touches[0].clientX,this.startTouchY=t.touches[0].clientY,this.contentStartOffsetX=this.contentOffsetX,this.contentStartOffsetY=this.contentOffsetY},TouchController.prototype.onTouchMove=function(t){var e=t.touches[0].clientY,i=t.touches[0].clientX;(!this.use2Fingers||this.use2Fingers&&2==t.touches.length)&&(this.dragging?this.animateTo(i,e):this.isDragging(t)&&(TouchController.element_scrolled=!0,this.forceLayout&&(this.element.style.top=0,this.element.style.webkitTransform="translate3d(0,"+this.contentOffsetY+"px,0)"),this.animateTo(i,e)))},TouchController.prototype.onTouchEnd=function(t){this.dragging&&(this.forceLayout&&(this.element.style.webkitTransform="translate3d(0,0,0)",this.element.style.top=this.contentOffsetY+"px"),this.hbar&&this.hbar.hide(),this.vbar&&this.vbar.hide(),t.preventDefault(),this.shouldStartMomentum()),this.dragging=!1},TouchController.prototype.animateTo=function(t,e){var i=t-this.startTouchX,s=e-this.startTouchY,h=i+this.contentStartOffsetX,n=s+this.contentStartOffsetY,o=jQuery(this.element).position();this.translate3d?(h>0&&(h=0),n>0&&(n=0),h<this.maxX&&(h=this.maxX),n<this.maxY&&(n=this.maxY)):(h+o.left>0&&(h=-1*o.left),n+o.top>0&&(n=-1*o.top),o.left+h<this.maxX&&(h=this.maxX-o.left),o.top+n<this.maxY&&(n=this.maxY-o.top)),this.contentOffsetX=h,this.contentOffsetY=n,this.translate3d||this.use2Fingers?this.element.style.webkitTransform="scale("+this.scale+") translate3d("+h+"px,"+n+"px, 0)":(this.element.style.top=o.top+n+"px",this.element.style.left=o.left+h+"px"),this.hbar&&this.hbar.css("left",-1*h*this.hratio+"px"),this.vbar&&this.vbar.css("top",-1*n*this.vratio+"px")},TouchController.prototype.isDragging=function(t){var e=t.touches[0].clientX-this.startTouchX,i=t.touches[0].clientY-this.startTouchY,s=Math.abs(e),h=Math.abs(i);return this.dragging=s>this.drag_sensitivity||h>this.drag_sensitivity?!0:!1,this.dragging},TouchController.prototype.shouldStartMomentum=function(){return!1},TouchController.prototype.reset=function(){offsetX=this.contentOffsetX,offsetY=this.contentOffsetY,this.maxX=this.parent.clientWidth-this.element.clientWidth,this.maxY=this.parent.clientHeight-this.element.clientHeight,this.translate3d?(this.element.style.webkitTransform="scale("+this.scale+") translate3d("+offsetX+"px,"+offsetY+"px, 0)",this.element.style.webkitTransform="scale("+this.scale+") translate3d(0,0,0)",this.contentOffsetX=0,this.contentOffsetY=0):(this.element.style.top=0,this.element.style.left=0)},TouchController.prototype.forceRefresh=function(){},TouchController.prototype.isBottom=function(){return this.maxY>=0?!1:this.contentOffsetY-this.maxY<10},TouchController.prototype.addPadding=function(t,e){var i=jQuery("#"+t).width()+e.right,s=jQuery("#"+t).height()+e.bottom;this.element.style.width=i+"px",this.element.style.height=s+"px"};