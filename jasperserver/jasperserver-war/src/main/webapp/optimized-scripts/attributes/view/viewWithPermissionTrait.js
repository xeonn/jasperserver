define(["require","underscore","serverSettingsCommon/enum/confirmDialogTypesEnum","attributes/enum/permissionMasksEnum"],function(e){var i=e("underscore"),n=e("serverSettingsCommon/enum/confirmDialogTypesEnum"),s=e("attributes/enum/permissionMasksEnum"),o={1:1,2:2,32:3,0:4};return{_onViewInitialize:function(){this.listenTo(this.model,"change:_embedded",i.bind(this._onPermissionChange,this))},_onViewRender:function(){var e=this.model.get("inherited"),n=this.model.getPermission(),o=n&&n.mask,t=i.isNumber(o)?o:this.model.get("permissionMask");if(e&&t!==s.ADMINISTRATOR){var r=this.$el.find("option:selected");r.prevAll().attr("disabled","disabled")}},_onPermissionChange:function(e,i){var n=o[e.getPermission(i).mask],s=e.getState("confirmedState"),t=o[e.getPermission(s._embedded).mask];this._showPermissionConfirm(!1),this.modelChanged._embedded&&n>t?this.editMode?this._showPermissionConfirm(!0):this._openPermissionConfirm():!this.editMode&&e.setState("confirmedState")},_showPermissionConfirm:function(e){this.permissionConfirmShouldBeShown=e},_openPermissionConfirm:function(e){this.trigger("open:confirm",n.PERMISSION_CONFIRM,e||{})}}});