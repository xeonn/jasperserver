function DragListener(){this.agents=[],this.currentAgentName=null,this.dragger}function Dragger(i,t,r,e,g,n,s){var i=i?i:event;this.originalX=new Array,this.originalY=new Array,this.draggingObjs=t,this.dragsX=r,this.dragsY=e,this.sigMove=g,this.dragListener=n,this.cleanUpUtil=s,this.dragListener&&(this.dragListener.dragger=this);for(var a=0;a<t.length;a++)this.originalX[a]=parseInt(t[a].style.left),this.originalY[a]=parseInt(t[a].style.top);this.mouseX=i.clientX,this.mouseY=i.clientY,this.isDragging=!1,this.initDragger(i)}DragListener.DRAGGING_STARTED="draggingStarted",DragListener.DRAGGING_FINISHED="draggingFinished",DragListener.DRAGGING="dragging",DragListener.prototype.registerAgent=function(i){this.agents[i]=new Array},DragListener.prototype.publishEvent=function(i,t,r){this.agents[i][t]=r},DragListener.prototype.notify=function(i,t){var r=this.agents[this.currentAgentName];if(r){var e=r[i];if(e){var g=this.dragger?this.dragger.draggingObjs:null;e(t,g)}}},DragListener.prototype.isDragging=function(){return null!=this.currentAgentName},DragListener.prototype.setCurrentAgentName=function(i){this.currentAgentName=i},DragListener.prototype.getCurrentAgentName=function(){return this.currentAgentName};var invokeDragging=function(i){return function(t){i.dragging(t)}},invokeDraggingFinished=function(i){return function(t){i.draggingFinished(t)}};Dragger.prototype.addAnotherDraggingObject=function(i,t){var i=i?i:event;this.draggingObjs[this.draggingObjs.length]=t,this.originalX[this.originalX.length]=parseInt(t.style.left),this.originalY[this.originalY.length]=parseInt(t.style.top),this.initDragger(i)},Dragger.prototype.initDragger=function(i){this.isDragging=!1,this.mouseX=i.clientX,this.mouseY=i.clientY,document.onmousemove=invokeDragging(this),document.onmouseup=invokeDraggingFinished(this)},Dragger.prototype.dragging=function(t){var r=t?t:event,e=!1,g=0,n=0;if(this.dragsX){var g=r.clientX-this.mouseX;e=Math.abs(g)>this.sigMove}if(this.dragsY){var n=r.clientY-this.mouseY;e=e||Math.abs(n)>this.sigMove}if(!this.isDragging&&e)for(this.isDragging=!0,this.dragListener&&this.dragListener.notify(DragListener.DRAGGING_STARTED,t),i=0;i<this.draggingObjs.length;i++)this.draggingObjs[i].style.display="block";if(this.isDragging){if(g){for(i=0;i<this.draggingObjs.length;i++){parseInt(this.originalX[i]+g)}if(g)for(i=0;i<this.draggingObjs.length;i++)this.draggingObjs[i].style.left=parseInt(this.originalX[i]+g)+"px"}if(n){for(i=0;i<this.draggingObjs.length;i++){parseInt(this.originalY[i]+n)}if(n)for(i=0;i<this.draggingObjs.length;i++)this.draggingObjs[i].style.top=parseInt(this.originalY[i]+n)+"px"}(g||n)&&this.dragListener.notify(DragListener.DRAGGING,t)}},Dragger.prototype.draggingFinished=function(i){document.onmousemove="default",document.onmouseup="default",this.isDragging?(this.isDragging=!1,this.cleanUpUtil&&this.cleanUpUtil(),this.dragListener&&(this.dragListener.notify(DragListener.DRAGGING_FINISHED,i),this.dragListener.setCurrentAgentName(null))):this.dragListener&&this.dragListener.setCurrentAgentName(null)},Dragger.prototype.clearDraggingObjects=function(){for(var i=0;i<this.draggingObjs.length;i++){var t=this.draggingObjs[i];t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}};