define("scheduler/view/editor/schedule",["require","backbone","jquery","jrs.configs","common/jquery/extension/timepickerExt","common/jquery/extension/datepickerExt","scheduler/view/editor/holidayCal","scheduler/collection/holidayCals"],function(e){var t=e("backbone"),a=e("jquery"),n=e("jrs.configs"),r=(e("common/jquery/extension/timepickerExt"),e("common/jquery/extension/datepickerExt"),e("scheduler/view/editor/holidayCal")),c=e("scheduler/collection/holidayCals"),o=function(e){a(e).each(function(e,t){a(t).datetimepicker({dateFormat:n.calendar.timepicker.dateFormat,timeFormat:"HH:mm",showOn:"button",buttonText:"",changeYear:!0,changeMonth:!0,showButtonPanel:!0,showSecond:!1,onChangeMonthYear:null,beforeShow:a.datepicker.movePickerRelativelyToTriggerIcon}).next().addClass("button").addClass("picker"),a(t)[0].getValue=function(){return a(this).val()}})};return t.View.extend({el:"#scheduler_editor .tab[data-tab=schedule]",events:{"change [name=startType]":"setStartType","change [name=startDate]":"setStartDate","change [name=schedulerTimeZone]":"setTimeZone","change [name=recurrenceType]":"recurrenceType","change [name=recurrenceInterval]":"setRecurrenceInterval","change [name=recurrenceIntervalUnit]":"setRecurrenceIntervalUnit","change [name=endat]":"setEnDat","change [name=occurrenceCount]":"setOccurrenceCount","change [name=simpleEndDate]":"setEndDate","change [name=calendarEndDate]":"setEndDate","change [name=whichMonth]":"monthRadioSelector","change [name=monthSelector]":"setMonthSelector","change [name=whichDay]":"dayRadioSelector","change [name=daySelector]":"setDaySelector","change [name=datesInMonth]":"setDatesInMonth","change [name=hours]":"setHours","change [name=minutes]":"setMinutes","change [name=calendarSelect]":"setCalendar"},initialize:function(){var e=this;e.calCollection=new c,e.calView=new r({collection:e.calCollection}),o(".datepicker"),this.calCollection.fetch({reset:!0,data:{calendarType:"holiday"}}),e.model.on("change:trigger",function(){var t=e.model.get("trigger");e.$("[name=startType]").filter("[value="+t.startType+"]").prop("checked",!0),e.$("[name=startDate]").val(t.startDate),e.$("[name=schedulerTimeZone]").val(t.timezone),e.$("[name=recurrenceType]").val(t.type),e.$("fieldset[data-recurrence]").addClass("hidden"),e.$('fieldset[data-recurrence="'+t.type+'"]').removeClass("hidden"),"none"===t.type&&e.$(".calendarBlock").addClass("hidden"),"simple"===t.type&&(e.$("[name=recurrenceInterval]").val(t.recurrenceInterval),e.$("[name=recurrenceIntervalUnit]").val(t.recurrenceIntervalUnit),e.$("[name=endat]").filter("[value="+t.radioEndDate+"]").prop("checked",!0),e.$("[name=occurrenceCount]").val(t.occurrenceCount),e.$("[name=simpleEndDate]").val(t.endDate),e.$(".calendarBlock").removeClass("hidden"),e.$("[name=calendarSelect]").val(t.calendarName)),"calendar"===t.type&&(e.$("[name=whichMonth]").filter("[value="+t.radioWhichMonth+"]").prop("checked",!0),e.$("[name=monthSelector]").val(t.months.month),e.$("[name=whichDay]").filter("[value="+t.radioWhichDay+"]").prop("checked",!0),e.$("[name=daySelector]").val(t.weekDays.day),e.$("[name=datesInMonth]").val(t.monthDays),e.$("[name=hours]").val(t.hours),e.$("[name=minutes]").val(t.minutes),e.$("[name=calendarEndDate]").val(t.endDate),e.$(".calendarBlock").removeClass("hidden"),e.$("[name=calendarSelect]").val(t.calendarName))})},setStartType:function(e){this.model.update("trigger",{startType:a(e.target).val()})},setStartDate:function(e){this.model.update("trigger",{startType:"2",startDate:a(e.target).val()})},setTimeZone:function(e){this.model.update("trigger",{timezone:a(e.target).val()})},recurrenceType:function(e){this.model.update("trigger",{type:a(e.target).val()})},setRecurrenceInterval:function(e){this.model.update("trigger",{recurrenceInterval:a(e.target).val()})},setRecurrenceIntervalUnit:function(e){this.model.update("trigger",{recurrenceIntervalUnit:a(e.target).val()})},setEnDat:function(e){this.model.update("trigger",{radioEndDate:a(e.target).val()})},setOccurrenceCount:function(e){this.model.update("trigger",{occurrenceCount:a(e.target).val()})},setEndDate:function(e){this.model.update("trigger",{endDate:a(e.target).val()})},monthRadioSelector:function(e){this.model.update("trigger",{radioWhichMonth:a(e.target).val()})},setMonthSelector:function(e){for(var t=a(e.target).val()||[],n=0,r=t.length;r>n;n++)t[n]=parseInt(t[n]);this.model.update("trigger",{months:{month:t}})},dayRadioSelector:function(e){this.model.update("trigger",{radioWhichDay:a(e.target).val()})},setDaySelector:function(e){for(var t=a(e.target).val()||[],n=0,r=t.length;r>n;n++)t[n]=parseInt(t[n]);this.model.update("trigger",{weekDays:{day:t}})},setDatesInMonth:function(e){this.model.update("trigger",{monthDays:a(e.target).val()})},setHours:function(e){this.model.update("trigger",{hours:a(e.target).val()})},setMinutes:function(e){this.model.update("trigger",{minutes:a(e.target).val()})},setCalendar:function(e){this.model.update("trigger",{calendarName:a(e.target).val()})}})});