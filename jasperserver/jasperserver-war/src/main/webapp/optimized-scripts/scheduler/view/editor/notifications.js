define("scheduler/view/editor/notifications",["require","jquery","backbone"],function(e){var t=e("jquery"),a=e("backbone");return a.View.extend({el:"#scheduler_editor .tab[data-tab=notifications]",events:{"change [name=to_suc]":"to_suc_Change","change [name=cc_suc]":"cc_suc_Change","change [name=bcc_suc]":"bcc_suc_Change","change [name=subject_suc]":"subject_suc_Change","change [name=message_suc]":"message_suc_Change","change [name=resultSendTypeRadio]":"setResultSendType","change [name=includeHtmlReport]":"setResultSendType","change [name=dontSendEmptyReport]":"dont_send_empty_report_Change","change [name=job_status_to]":"job_status_to_Change","change [name=job_status_subject]":"job_status_subject_Change","change [name=job_status_success_message]":"job_status_success_message_Change","change [name=job_status_failed_message]":"job_status_failed_message_Change","change [name=send_success_notification]":"twoCheckboxes_Change","change [name=send_failure_notification]":"twoCheckboxes_Change","change [name=include_report]":"include_report_Change","change [name=include_stack_trace]":"include_stack_trace_Change"},initialize:function(){var e=this;this.model.on("change:mailNotification",function(t){var a=t.get("mailNotification");if(a){e.$("[name=to_suc]").val(a.toAddresses.address),e.$("[name=cc_suc]").val(a.ccAddresses.address),e.$("[name=bcc_suc]").val(a.bccAddresses.address),e.$("[name=subject_suc]").val(a.subject),e.$("[name=message_suc]").val(a.messageText),e.message_suc_DisabledEnabled(t);var s=!1,n="";switch(a.resultSendType){case"SEND":s=!1,n="asRepoLinks";break;case"SEND_EMBED":s=!0,n="asAttachedFiles";break;case"SEND_EMBED_ZIP_ALL_OTHERS":s=!0,n="asAttachedZip";break;case"SEND_ATTACHMENT":s=!1,n="asAttachedFiles";break;case"SEND_ATTACHMENT_ZIP_ALL":s=!1,n="asAttachedZip"}e.$("[name=resultSendTypeRadio]").filter("[value="+n+"]").prop("checked",!0),e.asRepoLinks_DisabledEnabled(t),e.$("[name=includeHtmlReport]").prop("checked",s),e.includeHtmlReport_DisabledEnabled(t),e.$("[name=dontSendEmptyReport]").prop("checked",a.skipEmptyReports)}}),e.model.on("change:alert",function(t){var a=t.get("alert");a&&(e.$("[name=job_status_to]").val(a.toAddresses.address),e.$("[name=send_success_notification]").prop("checked",-1!==a.jobState.indexOf("SUCCESS_ONLY")||-1!==a.jobState.indexOf("ALL")),e.$("[name=send_failure_notification]").prop("checked",-1!==a.jobState.indexOf("FAIL_ONLY")||-1!==a.jobState.indexOf("ALL")),e.$("[name=job_status_subject]").val(a.subject),e.$("[name=job_status_success_message]").val(a.messageText),e.$("[name=job_status_failed_message]").val(a.messageTextWhenJobFails),e.$("[name=include_report]").prop("checked",!!a.includingReportJobInfo),e.$("[name=include_stack_trace]").prop("checked",!!a.includingStackTrace))}),this.model.on("change:outputFormats",function(t,a){var s=a.outputFormat.indexOf("HTML")>=0;if(!s){var n=e.model.get("mailNotification");if(n&&n.resultSendType&&("SEND_EMBED"===n.resultSendType||"SEND_EMBED_ZIP_ALL_OTHERS"===n.resultSendType)){var i="SEND",c=t.get("repositoryDestination");return c&&(c.saveToRepository||(i="SEND_ATTACHMENT")),void t.update("mailNotification",{resultSendType:i})}}e.includeHtmlReport_DisabledEnabled(t)}),this.model.on("change:repositoryDestination",function(t,a){var s=a.saveToRepository;if(!s){var n=e.model.get("mailNotification");if(n&&n.resultSendType&&"SEND"===n.resultSendType)return void t.update("mailNotification",{resultSendType:"SEND_ATTACHMENT"})}e.asRepoLinks_DisabledEnabled(t)})},includeHtmlReport_DisabledEnabled:function(e){var t=!0,a=e.get("mailNotification");a&&"SEND"===a.resultSendType&&(t=!1);var s=e.get("outputFormats");s&&-1===s.outputFormat.indexOf("HTML")&&(t=!1),this.$("[name=includeHtmlReport]").prop("disabled",t?!1:"disabled")},message_suc_DisabledEnabled:function(e){var t=!0,a=e.get("mailNotification");a&&("SEND_EMBED"===a.resultSendType||"SEND_EMBED_ZIP_ALL_OTHERS"===a.resultSendType)&&(t=!1),this.$("[name=message_suc]").prop("disabled",t?!1:"disabled")},asRepoLinks_DisabledEnabled:function(e){var t=!0,a=e.get("repositoryDestination");a&&(a.saveToRepository||(t=!1)),this.$("[name=resultSendTypeRadio][value=asRepoLinks]").prop("disabled",t?!1:"disabled")},to_suc_Change:function(e){this.model.update("mailNotification",{toAddresses:{address:t(e.target).val()}})},cc_suc_Change:function(e){this.model.update("mailNotification",{ccAddresses:{address:t(e.target).val()}})},bcc_suc_Change:function(e){this.model.update("mailNotification",{bccAddresses:{address:t(e.target).val()}})},subject_suc_Change:function(e){this.model.update("mailNotification",{subject:t(e.target).val()})},message_suc_Change:function(e){this.model.update("mailNotification",{messageText:t(e.target).val()})},setResultSendType:function(){var e=this.$("[name=resultSendTypeRadio]").filter(":checked").val(),t=this.$("[name=includeHtmlReport]").is(":checked"),a="";t?"asRepoLinks"===e?a="SEND":"asAttachedFiles"===e?a="SEND_EMBED":"asAttachedZip"===e&&(a="SEND_EMBED_ZIP_ALL_OTHERS"):"asRepoLinks"===e?a="SEND":"asAttachedFiles"===e?a="SEND_ATTACHMENT":"asAttachedZip"===e&&(a="SEND_ATTACHMENT_ZIP_ALL"),this.model.update("mailNotification",{resultSendType:a})},dont_send_empty_report_Change:function(e){this.model.update("mailNotification",{skipEmptyReports:t(e.target).is(":checked")})},job_status_to_Change:function(e){this.model.update("alert",{toAddresses:{address:t(e.target).val()}})},job_status_subject_Change:function(e){this.model.update("alert",{subject:t(e.target).val()})},twoCheckboxes_Change:function(){var e=this.$("[name=send_success_notification]").is(":checked"),t=this.$("[name=send_failure_notification]").is(":checked"),a=[];e&&a.push("SUCCESS_ONLY"),t&&a.push("FAIL_ONLY"),0==a.length&&(a=["NONE"]),2==a.length&&(a=["ALL"]),a=a.join("|"),this.model.update("alert",{jobState:a})},job_status_success_message_Change:function(e){this.model.update("alert",{messageText:t(e.target).val()})},job_status_failed_message_Change:function(e){this.model.update("alert",{messageTextWhenJobFails:t(e.target).val()})},include_report_Change:function(e){this.model.update("alert",{includingReportJobInfo:t(e.target).is(":checked")})},include_stack_trace_Change:function(e){this.model.update("alert",{includingStackTrace:t(e.target).is(":checked")})}})});