function invokeServerAction(e,t){var i=orgModule.serverActionFactory[e];if(!i)throw new Error("No server action found for action name '"+e+"'");var n=i.call(orgModule.serverActionFactory,t);n.invokeAction()}function invokeClientAction(e,t){var i=orgModule.clientActionFactory[e];if(i){var n=i.call(orgModule.clientActionFactory,t);return n.invokeAction()}throw new Error("No client action found for action name '"+e+"'")}orgModule.confirmAndLeave=function(){var e=orgModule.entityList.getSelectedEntities();return orgModule.properties.attributesFacade?!0:invokeClientAction("cancelIfEdit",{entity:e[0],entityEvent:!1})},orgModule.manager={initialize:function(e){this.options=e,this.state=e.state,isProVersion()&&(this.tree=orgModule.createOrganizationsTree(),this.tree.showOrganizations(this.state.tenantUri)),orgModule.observe("org:browse",function(e){var t;this.tree&&(t=this.tree.getOrganization());var i=e.memo.entityEvent;if(!this.lastSelectedOrg||this.lastSelectedOrg.id!=t.id){var n=orgModule.entityList.getSelectedEntities();invokeClientAction("cancelIfEdit",{entity:n[0]||t,entityEvent:i})?(invokeServerAction(orgModule.ActionMap.BROWSE,{tenantId:t?t.id:null}),this.lastSelectedOrg=t):this.lastSelectedOrg&&this.tree.selectOrganization(this.lastSelectedOrg,{silent:orgModule.properties.locked})}}.bindAsEventListener(this)),orgModule.observe("entity:search",function(e){var t=orgModule.entityList.getSelectedEntities(),i=e.memo.text,n=this.tree.getOrganization();invokeClientAction("cancelIfEdit",{entity:t[0]||n})?(invokeServerAction(orgModule.ActionMap.SEARCH,{text:i}),this.lastSearchText=i):0===i.length&&this.lastSearchText&&0!==this.lastSearchText.length&&orgModule.entityList.setSearchText(this.lastSearchText)}.bindAsEventListener(this)),orgModule.observe("entity:next",function(){invokeServerAction(orgModule.ActionMap.NEXT,{})}.bindAsEventListener(this)),orgModule.observe("entity:selectAndGetDetails",function(e){var t=e.memo.entityEvent,i=e.memo.isCtrlHeld,n=e.memo.cancelIfEdit,o=orgModule.entityList.getSelectedEntities();if(o.length>1)orgModule.properties.hide();else{var r,s=o[0];if(r=s&&t?s.getNameWithTenant():(!t||i||n)&&e.memo.entity.getNameWithTenant(),!s&&(orgModule.userManager||!orgModule.userManager&&orgModule.roleManager)&&i)return void orgModule.properties.hide();r&&invokeServerAction(orgModule.ActionMap.SELECT_AND_GET_DETAILS,{entity:r})}}.bindAsEventListener(this)),orgModule.observe("result:changed",function(t){var i=t.memo.responseData;orgModule.entityList.setEntities(i.entities.collect(this.entityJsonToObject)),e.defaultEntity&&orgModule.entityList.restoreSelectedEntity(e.defaultEntity)}.bindAsEventListener(this)),orgModule.observe("result:next",function(e){var t=e.memo.responseData;t.entities.length>0&&orgModule.entityList.addEntities(t.entities.collect(this.entityJsonToObject))}.bindAsEventListener(this)),orgModule.observe("entity:detailsLoaded",function(e){var t=this.entityJsonToObject(e.memo.responseData),i=orgModule.properties;orgModule.entityList.update(t.getNameWithTenant(),t),i.setDetailsLoadedEntity(t),i.show(t),!i.locked&&i.setProperties(t),orgModule.entityList.toolbar.refresh(),i.unlock()}.bindAsEventListener(this)),orgModule.observe("searchAvailable:loaded",function(e){var t=e.memo.responseData;t&&t.entities&&orgModule.properties.setAvailableEntities(t.entities.collect(this.relatedEntityJsonToObject))}.bindAsEventListener(this)),orgModule.observe("searchAssigned:loaded",function(e){var t=e.memo.responseData;t&&t.entities&&orgModule.properties.setAssignedEntities(t.entities.collect(this.relatedEntityJsonToObject))}.bindAsEventListener(this)),orgModule.observe("nextAvailable:loaded",function(e){var t=e.memo.responseData;t&&t.entities&&t.entities.length>0&&orgModule.properties.addAvailableEntities(t.entities.collect(this.relatedEntityJsonToObject))}.bindAsEventListener(this)),orgModule.observe("nextAssigned:loaded",function(e){var t=e.memo.responseData;t&&t.entities&&t.entities.length>0&&orgModule.properties.addAssignedEntities(t.entities.collect(this.relatedEntityJsonToObject))}.bindAsEventListener(this)),orgModule.observe("server:error",function(e){var t=e.memo.responseData;t&&alert(t.message+"\n\n"+t.description?t.description:"")}),orgModule.observe("entity:created",function(e){orgModule.addDialog.hide();var t=e.memo.inputData.entity;if(t){var i=this.entityJsonToObject(t.evalJSON());orgModule.entityList.addEntities([i]),orgModule.entityList.selectEntity(i.getNameWithTenant())}}.bindAsEventListener(this)),orgModule.observe("entity:updated",function(e){var t=this,i=e.memo.inputData.entityName,n=e.memo.responseData;n.roles||(n=e.memo.unencryptedEntity),n||(n=e.memo.inputData.entity);var o=orgModule.properties.attributesFacade||{},r=o.designer&&o.designer.saveDfD;orgModule.properties.isEditMode&&(r?r.done(function(){orgModule.properties.changeMode(!1)}):orgModule.properties.changeMode(!1)),n&&(r?r.done(function(){t.updateEntityList(n,i)}):this.updateEntityList(n,i))}.bindAsEventListener(this)),orgModule.observe("entity:deleted",function(e){var t=e.memo.inputData.entity;orgModule.entityList.remove(t)}.bindAsEventListener(this)),orgModule.observe("entities:deleted",function(e){var t=e.memo.inputData.entities;t&&orgModule.entityList.remove(t.evalJSON())}.bindAsEventListener(this))},updateEntityList:function(e,t){var i=this.entityJsonToObject(e.evalJSON?e.evalJSON():e);orgModule.entityList.update(t,i),orgModule.entityList.selectEntity(i.getNameWithTenant?i.getNameWithTenant():t)},entityJsonToObject:function(){},relatedEntityJsonToObject:function(){},reloadEntities:function(){orgModule.fire(orgModule.Event.ORG_BROWSE,{})},isUserSuperuser:function(){var e=isProVersion()?orgModule.Configuration.superuserRole:orgModule.Configuration.adminRole,t=this.options.currentUserRoles;return null!=t.detect(function(t){return t.roleName==e&&!t.tenantId})}};