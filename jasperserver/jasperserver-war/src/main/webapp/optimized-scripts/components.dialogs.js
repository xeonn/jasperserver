var dialogs={};dialogs.systemConfirm={container:null,message:null,show:function(e,o){window.isEmbeddedDesigner?jQuery(document).trigger("adhocDesigner:notification",[e,o]):(this.container=this.container||jQuery("#systemMessageConsole").on("mouseup touchend",function(){dialogs.systemConfirm.container.slideUp()}),this.message=this.message||document.getElementById("systemMessage"),this.closeText||(this.closeText=this.message.innerHTML.toLowerCase()),this.message.innerHTML=e+' <span>| <a href="#">'+this.closeText+"</a></span>",dialogs.systemConfirm.container.slideDown(),setTimeout("dialogs.systemConfirm.hide()",o?o:2e3))},showWarning:function(e,o){e='<span class="warning">'+e+"</span>",this.show(e,o)},hide:function(){dialogs.systemConfirm.container&&dialogs.systemConfirm.container.slideUp()}},dialogs.errorPopup={_dom:null,_content:null,_DOM_ID:"standardAlert",_CONTENT_ID:"errorPopupContents",_PAGE_CONTENT_PATTERN:"#errorPageContent",_DIALOG_WIDTH:"546px",_DIALOG_HEIGHT:"350px",clickHandler:null,show:function(e,o,t){t||(t={});var s=Builder.node("DIV",{style:"display:none"});s.innerHTML=e,document.body.insertBefore(s,document.body.firstChild);var i=$$(this._PAGE_CONTENT_PATTERN)[0],n=i?i.innerHTML:e,a=i&&i.innerHTML;if(s.remove(),n&&(this._dom||(this._dom=$(this._DOM_ID),this._content=$(this._CONTENT_ID),this.clickHandler=this._clickHandler.bindAsEventListener(this)),this._dom)){var d=n;a||(d=Builder.node("P",{"class":"message"}),d.update(n)),this._content.update(d),this._dom.observe("click",this.clickHandler),this._dom.setStyle({height:t.height||this._DIALOG_HEIGHT,width:t.width||this._DIALOG_WIDTH}),o&&this._dom.addClassName(layoutModule.STACKTRACE_CLASS),dialogs.popup.show(this._dom,o);var l=document.getElementById("completeStackTrace");l&&isIPad()&&new TouchController(l,l.parentNode,{noInit3d:!0})}},_hide:function(){this._dom&&(this._dom.stopObserving("click",this.clickHandler),dialogs.popup.hide(this._dom))},_clickHandler:function(e){var o=e.element();matchAny(o,["button"],!0)&&this._hide()}},dialogs.clusterErrorPopup=_.extend({},dialogs.errorPopup,{show:function(){var e=this;require(["bundle!jasperserver_messages","bundle!jsexceptions_messages"],function(o,t){var s=t["cluster.exception.session.attribute.missing.popup"];dialogs.errorPopup.show.call(e,s);var i=o["button.home"];jQuery("#"+e._DOM_ID).find("button span.wrap").html(i)})},_hide:function(){dialogs.errorPopup._hide.apply(this,arguments),window.location="home.html"}}),dialogs.popup={show:function(e,o,t){t=t||{},e=$(e),e&&((isIE7()||isIE8())&&(jo=jQuery(e),0==jo.children("div.msshadow").length&&jo.prepend('<div class="msshadow" style="position:absolute;top:-10px;right:10px;bottom:10px;left:-10px;border:0;background:#fff;">&nbsp;</div>')),o&&(pageDimmer.show(),e.match(layoutModule.DIALOG_LOADING_PATTERN)&&pageDimmer.setZindex(e.getStyle("zIndex")-1)),reParent(e,document.body),e.setOpacity(0),e.removeClassName(layoutModule.HIDDEN_CLASS),isIE7()&&!e.match(".sizeable")&&setWidthStyleByReflection(e,".content"),layoutModule.createMover.call(layoutModule,e),layoutModule.createSizer.call(layoutModule,e),t.cascade?cascadeElement(e,{position:t.position,number:t.number,horzOffset:40,vertOffset:40}):centerElement(e,{horz:!0,vert:!0}),dialogs.popup._setMaxZIndex(e),layoutModule.createMover.call(layoutModule,e),isIPad()?e.setOpacity(1)&&e.show():appear(e,.4),e.tabIndex=-1,(!t||"undefined"==typeof t.focus||t.focus)&&(isIE8()?setTimeout(function(){try{e.focus()}catch(o){}},450):e.focus()),!o&&e.observe("click",dialogs.popup.zIndexHandler))},hide:function(e){e&&(e=$(e),e.hasClassName(layoutModule.HIDDEN_CLASS)||(e.addClassName(layoutModule.HIDDEN_CLASS),pageDimmer.hide(),e.match(layoutModule.DIALOG_LOADING_PATTERN)&&pageDimmer.setZindex(layoutModule.DIMMER_Z_INDEX)),e.stopObserving("click",dialogs.popup.zIndexHandler))},zIndexHandler:function(e){var o=Event.element(e),t=matchMeOrUp(o,layoutModule.DIALOG_PATTERN);dialogs.popup._setMaxZIndex(t)},_setMaxZIndex:function(e,o){if(e){var t=o?o.getStyle("zIndex"):0,s=document.body.select(layoutModule.DIALOG_PATTERN),i=function(e){e.visible()&&!e.match(layoutModule.DIALOG_LOADING_PATTERN)&&(t=Math.max(t,e.getStyle("zIndex"),layoutModule.DIMMER_Z_INDEX+1))};1==s.length?i(s[0]):s.each(i),e.setStyle({zIndex:Math.max(t+1,e.getStyle("zIndex"))})}}},dialogs.popupConfirm=_.extend({},dialogs.popup,{show:function(e,o,t){dialogs.popup.show.apply(this,arguments),t=_.extend({okButtonSelector:"button.ok",cancelButtonSelector:"button.cancel"},t);var s=jQuery(e),i=s.find(t.okButtonSelector),n=s.find(t.cancelButtonSelector),a=jQuery.Deferred();return i.on("click",function(){t.validateFunc&&t.validateFunc()===!1||(i.off("click"),n.off("click"),dialogs.popupConfirm.hide(e),a.resolve())}),n.on("click",function(){i.off("click"),n.off("click"),dialogs.popupConfirm.hide(e),a.reject()}),a}}),dialogs.childPopup=_.extend({},dialogs.popup,{cascadePopups:{},show:function(e,o,t,s){t?(s=_.extend({parent:t},s),this.cascadePopups[t.id]||(this.cascadePopups[t.id]=[]),this.cascadePopups[t.id].push(e.id),$(e).setAttribute("data-parentDialog",t.id),dialogs.popup.show.apply(this,[e,o,s]),dialogs.popup._setMaxZIndex(e,t),o&&pageDimmer.setZindex(e.getStyle("zIndex")-1),t.stopObserving("click",dialogs.popup.zIndexHandler)):dialogs.popup.show.apply(this,[e,o,s])},hide:function(e){var o=$(e).getAttribute("data-parentDialog");if(o){this.cascadePopups[o]&&(this.cascadePopups[o]=_.without(this.cascadePopups[o],e.id)),dialogs.popup.hide.apply(this,[e]);var t=$(o);pageDimmer.show(t),dialogs.popup._setMaxZIndex(t)}else dialogs.popup.hide.apply(this,[e])}});