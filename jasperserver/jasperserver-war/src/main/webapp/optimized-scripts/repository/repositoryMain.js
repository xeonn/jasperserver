function invokeAction(e){var t=repositorySearch.Action["create"+e].call();t.invokeAction()}function invokeFolderAction(e,t){var o=t?t:repositorySearch.model.getContextFolder(),r=repositorySearch.folderActionFactory[e](o);r.invokeAction()}function invokeResourceAction(e,t,o){var r=t?t:repositorySearch.model.getSelectedResources()[0],i=repositorySearch.resourceActionFactory[e](r,o);i.invokeAction()}function invokeBulkAction(e){var t=repositorySearch.model.getSelectedResources(),o=repositorySearch.bulkActionFactory[e](t);o.invokeAction()}function invokeRedirectAction(e){var t=repositorySearch.RedirectAction["create"+e].call();t.invokeAction()}function invokeCreate(e,t){var o=repositorySearch.RedirectAction.createCreateResourceAction(e,t);o.invokeAction()}function isCopyOrMove(){return repositorySearch.CopyMoveController.isCopy()||repositorySearch.CopyMoveController.isMove()}function isFolderCopyOrMove(){return repositorySearch.CopyMoveController.isCopyFolder()||repositorySearch.CopyMoveController.isMoveFolder()}function isResourceCopyOrMove(){return repositorySearch.CopyMoveController.isCopyResource()||repositorySearch.CopyMoveController.isMoveResource()}function canCreateFolder(){var e=repositorySearch.model.getContextFolder();return e&&!e.isOrganizationsRoot()&&e.isEditable()}function canFolderBeDeleted(){var e=repositorySearch.model.getContextFolder();return e&&!e.isOrganization()&&!e.isRoot()&&!e.isPublic()&&!e.isTemp()&&!e.isOrganizationsRoot()&&e.isRemovable()&&!e.isActiveThemeFolder()&&!e.isThemeRootFolder()}function canFolderBeEdited(e){return e=e?e:repositorySearch.model.getContextFolder(),e&&e.isEditable()}function canFolderBeCopied(e){return e=e?e:repositorySearch.model.getContextFolder(),e&&!e.isOrganization()&&!e.isRoot()&&!e.isOrganizationsRoot()&&e.isReadable()}function canFolderBeCopiedOrMovedToFolder(e){var t=e?e:repositorySearch.model.getContextFolder(),o=isFolderCopyOrMove()&&!t.isOrganizationsRoot()&&canFolderBeEdited(t);if(!o)return!1;var r=repositorySearch.CopyMoveController.object;return t.URI!==r.URI}function canFolderBeMoved(e){return e=e?e:repositorySearch.model.getContextFolder(),e&&!e.isOrganization()&&!e.isRoot()&&!e.isPublic()&&!e.isTemp()&&!e.isOrganizationsRoot()&&e.isRemovable()&&!e.isActiveThemeFolder()&&!e.isThemeRootFolder()}function canFolderBeExported(e){e=e?e:repositorySearch.model.getContextFolder();var t=e.URI.split("/");return!(t.length>2&&"organizations"===t[t.length-2]&&"org_template"!==t[t.length-1])}function canFolderPermissionsBeAssigned(){var e=repositorySearch.model.getContextFolder();return e&&e.isAdministrable()}function canFolderPropertiesBeShowed(){var e=repositorySearch.model.getContextFolder();return e&&e.isReadable()&&!canFolderPropertiesBeEdited()}function canFolderPropertiesBeEdited(){var e=repositorySearch.model.getContextFolder();return e&&e.isEditable()&&!e.isOrganization()&&!e.isOrganizationsRoot()&&!e.isRoot()}function canResourceBeCreated(e){var t=repositorySearch.model.getContextFolder();return t&&!t.isOrganization()&&!t.isRoot()&&!t.isOrganizationsRoot()&&t.isEditable()}function canBeRun(e){return e=e?e:repositorySearch.model.getSelectedResources()[0],e&&e.isReadable()&&repositorySearch.runActionFactory[e.typeSuffix()]&&!repositorySearch.isflowRedirectRunning}function canBeGenerated(e){return!1}function canBeConverted(e){return!1}function canResourceBeEdited(e){e=e?e:repositorySearch.model.getSelectedResources()[0];var t=repositorySearch.editActionFactory[e.typeSuffix()]||ResourcesUtils.isCustomDataSource(e),o=e&&e.isEditable()&&t;return["DashboardResource"].include(e.typeSuffix())?!1:o}function canBeOpenedInDesigner(e){return e=e?e:repositorySearch.model.getSelectedResources()[0],e&&e.isEditable()&&repositorySearch.openActionFactory[e.typeSuffix()]&&"ContentResource"!==e.typeSuffix()}function canBeOpened(e){return e=e?e:repositorySearch.model.getSelectedResources()[0],e&&e.isEditable()&&repositorySearch.openActionFactory[e.typeSuffix()]&&"ContentResource"===e.typeSuffix()}function canBeRunInBackground(e){return canBeScheduled(e)}function canBeScheduled(e){return e=e?e:repositorySearch.model.getSelectedResources()[0],e&&e.isReadable()&&[repositorySearch.ResourceType.REPORT_UNIT,repositorySearch.ResourceType.ADHOC_REPORT_UNIT,repositorySearch.ResourceType.REPORT_OPTIONS].include(e.resourceType)}function canResourceBeCopied(e){return e=e?e:repositorySearch.model.getSelectedResources()[0],e&&e.isReadable()}function canResourceBeMoved(e){return e=e?e:repositorySearch.model.getSelectedResources()[0],e&&e.isRemovable()}function canResourceBeDeleted(e){return e=repositorySearch.model.getSelectedResources()[0],e&&e.isRemovable()}function canResourcePropertiesBeShowed(){var e=repositorySearch.model.getSelectedResources()[0];return e&&e.isReadable()&&!e.isEditable()}function canResourcePropertiesBeEdited(e){return e=e?e:repositorySearch.model.getSelectedResources()[0],e&&e.isEditable()}function canResourcePermissionsBeAssigned(){var e=repositorySearch.model.getSelectedResources()[0];return e&&e.isAdministrable()}function canAllBeRun(){var e=repositorySearch.model.getSelectedResources(),t=e.detect(function(e){return!canBeRun(e)});return e.length>0&&void 0===t}function canAllBeEdited(){var e=repositorySearch.model.getSelectedResources(),t=e.detect(function(e){return!canResourceBeEdited(e)});return e.length>0&&void 0===t&&!isIPad()}function canAllBeOpened(){var e=repositorySearch.model.getSelectedResources(),t=e.detect(function(e){return!canBeOpenedInDesigner(e)&&!canBeOpened(e)});return e.length>0&&void 0===t}function canAllBeCopied(){var e=repositorySearch.model.getSelectedResources(),t=e.detect(function(e){return!canResourceBeCopied(e)});return e.length>0&&void 0===t}function canAllBeMoved(){var e=repositorySearch.model.getSelectedResources(),t=e.detect(function(e){return!canResourceBeMoved(e)});return e.length>0&&void 0===t}function canAllBeCopiedOrMovedToFolder(e){e=e?e:repositorySearch.model.getContextFolder();var t=isResourceCopyOrMove()&&!e.isOrganizationsRoot()&&canFolderBeEdited(e);if(!t)return!1;var o=repositorySearch.CopyMoveController.isBulkAction()?repositorySearch.CopyMoveController.object:[repositorySearch.CopyMoveController.object],r=(o.collect(function(e){return e.parentFolder}),!0);if(e.isThemeRootFolder()||e.isThemeFolder()){var i=null==o.detect(function(e){return!e.resourceType.endsWith(".FileResource")});r=i}return r}function canAllBePasted(){return canAllBeCopiedOrMovedToFolder(repositorySearch.model.getSelectedFolder())}function canAllPropertiesBeShowed(){var e=repositorySearch.model.getSelectedResources(),t=e.detect(function(e){return!canResourcePropertiesBeShowed(e)});return e.length>0&&void 0===t}function canAllPropertiesBeEdited(){var e=repositorySearch.model.getSelectedResources(),t=e.detect(function(e){return!canResourcePropertiesBeEdited(e)});return e.length>0&&void 0===t}function canAllBeDeleted(){var e=repositorySearch.model.getSelectedResources(),t=e.detect(function(e){return!canResourceBeDeleted(e)});return e.length>0&&void 0===t}function isThemeFolder(){var e=repositorySearch.model.getContextFolder();return e&&e.isThemeFolder()}function isNonActiveThemeFolder(){var e=repositorySearch.model.getContextFolder();return isThemeFolder()&&!e.isActiveThemeFolder()}function isThemeRootFolder(){var e=repositorySearch.model.getContextFolder();return e&&e.isThemeRootFolder()}function canThemeBeReuploaded(){var e=repositorySearch.model.getContextFolder();return e&&e.isThemeFolder()&&canFolderBeEdited(e)}function isPermissionsChanged(){var e=repositorySearch.dialogsPool.getAllPermissionsDialogs();return e.detect(function(e){return e.isChanged()})}function isPropertiesChanged(){var e=repositorySearch.dialogsPool.getAllPropertiesDialogs();return e.detect(function(e){return e.isChanged()})}function parseRepoData(e){return _.isArray(e)?_.pluck(e,"URIString"):[e.URIString]}function RegExpRepresenter(e){this.charMap={"\\s":" "},this.expressionTokens=this.__parse(e)}define("common/component/base/Dimmer",["require","jquery","common/util/classUtil"],function(e){var t,o,r=e("jquery"),i=e("common/util/classUtil");return i.extend({constructor:function(e){t||(o=0,t=r("<div id='dialogDimmer' class='dimmer'></div>").css(e),r(document.body).append(t)),t.hide(),o++},css:function(e){return t.css(e),this},show:function(){var e=this.getCount()||0;return this.setCount(++e),t.show(),this},hide:function(){if(this.isVisible()){var e=this.getCount();return this.setCount(--e),!e&&t.hide(),this}},setCount:function(e){t.data({count:e})},getCount:function(){return parseInt(t.data("count"),10)},isVisible:function(){return t.is(":visible")},remove:function(){this._removed||(this._removed=!0,t&&(o--,o||(t.remove(),t=null)))}})}),define("text!common/component/panel/template/panelTemplate.htm",[],function(){return'<div class="panel {{- additionalCssClasses }}">\n    <div class="header">\n        <div class="title">{{- title}}</div>\n    </div>\n    <div class="subcontainer"></div>\n</div>\n'}),define("common/component/panel/Panel",["require","css!panel","underscore","backbone","text!./template/panelTemplate.htm"],function(e){"use strict";e("css!panel");var t=e("underscore"),o=e("backbone"),r=e("text!./template/panelTemplate.htm");return o.View.extend({defaultTemplate:r,el:function(){return this.template({title:this.title,additionalCssClasses:this.additionalCssClasses})},constructor:function(e){e||(e={}),this.template=t.template(e.template||this.defaultTemplate),this.title=e.title||"",this.additionalCssClasses=e.additionalCssClasses||"",this.content=e.content||"",this.collapsed=!e.collapsed,this.openClass=e.openClass||"open",this.closedClass=e.closedClass||"closed",this.loadingClass=e.loadingClass||"loading",this.fixedHeight=e.fixedHeight||!1,this.contentContainer=e.contentContainer||".subcontainer",this.overflow=e.overflow||"auto",this.traits=e.traits||[],t.each(this.traits,t.bind(function(e){e.extension&&t.extend(this,e.extension)},this)),this.invokeTraits("onConstructor",e),o.View.apply(this,arguments)},invokeTraits:function(e){var o=Array.prototype.slice.call(arguments,1),r=this;t.each(this.traits,function(t){t[e]&&t[e].apply(r,o)})},initialize:function(e){this.invokeTraits("beforeInitialize",e),this.content&&this.setContent(this.content),this.toggleCollapsedState(),this.invokeTraits("afterInitialize",e)},setElement:function(e){this.invokeTraits("beforeSetElement",e);var t=o.View.prototype.setElement.apply(this,arguments);return this.$contentContainer=this.$(this.contentContainer),this.$contentContainer[this.collapsed?"hide":"show"](),this.invokeTraits("afterSetElement",e),t},open:function(e){return this.invokeTraits("beforeOpen",e),this.$contentContainer.show(),this.$el.removeClass(this.closedClass).addClass(this.openClass),this.collapsed=!1,e&&e.renderContent&&this.renderContent(),this.invokeTraits("afterOpen",e),e&&e.silent||this.trigger("open",this),this},close:function(e){return this.invokeTraits("beforeClose",e),this.$contentContainer.hide(),this.$el.removeClass(this.openClass).addClass(this.closedClass),this.collapsed=!0,this.invokeTraits("afterClose",e),e&&e.silent||this.trigger("close",this),this},setContent:function(e,t){this.content=e;var o=this.renderContent();this.$contentContainer[t===!0?"append":"html"](o)},renderContent:function(){return this.content instanceof o.View?this.content.render().$el:this.content},setHeight:function(e){var o=this.$("> .header").outerHeight();this.$contentContainer.css({height:t.isNumber(e)?e-o+"px":"auto",overflow:this.overflow})},toggleCollapsedState:function(){return this.collapsed?this.open():this.close(),this},remove:function(){this.invokeTraits("onRemove"),this.content&&this.content.remove&&this.content.remove(),o.View.prototype.remove.call(this)}})}),define("common/component/base/OptionView",["require","backbone","underscore"],function(e){"use strict";var t=e("backbone"),o=e("underscore");return t.View.extend({events:{click:"select",mouseover:"mouseover",mouseout:"mouseout"},constructor:function(e){if(!e||!e.template)throw new Error("Option should have defined template");if(!(e.model&&e.model instanceof t.Model))throw new Error("Option should have associated Backbone.Model");this.template=o.template(e.template),this.disabledClass=e.disabledClass,this.hiddenClass=e.hiddenClass,this.toggleClass=e.toggleClass,this.overClass=e.overClass||"over",t.View.apply(this,arguments)},initialize:function(){t.View.prototype.initialize.apply(this,arguments);var e=this;this.model.get("disabled")===!0&&this.disable(),this.model.get("hidden")===!0&&this.hide(),this.listenTo(this.model,"change:over",function(t,o){o?e.$("> p").addClass(e.overClass):e.$("> p").removeClass(e.overClass)})},el:function(){return this.template(this.model.toJSON())},enable:function(){this.$el.removeAttr("disabled").removeClass(this.disabledClass)},disable:function(){this.$el.attr("disabled","disabled").addClass(this.disabledClass)},over:function(){this.model.set({over:!0})},leave:function(){this.model.set({over:!1})},show:function(){this.$el.show().removeClass(this.hiddenClass)},hide:function(){this.$el.hide().addClass(this.hiddenClass)},isVisible:function(){return this.$el.is(":visible")},isDisabled:function(){return this.$el.is(":disabled")},select:function(e){this.model.trigger("select",this,this.model,e),this.trigger("click",this,this.model,e)},addSelection:function(){this.$el.addClass(this.toggleClass)},removeSelection:function(){this.$el.removeClass(this.toggleClass)},mouseover:function(e){this.trigger("mouseover",this,this.model,e)},mouseout:function(e){this.trigger("mouseout",this,this.model,e)}})}),define("common/component/base/OptionContainer",["require","backbone","underscore","./OptionView"],function(e){"use strict";var t=e("backbone"),o=e("underscore"),r=e("./OptionView"),i=Array.prototype.slice;return t.View.extend({el:function(){return o.template(this.template)()},constructor:function(e){if(e||(e={}),!e.options||!e.options.length)throw new Error("Option views descriptors must be specified");if(!e.mainTemplate&&!e.el)throw new Error("Option container must have a template");if(!e.optionTemplate)throw new Error("Option container must have an option template");this.contextName=e.contextName||"option",this.contentContainer=e.el?e.contentContainer:e.contentContainer||"> .content > ul",this.toggle=!!e.toggle,this.toggleClass=e.toggleClass||"active",this.options=[],this.collection=new t.Collection(e.options),this.hasGroups=this.collection.models[0]&&this.collection.models[0].get("groupId")?!0:!1,this.defalutOptionView=this.hasGroups?this.collection.where({"default":!0}):[this.collection.findWhere({"default":!0})],this.listenTo(this.collection,"select",this._selectOption),this.template=e.mainTemplate,this.optionTemplate=e.optionTemplate,t.View.apply(this,arguments)},setElement:function(e){var o=t.View.prototype.setElement.apply(this,arguments);return this.$contentContainer=this.contentContainer?this.$(this.contentContainer):this.$el,o},initialize:function(){var e=this;this.collection.forEach(function(t){var o=new r({template:e.optionTemplate,model:t,toggleClass:e.toggleClass});e.listenTo(o,"mouseover",function(t,o){e.trigger("mouseover",t,e,o)}),e.listenTo(o,"mouseout",function(t,o){e.trigger("mouseout",t,e,o)}),e.options.push(o),e.$contentContainer.append(o.$el)}),this.toggle&&this.defalutOptionView&&o.each(this.defalutOptionView,function(e){e&&this.getOptionView(e.get("action")).addSelection()},this)},_onKeyDown:function(e){var t=this.getOptionView(e.keyCode,"triggerOnKeyCode");t&&!t.isDisabled()&&t.select()},_selectOption:function(e,t){if(this.toggle){var r=t.get("groupId"),i=this.hasGroups?o.where(this.options,function(e){return e.model.get("groupId")===r}):this.options;o.each(i,function(e){e.removeSelection()},this),e.addSelection()}this.trigger(this.contextName+":"+t.get("action"),e,t)},getOptionView:function(e,t){return o.find(this.options,function(o){return o.model.get(t||"action")===e})},resetSelection:function(e,t){e=e||[],this.toggle&&(this.hasGroups?(e.length<this.defalutOptionView.length&&o.each(this.defalutOptionView,function(t){var r={groupId:t.get("groupId")},i=o.findWhere(e,r);!i&&t&&e.push(o.extend(r,{action:t.get("action")}))}),e=o.pluck(e,"action")):!e.length&&this.defalutOptionView[0]&&e.push(this.defalutOptionView[0].get("action")),o.each(this.options,function(r){e.length&&(o.contains(e,r.model.get("action"))?t?this._selectOption(r,r.model):r.addSelection():r.removeSelection())},this))},select:function(e){var t=i.call(arguments);this.toggle&&o.each(this.options,function(e){!t.length||o.contains(t,e.model.get("action"))?e.addSelection():e.removeSelection()},this)},deselect:function(e){var t=i.call(arguments);this.toggle&&o.each(this.options,function(e){(!t.length||o.contains(t,e.model.get("action")))&&e.removeSelection()},this)},show:function(){return o.each(this.options,function(e){var t=e.model.get("test");t&&!t()?e.hide():e[e.model.get("hidden")?"hide":"show"]()}),this.$el.show(),this.trigger("show",this),this},hide:function(){return this.$el.hide(),this.trigger("hide",this),this},enable:function(e){var t=i.call(arguments);o.each(this.options,function(e){(!t.length||o.contains(t,e.model.get("action")))&&e.enable()})},disable:function(e){var t=i.call(arguments);o.each(this.options,function(e){(!t.length||o.contains(t,e.model.get("action")))&&e.disable()})},remove:function(){o.invoke(this.options,"remove"),t.View.prototype.remove.apply(this,arguments)}})}),define("common/component/panel/trait/abstractPanelTrait",[],function(){"use strict";var e={extension:{},onConstructor:function(){},beforeInitialize:function(){},afterInitialize:function(){},beforeSetElement:function(){},afterSetElement:function(){},beforeOpen:function(){},afterOpen:function(){},beforeClose:function(){},afterClose:function(){},onRemove:function(){}};return e}),define("csslink",{load:function(e,t,o,r){if(r.isBuild)return void o();var i=document.createElement("link");i.type="text/css",i.rel="stylesheet",i.href=t.toUrl(e),0!==i.href.indexOf("font")&&(i.className="jrWebFont"),document.getElementsByTagName("head")[0].appendChild(i),o()}}),define("common/component/panel/trait/resizablePanelTrait",["require","underscore","./abstractPanelTrait","jquery.ui","csslink!jquery-ui-custom-css"],function(e){"use strict";function t(e,t){this.trigger("resize",e,t)}function o(e,t){this.trigger("resizeStart",e,t)}function r(e,t){this.trigger("resizeStop",e,t)}var i=e("underscore"),n=e("./abstractPanelTrait");return e("jquery.ui"),e("csslink!jquery-ui-custom-css"),i.extend({},n,{onConstructor:function(e){e||(e={}),this.handles=e.handles||"e, s, se",this.minWidth=e.minWidth||10,this.minHeight=e.minHeight||10,this.maxWidth=e.maxWidth||null,this.maxHeight=e.maxHeight||null,this.alsoResize=e.alsoResize||!1,this.resizableEl=e.resizableEl},afterSetElement:function(){this.$resizableEl=this.$el.find(this.resizableEl).length?this.$el.find(this.resizableEl):this.$el,this.$resizableEl.resizable({handles:this.handles,minHeight:this.minHeight,minWidth:this.minWidth,maxWidth:this.maxWidth,maxHeight:this.maxHeight,alsoResize:this.alsoResize,resize:i.bind(t,this),start:i.bind(o,this),stop:i.bind(r,this)})},onRemove:function(){try{this.$el.resizable("destroy")}catch(e){}}})}),define("text!common/component/dialog/template/dialogTemplate.htm",[],function(){return'<div class="m-Dialog jrs {{- additionalCssClasses }}" tabindex="-1">\n    <div class="m-Dialog-header mover jrs">\n        <h1 class="m-Dialog-header-title jrs">{{- title }}</h1>\n    </div>\n    <div class="m-Dialog-body subcontainer jrs"></div>\n    <div class="m-Dialog-footer jrs"></div>\n\n</div>\n'}),define("text!common/component/dialog/template/dialogButtonTemplate.htm",[],function(){return"<button class=\"button action up {{- primary ? 'primary' : ''}} {{- (typeof float !== 'undefined' ? 'right' : '') }}\">\n    <span class=\"wrap\">{{- label }}<span class=\"icon\"></span></span>\n</button>\n"}),define("common/component/dialog/Dialog",["require","jquery.ui","css!common/dialog","underscore","jquery","../base/Dimmer","common/component/panel/Panel","common/component/base/OptionContainer","common/component/panel/trait/resizablePanelTrait","text!./template/dialogTemplate.htm","text!./template/dialogButtonTemplate.htm"],function(e){"use strict";e("jquery.ui"),e("css!common/dialog");var t=e("underscore"),o=e("jquery"),r=e("../base/Dimmer"),i=e("common/component/panel/Panel"),n=e("common/component/base/OptionContainer"),s=e("common/component/panel/trait/resizablePanelTrait"),a=e("text!./template/dialogTemplate.htm"),d=e("text!./template/dialogButtonTemplate.htm"),l={},c=i.extend({defaultTemplate:a,events:{mousedown:"_focus",touchstart:"_focus",keydown:"_onKeyDown"},constructor:function(e){e||(e={}),e.traits||(e.traits=[]),this.resizable=e.resizable||!1,this.modal=e.modal||!1,this.resizable&&-1===t.indexOf(e.traits,s)&&e.traits.push(s),i.call(this,e)},initialize:function(e){l=t.extend({},e),this.collapsed=!this.collapsed,t.isEmpty(e.buttons)||(this.buttons=new n({options:e.buttons,el:this.$(".m-Dialog-footer")[0]||this.$(".footer")[0],contextName:"button",optionTemplate:d})),i.prototype.initialize.apply(this,arguments),this.buttons&&this.listenTo(this.buttons,t.map(e.buttons,function(e){return"button:"+e.action}).join(" "),t.bind(function(e,t){this.trigger("button:"+t.get("action"),e,t)},this)),this.render()},setElement:function(e){var t=i.prototype.setElement.apply(this,arguments);return this.buttons&&this.buttons.setElement(this.$(".m-Dialog-footer")[0]||this.$(".footer")[0]),t},setTitle:function(e){this.$(".m-Dialog-header > .m-Dialog-header-title").text(e)},render:function(){return this.$el.hide(),this.modal&&(this.dimmer=new r({zIndex:900})),o("body").append(this.$el),this.$el.draggable({handle:".mover",addClasses:!1,containment:"document"}),this},open:function(e){return this.isVisible()?void 0:(i.prototype.open.apply(this,arguments),this.modal&&this.dimmer.css({zIndex:++c.highestIndex}).show(),l.additionalCssClasses&&-1!==l.additionalCssClasses.indexOf("newResizeableDialog")&&this._setMinSize(),this._position(e)._increaseZIndex(),this.buttons&&this.buttons.$(".over").removeClass("over"),this.$el.show(),this.trigger("dialog:visible"),this)},close:function(){return this.isVisible()?(this.$el.css({zIndex:--c.highestIndex}),this.modal&&this.dimmer.css({zIndex:--c.highestIndex}).hide(),this.$el.hide(),i.prototype.close.apply(this,arguments),this):void 0},addCssClasses:function(e){this.$el.addClass(e)},toggleCollapsedState:function(){return this},enableButton:function(e){this.buttons.enable(e)},disableButton:function(e){this.buttons.disable(e)},isVisible:function(){return this.$el.is(":visible")},_setMinSize:function(){l.minWidth&&this.$el.css({width:l.minWidth,minWidth:l.minWidth}),l.minHeight&&this.$el.css({height:l.minHeight,minHeight:l.minHeight})},_position:function(e){var t,r,i=o("body"),n=this.$el.height(),s=this.$el.width();if(e&&"undefined"!=typeof e.top&&"undefined"!=typeof e.left){t=e.top,r=e.left;var a=i.height(),d=i.width(),l=a-e.top,c=d-e.left;n>l&&(t=e.top-n,t=0>t?a/2-n/2:t),s>c&&(r=e.left-s,r=0>r?d/2-s/2:r)}else t=o(window).height()/2-n/2,r=o(window).width()/2-s/2;return this.$el.css({top:t,left:r,position:"absolute"}),this},_focus:function(){!this.modal&&this._increaseZIndex()},_increaseZIndex:function(){this.$el.css({zIndex:++c.highestIndex})},_onKeyDown:function(e){this.buttons._onKeyDown(e)},remove:function(){this.buttons&&this.buttons.remove(),this.dimmer&&this.dimmer.remove();try{this.$el.draggable("destroy")}catch(e){}i.prototype.remove.call(this)}},{highestIndex:1e3,resetHighestIndex:function(e){c.highestIndex=e||1e3}});return c}),define("text!common/component/dialog/template/alertDialogTemplate.htm",[],function(){return"<p class='alertText'>\n    {{- message }}\n</p>"}),define("common/component/dialog/AlertDialog",["require","underscore","./Dialog","text!./template/alertDialogTemplate.htm","bundle!js-sdk/CommonBundle"],function(e){"use strict";var t=e("underscore"),o=e("./Dialog"),r=e("text!./template/alertDialogTemplate.htm"),i=e("bundle!js-sdk/CommonBundle");return o.extend({contentTemplate:t.template(r),constructor:function(e){e||(e={}),o.prototype.constructor.call(this,{modal:e.modal!==!1,message:e.message,additionalCssClasses:"alertDialog "+(e.additionalCssClasses||""),title:e.title||i["dialog.exception.title"],buttons:[{label:i["button.close"],action:"close",primary:!0}]},e)},initialize:function(e){o.prototype.initialize.apply(this,arguments),this.on("button:close",this.close),this.setMessage(e.message)},setMessage:function(e){this.content=this.contentTemplate({message:e});var t=this.renderContent();this.$contentContainer["string"==typeof e?"html":"append"](t)}})});var repositorySearch={_container:null,mode:null,isFlowRedirectRunning:!1,flowExecutionKey:"",messages:[],Mode:{SEARCH:"search",BROWSE:"browse",LIBRARY:"library"},ResourceType:{REPORT_UNIT:"com.jaspersoft.jasperserver.api.metadata.jasperreports.domain.ReportUnit",ADHOC_REPORT_UNIT:"com.jaspersoft.ji.adhoc.AdhocReportUnit",OLAP_UNIT:"com.jaspersoft.jasperserver.api.metadata.olap.domain.OlapUnit",DASHBOARD_RESOURCE:"com.jaspersoft.ji.adhoc.DashboardResource",DASHBOARD:"com.jaspersoft.ji.dashboard.DashboardModelResource",REPORT_OPTIONS:"com.jaspersoft.ji.report.options.metadata.ReportOptions",REPORT_DATA_SOURCE:"com.jaspersoft.jasperserver.api.metadata.jasperreports.domain.ReportDataSource",JDBC_REPORT_DATA_SOURCE:"com.jaspersoft.jasperserver.api.metadata.jasperreports.domain.JdbcReportDataSource",JNDI_JDBC_REPORT_DATA_SOURCE:"com.jaspersoft.jasperserver.api.metadata.jasperreports.domain.JndiJdbcReportDataSource",VIRTUAL_REPORT_DATA_SOURCE:"com.jaspersoft.jasperserver.api.metadata.jasperreports.domain.VirtualReportDataSource",CUSTOM_REPORT_DATA_SOURCE:"com.jaspersoft.jasperserver.api.metadata.jasperreports.domain.CustomReportDataSource",BEAN_REPORT_DATA_SOURCE:"com.jaspersoft.jasperserver.api.metadata.jasperreports.domain.BeanReportDataSource",OLAP_DATA_SOURCE:"com.jaspersoft.jasperserver.api.metadata.olap.domain.OlapDataSource",OLAP_CLIENT_CONNECTION:"com.jaspersoft.jasperserver.api.metadata.olap.domain.OlapClientConnection",QUERY:"com.jaspersoft.jasperserver.api.metadata.common.domain.Query",INPUT_CONTROL:"com.jaspersoft.jasperserver.api.metadata.common.domain.InputControl",LIST_OF_VALUES:"com.jaspersoft.jasperserver.api.metadata.common.domain.ListOfValues",LIST_OF_VALUES_ITEM:"com.jaspersoft.jasperserver.api.metadata.common.domain.ListOfValuesItem",DATA_TYPE:"com.jaspersoft.jasperserver.api.metadata.common.domain.DataType",MONDRIAN_CONNECTION:"com.jaspersoft.jasperserver.api.metadata.olap.domain.MondrianConnection",SECURE_MONDRIAN_CONNECTION:"com.jaspersoft.ji.ja.security.domain.SecureMondrianConnection",XMLA_CONNECTION:"com.jaspersoft.jasperserver.api.metadata.olap.domain.XMLAConnection",MONDRIAN_XMLA_DEFINITION:"com.jaspersoft.jasperserver.api.metadata.olap.domain.MondrianXMLADefinition",CONTENT_RESOURCE:"com.jaspersoft.jasperserver.api.metadata.common.domain.ContentResource",FILE_RESOURCE:"com.jaspersoft.jasperserver.api.metadata.common.domain.FileResource",SEMANTIC_LAYER_DATA_SOURCE:"com.jaspersoft.commons.semantic.datasource.SemanticLayerDataSource",DATA_DEFINER_UNIT:"com.jaspersoft.commons.semantic.DataDefinerUnit"},SearchAction:{NEXT:"next",GET_RESOURCE_CHILDREN:"getResourceChildren"},Event:{SEARCH_RUN:"search:run",SEARCH_BROWSE:"search:browse",SEARCH_FILTER:"search:filter",SEARCH_SORT:"search:sort",SEARCH_NEXT:"search:next",SEARCH_ROLLBACK:"search:rollback",SEARCH_SEARCH:"search:search",SEARCH_CHILDREN:"search:children",STATE_CHANGED:"state:changed",FILTER_PATH_CHANGED:"filterPath:changed",RESULT_CHANGED:"result:changed",CHILDREN_LOADED:"resourceChildren:loaded",RESULT_NEXT:"result:next",RESULT_ERROR:"result:error",REDIRECT_ERROR:"redirect:error",FLOW_REDIRECT_RUNNING:"flowRedirect:running"},InfoAction:{GET_DISPLAY_PATH:"getDisplayPath"},PermissionAction:{BROWSE:"permissionBrowse",SEARCH:"permissionSearch",NEXT:"permissionNext",UPDATE:"permissionsUpdate"},PermissionEvent:{BROWSE:"permission:browse",SEARCH:"permission:search",NEXT:"permission:next",UPDATE:"permission:update",LOADED:"permission:loaded",UPDATED:"permission:updated",ERROR:"permission:error"},FolderAction:{CREATE:"createFolder",COPY:"copyFolder",MOVE:"moveFolder",UPDATE:"updateFolder",DELETE:"deleteFolder"},FolderEvent:{DELETED:"folder:deleted",DELETE_ERROR:"folder:deleteError",CREATED:"folder:created",CREATE_ERROR:"folder:createError",COPIED:"folder:copied",COPY_ERROR:"folder:copyError",MOVED:"folder:moved",MOVE_ERROR:"folder:moveError",UPDATED:"folder:updated",UPDATE_ERROR:"folder:updateError"},ResourceAction:{DELETE:"deleteResources",COPY:"copyResources",MOVE:"moveResources",UPDATE:"updateResource",GENERATE:"generate",CONVERT:"convert"},ResourceEvent:{DELETED:"resource:deleted",DELETE_ERROR:"resource:deleteError",COPIED:"resource:copied",COPY_ERROR:"resource:copyError",MOVED:"resource:moved",MOVE_ERROR:"resource:moveError",UPDATED:"resource:updated",UPDATE_ERROR:"resource:updateError",GENERATED:"resource:generated",GENERATE_ERROR:"resource:generateError",CONVERTED:"resource:converted",CONVERT_ERROR:"resource:convertError"},RedirectType:{FLOW_REDIRECT:0,LOCATION_REDIRECT:1,WINDOW_REDIRECT:2},ThemeAction:{SETTHEME:"setActiveTheme",DOWNLOAD_THEME:"downloadTheme",REUPLOAD:"reuploadTheme"},ThemeEvent:{UPDATED:"theme:updated",REUPLOADED:"theme:reuploaded",THEME_ERROR:"theme:error"},initialize:function(e){function t(e,t){if(e){var o="USER"==t?orgModule.User:orgModule.Role;return e.collect(function(e){return new o(e)})}return[]}var o=e.rsInitOptions;repositorySearch.mode=o.mode,repositorySearch.flowExecutionKey=o.flowExecutionKey,layoutModule.resizeOnClient("repoSearch"==document.body.id?"searchFilters":"folders","results"),webHelpModule.setCurrentContext(repositorySearch.mode===repositorySearch.Mode.SEARCH?"search":"repo"),o.enableDnD=repositorySearch.mode==repositorySearch.Mode.BROWSE&&!isIPad(),repositorySearch.model.setPublicFolderUri(o.publicFolderUri),repositorySearch.model.setTempFolderUri(o.tempFolderUri),repositorySearch.model.setRootFolderUri(o.rootFolderUri),repositorySearch.model.setOrganizationsFolderUri(o.organizationsFolderUri),repositorySearch.model.setFolderSeparator(o.folderSeparator),repositorySearch.model.setAdministrator(o.isAdministrator),repositorySearch.model.setConfiguration(o.configuration),repositorySearch.model.setServerState(o.state),repositorySearch.CursorManager.initialize(),repositorySearch.actionModel.initialize(),repositorySearch.mode==repositorySearch.Mode.BROWSE?(repositorySearch.toolbar.initialize(repositorySearch.actionModel.bulkActions),repositorySearch.foldersPanel.initialize(o)):(repositorySearch.filtersPanel.initialize(repositorySearch.model.getFiltersConfiguration(),repositorySearch.model.getFiltersState()),repositorySearch.secondarySearchBox.initialize(repositorySearch.model.getTextState()),repositorySearch.filterPath.initialize()),repositorySearch.resultsPanel.initialize(o),repositorySearch.sortersPanel.initialize(repositorySearch.model.getSortersConfiguration(),repositorySearch.model.getSortState()),repositorySearch.initFolderEvents(),repositorySearch.initResourceEvents(),repositorySearch.initThemeEvents(),repositorySearch.observe("search:filter",function(e){var t=new repositorySearch.ServerAction.createSearchAction("filter",{filterId:e.memo.filterId,filterOption:e.memo.optionId});t.invokeAction()}),repositorySearch.observe("search:sort",function(e){var t=new repositorySearch.ServerAction.createSearchAction("sort",{sortBy:e.memo.sorterId});t.invokeAction()}),repositorySearch.observe("search:browse",function(e){var t=new repositorySearch.ServerAction.createSearchAction("browse",{folderUri:e.memo.uri});t.invokeAction(),repositorySearch.actionModel.refreshToolbar()}),repositorySearch.observe("search:search",function(e){var t=new repositorySearch.ServerAction.createSearchAction("search",{text:e.memo.text});t.invokeAction()}),repositorySearch.observe("search:next",function(e){
var t=new this.ServerAction.createSearchAction(this.SearchAction.NEXT,{});t.invokeAction()}.bindAsEventListener(repositorySearch)),repositorySearch.observe("search:rollback",function(e){var t=new repositorySearch.ServerAction.createSearchAction("rollback",{position:e.memo.position});t.invokeAction()}),repositorySearch.observe("search:children",function(e){var t=e.memo.resource,o=e.memo.item,r=new this.ServerAction.createSearchAction(this.SearchAction.GET_RESOURCE_CHILDREN,{resourceUri:t.URIString,resourceType:t.resourceType,item:o});r.invokeAction()}.bindAsEventListener(repositorySearch)),repositorySearch.observe("permission:browse",function(e){var t=new repositorySearch.ServerAction.createPermissionAction(this.PermissionAction.BROWSE,e.memo);t.invokeAction()}.bindAsEventListener(repositorySearch)),repositorySearch.observe("permission:search",function(e){var t=new repositorySearch.ServerAction.createPermissionAction(this.PermissionAction.SEARCH,e.memo);t.invokeAction()}.bindAsEventListener(repositorySearch)),repositorySearch.observe("permission:next",function(e){var t=new repositorySearch.ServerAction.createPermissionAction(this.PermissionAction.NEXT,e.memo);t.invokeAction()}.bindAsEventListener(repositorySearch)),repositorySearch.observe("permission:update",function(e){var t=e.memo.uri,o=e.memo.entities,r=e.memo.finishEdit;if(o.length>0){var i=o.collect(function(e){return e.toPermissionData()}),n=new repositorySearch.ServerAction.createPermissionAction(this.PermissionAction.UPDATE,{uri:t,entitiesWithPermission:Object.toJSON(i),finishEdit:r});n.invokeAction()}else{var s=repositorySearch.dialogsPool.getPermissionsDialog(t);r&&s.hide()}}.bindAsEventListener(repositorySearch)),repositorySearch.observe("permission:loaded",function(e){var o=e.memo.responseData,r=repositorySearch.dialogsPool.getPermissionsDialog(e.memo.inputData.uri);r.stopWaiting(),o&&(e.memo.doSet?r.setEntities(t(o.entities,o.type)):r.addEntities(t(o.entities,o.type)),"USER"===o.type?(buttonManager.select(r._byUsersButton.parentNode),buttonManager.unSelect(r._byRolesButton.parentNode)):(buttonManager.unSelect(r._byUsersButton.parentNode),buttonManager.select(r._byRolesButton.parentNode)))}.bindAsEventListener(repositorySearch)),repositorySearch.observe("permission:updated",function(e){var o=e.memo.inputData.uri,r=e.memo.inputData.finishEdit,i=repositorySearch.dialogsPool.getPermissionsDialog(o);if(i.enable(),r)i.hide();else{var n=e.memo.responseData;n&&i.updateEntities(t(n.entities,n.type))}}.bindAsEventListener(repositorySearch)),repositorySearch.observe("permission:error",function(e){alert(Object.toJSON(e.memo))}.bindAsEventListener(repositorySearch)),repositorySearch.observe("resourceChildren:loaded",function(e){var t=e.memo.inputData.item,o=t.getValue(),r=e.memo.responseData;if(Object.isArray(r)){var i=[];r.each(function(e){var t=new Resource(e);o.addChild(t),i.push(t)}),repositorySearch.resultsPanel.setResources(i,t),o.isLoaded()&&t.isLoading&&t.setLoading(!1)}}.bindAsEventListener(repositorySearch)),repositorySearch.observe("state:changed",function(e){repositorySearch.updateUI(e.memo.state)}),repositorySearch.observe("filterPath:changed",function(e){repositorySearch.filterPath.setPathItems(e.memo.filterPath)}),repositorySearch.observe("result:changed",function(e){var t=e.memo.resources,o=t.collect(function(e){return new Resource(e)});repositorySearch.resultsPanel.setResources(o)}),repositorySearch.observe("result:next",function(e){var t=e.memo.resources,o=t.collect(function(e){return new Resource(e)});repositorySearch.resultsPanel.addResources(o)}),repositorySearch.observe("result:error",this.defaultErrorHandler),repositorySearch.observe("redirect:error",this.defaultErrorHandler),repositorySearch.observe("flowRedirect:running",function(){repositorySearch.isflowRedirectRunning=!0,repositorySearch.toolbar.refresh()}),repositorySearch.Mode.BROWSE!=o.mode&&repositorySearch.fire(repositorySearch.Event.SEARCH_SEARCH,{text:repositorySearch.model.getTextState()}),e.rsInitOptions.systemConfirm.blank()||dialogs.systemConfirm.show(e.rsInitOptions.systemConfirm),JRS.reportExecutionCounter&&JRS.reportExecutionCounter.check(),e.rsInitOptions.errorPopupMessage.blank()||dialogs.errorPopup.show(e.rsInitOptions.errorPopupMessage)},showContextMenu:function(e){var t=e.memo.targetEvent;if(repositorySearch.mode==repositorySearch.Mode.BROWSE&&repositorySearch.foldersPanel.isFolderContextMenu(t)&&repositorySearch.actionModel.showFolderMenu(t),repositorySearch.resultsPanel.isResourceContextMenu(t)){var o=repositorySearch.model.getSelectedResources();o.length>1?repositorySearch.actionModel.showResourceBulkMenu(t):repositorySearch.actionModel.showResourceMenu(t)}},updateUI:function(e){e.sortBy!=repositorySearch.model.getSortState()&&repositorySearch.sortersPanel.select(e.sortBy,!0),e.text!=repositorySearch.model.getTextState()&&repositorySearch.mode!=repositorySearch.Mode.BROWSE&&repositorySearch.secondarySearchBox.setText(e.text);for(var t in e.customFilters)e.customFilters[t]!=repositorySearch.model.getFiltersState()[t]&&repositorySearch.filtersPanel.select(t,e.customFilters[t],!0);e.folderUri!=repositorySearch.model.getFolderUriState(),repositorySearch.model.setServerState(e)},initFolderEvents:function(){this.observe("folder:deleted",function(e){var t=e.memo.inputData.folder,o=t.getParentFolder(),r=repositorySearch.foldersPanel;r.refreshFolder(o),"/"===o.URI&&r.tree._selectOrEditNode(void 0,o.node,!1)}),this.observe("folder:deleteError",this.defaultErrorHandler),this.observe("folder:created",function(e){var t=e.memo.inputData.toFolder;repositorySearch.foldersPanel.refreshFolder(t)}),this.observe("folder:createError",this.defaultErrorHandler),this.observe("folder:copied",function(e){var t=e.memo.inputData.folder,o=e.memo.inputData.toFolder;repositorySearch.CopyMoveController.cancel(),repositorySearch.foldersPanel.moveOrCopyFolder(t,o,!0)}),this.observe("folder:copyError",this.defaultErrorHandler),this.observe("folder:moved",function(e){var t=e.memo.inputData.folder,o=e.memo.inputData.toFolder;repositorySearch.CopyMoveController.cancel(),repositorySearch.foldersPanel.moveOrCopyFolder(t,o)}),this.observe("folder:moveError",this.defaultErrorHandler),this.observe("folder:updated",function(e){var t=e.memo.inputData.folder,o=e.memo.responseData.label,r=e.memo.responseData.desc;repositorySearch.foldersPanel.updateFolder(t,o,r)}),this.observe("folder:updateError",this.defaultErrorHandler)},initResourceEvents:function(){this.observe("resource:deleted",function(e){var t=e.memo.inputData.resources,o=e.memo.responseData;if(o.dependentResources)dialogs.dependentResources.show(o.dependentResources,null,{okOnly:!0,canSave:!1,topMessage:repositorySearch.messages["dialog.dependencies.resources.message"],bottomMessage:repositorySearch.messages["dialog.dependencies.resources.deleteMessage"]});else{repositorySearch.model.getSelectedFolder();repositorySearch.resultsPanel.removeResources(t)}}),this.observe("resource:deleteError",this.defaultErrorHandler),this.observe("resource:copied",function(e){var t=e.memo.inputData.folder;repositorySearch.foldersPanel.reselectFolder(t)}),this.observe("resource:copyError",this.defaultErrorHandler),this.observe("resource:moved",function(e){var t=e.memo.inputData.folder,o=repositorySearch.model.getSelectedFolder();repositorySearch.foldersPanel.reselectFolder(t),repositorySearch.foldersPanel.reselectFolder(o)}),this.observe("resource:moveError",this.defaultErrorHandler),this.observe("resource:updated",function(e){repositorySearch.resultsPanel.updateResource(new Resource(e.memo.responseData))}),this.observe("resource:updateError",this.defaultErrorHandler),this.observe("resource:generated",function(e){var t=e.memo.inputData,o=e.memo.responseData,r=new Resource(o);if(t.run){var i=repositorySearch.RedirectAction.createRunResourceAction(r,!1);i.invokeAction()}else repositorySearch.mode==repositorySearch.Mode.BROWSE?t.location==repositorySearch.foldersPanel.getSelectedUri()&&repositorySearch.foldersPanel.doBrowse():repositorySearch.fire(repositorySearch.Event.SEARCH_SEARCH,{text:repositorySearch.model.getTextState()});dialogs.systemConfirm.show(repositorySearch.messages.RM_REPORT_CREATED,5e3)}),this.observe("resource:generateError",function(e){var t,o=(e.memo.inputData,e.memo.responseData),r=o.msg,i=o.data;if(r&&r.indexOf("SYSTEM_CONFIRM_REQUIRED")>-1){var n=Utils.restOfString(r,"SYSTEM_CONFIRM_REQUIRED:");if(i&&confirm(n)){i.overwrite=!0;var s=repositorySearch.ResourceAction.GENERATE;t=new repositorySearch.ServerAction.createGenerateAction(s,i),t.invokeAction()}}else repositorySearch.defaultErrorHandler(e)}),this.observe("resource:converted",function(e){dialogs.systemConfirm.show(e.memo.responseData||e.memo,5e3),repositorySearch.mode==repositorySearch.Mode.BROWSE?repositorySearch.foldersPanel.doBrowse():repositorySearch.fire(repositorySearch.Event.SEARCH_SEARCH,{text:repositorySearch.model.getTextState()})}),this.observe("resource:convertError",this.defaultErrorHandler)},defaultErrorHandler:function(e){require(["common/component/dialog/AlertDialog","bundle!jasperserver_messages"],function(t,o){var r=new t({title:o["dialog.dependencies.title"]});r.setMessage(e.memo.responseData||e.memo),r.open()})},initThemeEvents:function(){this.observe("theme:updated",function(e){var t=e.memo.responseData;if(t&&t.refresh)document.body.style.cursor="wait",window.location.reload(!0);else{var o=repositorySearch&&repositorySearch.model&&repositorySearch.model.getContextFolder()&&repositorySearch.model.getContextFolder().getParentFolder();o&&repositorySearch.foldersPanel&&repositorySearch.foldersPanel.refreshFolder&&repositorySearch.foldersPanel.refreshFolder(o)}}),this.observe("theme:reuploaded",function(e){if(e.memo.responseData.isActiveTheme){var t=e.memo.responseData.themeUri,o=new repositorySearch.ServerAction.createFolderAction(repositorySearch.ThemeAction.SETTHEME,{folderUri:t});o.invokeAction()}}),this.observe("theme:error",function(e){var t=e.memo.responseData;t&&alert(t)})},getMessage:function(e,t){var o=repositorySearch.messages[e];return o?new Template(o).evaluate(t?t:{}):""},_createAction:function(e,t){var o;if(t.endsWith("FolderAction")){var r=repositorySearch.model.getContextFolder();o=e["create"+t].call(null,r)}else if(t.endsWith("ResourceAction")||t.endsWith("RunAction")){var i=repositorySearch.model.getContextResource();o=e["create"+t].call(null,i)}else o=e["create"+t].call();return o},observe:function(e,t){this._getContainer().observe(e,t)},stopObserving:function(e,t){this._getContainer().stopObserving(e,t)},fire:function(e,t){this._getContainer().fire(e,t)},_getContainer:function(){return this._container||(this._container=document.body),this._container}};repositorySearch.model={_organizationsFolderUri:null,_rootFolderUri:null,_tempFolderUri:null,_publicFolderUri:null,_folderSeparator:null,_configuration:{},_serverState:{},_uiState:{selectedFolder:null,contextFolder:null,contextResource:null,selectedResources:[]},_isAdministrator:!1,setOrganizationsFolderUri:function(e){this._organizationsFolderUri=e},getOrganizationsFolderUri:function(){return this._organizationsFolderUri},setRootFolderUri:function(e){this._rootFolderUri=e},getRootFolderUri:function(){return this._rootFolderUri},setTempFolderUri:function(e){this._tempFolderUri=e},getTempFolderUri:function(){return this._tempFolderUri},setPublicFolderUri:function(e){this._publicFolderUri=e},getPublicFolderUri:function(){return this._publicFolderUri},setFolderSeparator:function(e){this._folderSeparator=e},getFolderSeparator:function(){return this._folderSeparator},setConfiguration:function(e){this._configuration=e},getConfiguration:function(){return this._configuration},getFiltersConfiguration:function(){return this.getConfiguration().filters},getSortersConfiguration:function(){return this.getConfiguration().sorters},setServerState:function(e){this._serverState=e},getServerState:function(){return this._serverState},getUIState:function(){return this._uiState},setAdministrator:function(e){this._isAdministrator=e},isAdministrator:function(){return this._isAdministrator},getFiltersState:function(){return this.getServerState().customFilters},getSortState:function(){return this.getServerState().sortBy},getTextState:function(){return this.getServerState().text},getFolderUriState:function(){return this.getServerState().folderUri},setSelectedFolder:function(e){return this.getUIState().selectedFolder=e},getSelectedFolder:function(){return this.getUIState().selectedFolder},setContextFolder:function(e){return this.getUIState().contextFolder=e},getContextFolder:function(){return this.getUIState().contextFolder},setSelectedResources:function(e){return this.getUIState().selectedResources=e},getSelectedResources:function(){return this.getUIState().selectedResources}},repositorySearch.actionModel={bulkActions:{RUN:{buttonId:"run",action:invokeBulkAction,actionArgs:"Run",test:canAllBeRun},EDIT:{buttonId:"edit",action:invokeBulkAction,actionArgs:"Edit",test:canAllBeEdited},OPEN:{buttonId:"open",action:invokeBulkAction,actionArgs:"Open",test:canAllBeOpened},COPY:{buttonId:"copy",action:invokeBulkAction,actionArgs:"Copy",test:canAllBeCopied},CUT:{buttonId:"cut",action:invokeBulkAction,actionArgs:"Move",test:canAllBeMoved},PASTE:{buttonId:"paste",action:invokeFolderAction,actionArgs:"PasteResources",test:canAllBePasted},REMOVE:{buttonId:"remove",action:invokeBulkAction,actionArgs:"Delete",test:canAllBeDeleted}},_holderId:"searchActionModel",_folderMenu:"folder_mutton",_resourceMenu:"resource_menu",_resourceBulkMenu:"resource_bulk_menu",initialize:function(){var e=$(layoutModule.PAGE_BODY_ID);e&&e.observe(isSupportsTouch()?"touchstart":"click",function(e){isIPad()?!isRightClick(e)&&1==e.touches.length&&actionModel.hideMenu():!isRightClick(e)&&actionModel.hideMenu()})},showFolderMenu:function(e,t){actionModel.showDynamicMenu(this._folderMenu,e,null,t,this._holderId)},showResourceBulkMenu:function(e,t){actionModel.showDynamicMenu(this._resourceBulkMenu,e,null,t,this._holderId)},showResourceMenu:function(e,t){actionModel.showDynamicMenu(this._resourceMenu,e,null,t,this._holderId)},refreshToolbar:function(e){repositorySearch.toolbar.refresh()}},repositorySearch.CopyMoveController={object:null,_move:!1,_copy:!1,_dndMode:!1,onMove:function(){repositorySearch.CursorManager.move(),repositorySearch.actionModel.refreshToolbar()},onCopy:function(){repositorySearch.CursorManager.copy(),repositorySearch.actionModel.refreshToolbar()},onCancel:function(){repositorySearch.CursorManager.none(),repositorySearch.actionModel.refreshToolbar()},isObjectInstanceOf:function(e){var t=this.object;return t?this.isBulkAction()?t.length==t.findAll(function(t){return t instanceof e}).length:t instanceof e:!1},isMoveResource:function(){return this._move&&this.isObjectInstanceOf(Resource)},isMoveFolder:function(){return this._move&&this.isObjectInstanceOf(Folder)},isCopyResource:function(){return this._copy&&this.isObjectInstanceOf(Resource)},isCopyFolder:function(){return this._copy&&this.isObjectInstanceOf(Folder)},isBulkAction:function(){return Object.isArray(this.object)},move:function(e,t){this.cancel(),this.object=e,this._move=!0,this._copy=!1,this._dndMode=t,this.onMove()},copy:function(e,t){this.cancel(),this.object=e,this._move=!1,this._copy=!0,this._dndMode=t,this.onCopy()},cancel:function(){this.object=null,this._move=!1,this._copy=!1,this.onCancel()},isMove:function(){return this._move},isCopy:function(){return this._copy},isDnd:function(){return this._dndMode}},repositorySearch.CursorManager={container:null,className:["copy_cursor","move_cursor"],initialize:function(){this.container=$("display")},copy:function(){this.none(),this.container.addClassName(this.className[0])},move:function(){this.none(),this.container.addClassName(this.className[1])},none:function(){this.className.each(function(e,t){this.container.removeClassName(this.className[t])}.bind(this))}};var Resource=function(e){this._json=e,this.name=e.name,this.label=e.label,this.description=e.description,this.date=e.date,this.dateTimestamp=e.dateTimestamp,this.dateTime=e.dateTime,this.updateDate=e.updateDate,this.updateDateTimestamp=e.updateDateTimestamp,this.updateDateTime=e.updateDateTime,this.URI=e.URI,this.URIString=e.URIString,this.parentUri=e.parentUri,this.parentFolder=e.parentFolder,this.resourceType=e.resourceType,this.type=e.type,this.isScheduled=e.scheduled,this._permissions=e.permissions,this.hasChildren=e.hasChildren,this.isChild=!1,this.parentResource=null,this.isOpen=!1,this._children=[]};Resource.addMethod("clone",function(){return new Resource(this._json)}),Resource.addMethod("isReadable",function(){return this._permissions.include("r")}),Resource.addMethod("isEditable",function(){return this._permissions.include("e")}),Resource.addMethod("isRemovable",function(){return this._permissions.include("d")}),Resource.addMethod("isAdministrable",function(){return this._permissions.include("a")}),Resource.addMethod("typeEquals",function(e){return this.resourceType===e}),Resource.addMethod("typeSuffix",function(){return this.resourceType.split(".").last()}),Resource.addMethod("isLoaded",function(){return this._children.size()>0}),Resource.addMethod("isFolder",function(){return!1}),Resource.addMethod("getChildren",function(e){return this._children}),Resource.addMethod("addChild",function(e){e.isChild=!0,e.parentResource=this,this._children.push(e)}),Resource.addMethod("updateChild",function(e){e.isChild=!0,e.parentResource=this;var t=-1;this._children.each(function(o,r){o.URIString==e.URIString&&(t=r)}),t>-1?this._children[t]=e:this._children.push(e)}),Resource.addMethod("permissionsToString",function(){var e="";return e+=this.isEditable()?repositorySearch.messages["permission.modify"]:repositorySearch.messages["permission.readOnly"],this.isRemovable()&&(e+=", "+repositorySearch.messages["permission.delete"]),this.isAdministrable()&&(e+=", "+repositorySearch.messages["permission.administer"]),e});var Folder=function(e){this.node=e,this.name=e.param.id,this.label=xssUtil.unescape(e.name),this.desc=e.param.extra.desc?xssUtil.unescape(e.param.extra.desc):"",this.description=xssUtil.unescape(this.desc),this.date=e.param.extra.date?xssUtil.unescape(e.param.extra.date):"",this.URI=e.param.uri,this.URIString=e.param.uri};Folder.prototype=deepClone(Resource.prototype),Folder.addMethod("clone",function(){return new Folder(this.node)}),Folder.addMethod("getParentFolder",function(){return this.isRoot()?null:new Folder(this.node.parent)}),Folder.addMethod("getReadableUri",function(){return this.isRoot()?"":this.getParentFolder().getReadableUri()+repositorySearch.model.getFolderSeparator()+this.label}),Folder.addMethod("isRoot",function(){return this.URI==repositorySearch.model.getRootFolderUri()||null==this.node.parent}),Folder.addMethod("isPublic",function(){return this.URI==repositorySearch.model.getPublicFolderUri()}),Folder.addMethod("isTemp",function(){return this.URI==repositorySearch.model.getTempFolderUri()}),Folder.addMethod("isOrganization",function(){return this.URI.match(repositorySearch.model.getOrganizationsFolderUri()+"/[^/]+$")}),Folder.addMethod("isOrganizationsRoot",function(){return this.URI.match(repositorySearch.model.getOrganizationsFolderUri()+"$")}),Folder.addMethod("isReadable",function(){return!0}),Folder.addMethod("isEditable",function(){return this.node.param.extra.isWritable}),Folder.addMethod("isRemovable",function(){return this.node.param.extra.isRemovable}),Folder.addMethod("isAdministrable",function(){return this.node.param.extra.isAdministrable}),Folder.addMethod("isSelected",function(){return this.node.isSelected()}),Folder.addMethod("equals",function(e){return e&&this.URI==e.URI}),Folder.addMethod("isThemeFolder",function(){return this.node.param.extra&&this.node.param.extra.isThemeFolder}),Folder.addMethod("isThemeRootFolder",function(){return this.node.param.extra&&this.node.param.extra.isThemeRootFolder}),Folder.addMethod("isActiveThemeFolder",function(){return this.node.param.extra&&this.node.param.extra.isActiveThemeFolder}),Folder.addMethod("isFolder",function(){return!0});var ResourcesUtils={getResourceUris:function(e){var t=[];return e.each(function(e){t.push(e.URIString?e.URIString:e.URI)}),t},getResourceUriAndTypeList:function(e){var t=[];return e.each(function(e){var o=e.URIString?e.URIString:e.URI;t.push({URIString:o,type:e.type})}),t},checkNameLength:function(e){return!e.blank()&&e.length<=repositorySearch.model.getConfiguration().resourceNameMaxLength},checkDescriptionLength:function(e){return e.length<=repositorySearch.model.getConfiguration().resourceDescriptionMaxLength},labelValidator:function(e){var t=!0,o="";return e.blank()?(o=repositorySearch.messages.RE_INVALID_NAME_SIZE.replace("{0}",repositorySearch.model.getConfiguration().resourceLabelMaxLength),t=!1):e.length>repositorySearch.model.getConfiguration().resourceLabelMaxLength&&(o=repositorySearch.messages.RE_INVALID_NAME_SIZE.replace("{0}",repositorySearch.model.getConfiguration().resourceLabelMaxLength),t=!1),{isValid:t,errorMessage:o}},descriptionValidator:function(e){var t=!0,o="";return e.length>repositorySearch.model.getConfiguration().resourceDescriptionMaxLength&&(o=repositorySearch.messages.RE_INVALID_DESC_SIZE.replace("{0}",repositorySearch.model.getConfiguration().resourceDescriptionMaxLength),t=!1),{isValid:t,errorMessage:o}},_fileTypeValidatorTemplate:function(e,t){var o=!0,r="";return!e||e.blank()?(r=repositorySearch.messages.RE_ENTER_FILE_NAME,o=!1):e.toLowerCase().endsWith(t)||(r=repositorySearch.messages.RE_INVALID_FILE_TYPE.replace("{0}",t),o=!1),{isValid:o,errorMessage:r}},zipFileTypeValidator:function(e){return ResourcesUtils._fileTypeValidatorTemplate(e,".zip")},isCustomDataSource:function(e){return _.contains(Utils.getInitConfiguration().customDataSources,e.resourceType)}},Utils={restOfString:function(e,t){var o=e.lastIndexOf(t)+t.length;return e.substring(o,e.length).trim()},getInitOptions:function(){return localContext.rsInitOptions||__jrsConfigs__.repositorySearch.localContext.rsInitOptions},getInitConfiguration:function(){return Utils.getInitOptions().configuration}};document.observe("element:contextmenu",repositorySearch.showContextMenu.bindAsEventListener(repositorySearch)),document.observe("key:escape",function(e){actionModel.hideMenu(),Event.stop(e)}),document.observe("key:delete",function(e){e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement||canAllBeDeleted()&&invokeBulkAction("Delete")}),designerBase=void 0,define("repository.search.main",["prototype","actionModel.modelGenerator","utils.common","common/component/dialog/AlertDialog"],function(e){return function(){var t;return t||e.repositorySearch}}(this));var dynamicTree={trees:{},nodes:{},treeNodeEdited:null,editaborted:!1,activeTreeId:null,Tree:function(e,t){this.id=e,t?(this.setRootNode(t.root),this.bShowRoot=!!t.bShowRoot,this.handleNodeOnDblclick=void 0!==t.handleNodeOnDblclick?t.handleNodeOnDblclick:!0,this.multiSelectEnabled=!!t.multiSelectEnabled,this.showAllNodesOnStartup=!!t.showAllNodesOnStartup,this.treeClassName=t.treeClassName?t.treeClassName:"",this.dragPattern=t.dragPattern,this.dragClasses=t.dragClasses,this.dropClasses=t.dropClasses,this.selectOnMousedown=t.selectOnMousedown,this.regionID=t.regionID,this.scroll=t.scroll,this.templateDomId=t.templateDomId?t.templateDomId:this.DEFAULT_TREE_TEMPLATE_ID):(this.templateDomId=this.DEFAULT_TREE_TEMPLATE_ID,this.handleNodeOnDblclick=!0),this.stateObject={},this.sortNodes=!0,this.sorters=[this.sortByOrder,this.sortByName],this.selectedNodes=[],this.TREE_NN_ITEMS_SELECTED="#{count} items selected",dynamicTree.trees[this.id]=this,this._createFromTemplate(),this.refreshStyle(),this._registerEvents(),this._registerCustomScroll()},getNextId:function(){var e=1;return function(){return e++}}(),getActiveTree:function(){return dynamicTree.trees[dynamicTree.activeTreeId]},getTreeNode:function(e){return dynamicTree.nodes[e]},getStorageVal:function(e){var t=JSON.parse(window.localStorage.getItem("dynamicTree"))||{};return t[e]||null},setStorageVal:function(e,t){var o=window.localStorage,r=JSON.parse(o.getItem("dynamicTree"))||{};r[e]=t;try{o.setItem("dynamicTree",JSON.stringify(r))}catch(i){window.console&&console.log(i)}},_templateHash:{}};dynamicTree.Tree.addVar("DEFAULT_TREE_TEMPLATE_ID","list_responsive_collapsible"),dynamicTree.Tree.addVar("HIDE_ROOT_CLASS_NAME","hideRoot"),dynamicTree.Tree.addMethod("getId",function(){return this.id}),dynamicTree.Tree.addMethod("_getElement",function(){return this._element||(this._element=$(this.id)),this._element}),dynamicTree.Tree.addMethod("_createFromTemplate",function(){this._getElement()&&(this._getElement().insert({after:this._getTemplateElement(this._getElement())}),this._getElement().remove(),this._element=null,this._getElement().update())}),dynamicTree.Tree.addMethod("_registerCustomScroll",function(){if(!this.scroll&&this._getElement()){var e=this._getElement().up(layoutModule.SWIPE_SCROLL_PATTERN);if(e){var t=layoutModule.scrolls.get(e.identify());t&&(this.scroll=t)}}}),dynamicTree.Tree.addMethod("setRootNode",function(e){this.rootNode=e,this.rootNode&&(this.rootNode.treeId=this.id)}),dynamicTree.Tree.addMethod("getRootNode",function(){return this.rootNode}),dynamicTree.Tree.addMethod("refreshStyle",function(){var e=this._getElement();e.templateClassName&&(e.className=e.templateClassName),this.treeClassName&&e.addClassName(this.treeClassName),this.bShowRoot?e.removeClassName(this.HIDE_ROOT_CLASS_NAME):e.addClassName(this.HIDE_ROOT_CLASS_NAME)}),dynamicTree.Tree.addMethod("resetSelected",function(){this._prevSelectedNodes=this.selectedNodes.clone(),this.selectedNodes=[]}),dynamicTree.Tree.addMethod("revertSelection",function(e){var t=this._prevSelectedNodes.clone();t=t.concat(this.selectedNodes),this.selectedNodes=this._prevSelectedNodes.clone();for(var o=0;o<t.length;o++)t[o].refreshStyle()}),dynamicTree.Tree.addMethod("getSelectedNode",function(){return 0===this.selectedNodes.length?null:this.selectedNodes[0]}),dynamicTree.Tree.addMethod("addNodeToSelected",function(e){this.selectedNodes.push(e),this._prevSelectedNodes=this.selectedNodes.clone()}),dynamicTree.Tree.addMethod("removeNodeFromSelected",function(e){for(var t=0;t<this.selectedNodes.length;t++)if(this.selectedNodes[t]==e)return this._prevSelectedNodes=this.selectedNodes.clone(),void this.selectedNodes.splice(t,1)}),dynamicTree.Tree.addMethod("isNodeSelected",function(e){var t=this.selectedNodes&&this.selectedNodes.length;if(t)for(var o=0;t>o;o++)if(this.selectedNodes[o]==e)return!0;return!1}),dynamicTree.Tree.addMethod("resortSubtree",function(e){if(e){e.resortChilds();for(var t=0;t<e.childs.length;t++)this.resortSubtree(e.childs[t])}}),dynamicTree.Tree.addMethod("resortTree",function(){this.sortNodes&&this.resortSubtree(this.rootNode)}),dynamicTree.Tree.addMethod("readStates",function(){var e=dynamicTree.getStorageVal("tree"+this.id);if(e)for(var t in e)this.stateObject[t]=e[t]}),dynamicTree.Tree.addMethod("getState",function(e){var t,o=this.stateObject;return o[e]?(t=o[e],(null===t||""===t)&&(t=dynamicTree.TreeNode.State.CLOSED),t):dynamicTree.TreeNode.State.CLOSED}),dynamicTree.Tree.addMethod("writeStates",function(e,t){var o={},r=this.stateObject;for(var i in r)o[i]=r[i];r[e]=t,null!=t&&(o[e]=t),dynamicTree.setStorageVal("tree"+this.id,o)}),dynamicTree.Tree.addMethod("resetStates",function(){this.stateObject={},dynamicTree.setStorageVal("tree"+this.id,"")}),dynamicTree.Tree.addMethod("comparer",function(e,t){var o,r;if(this.sorters&&this.sorters.length)for(o=0;o<this.sorters.length;o++)if(r=this.sorters[o](e,t),0!==r)return r;return 0}),dynamicTree.Tree.addMethod("renderTree",function(){this.readStates(),this.stopWaiting(),this.refreshStyle();var e=this._getElement();this.rootNode&&(this.writeStates(this.rootNode.id,dynamicTree.TreeNode.State.OPEN),this.rootNode.showNode(),this.rootNode.render(e),this.refreshScroll())}),dynamicTree.Tree.addMethod("refreshScroll",function(e){e?setTimeout(function(){this.scroll&&this.scroll.refresh()}.bind(this),e):this.scroll&&this.scroll.refresh()}),dynamicTree.Tree.addMethod("binarySearchOfNode",function(e,t){for(var o=0,r=e.length-1;r>=o;){var i=Math.round((o+r)/2),n=e[i];if(this.comparer(n,t)<0)o=i+1;else{if(!(this.comparer(n,t)>0))return i;r=i-1}}return-(o+1)}),dynamicTree.Tree.addMethod("_deselectAllNodes",function(e){if(this.selectedNodes.length>0){var t=this.selectedNodes.clone();this.resetSelected();for(var o=0;o<t.length;o++)t[o].refreshStyle();if(e){var r=dynamicTree.trees[this.id];r.fireUnSelectAllEvent(e)}}}),dynamicTree.Tree.addMethod("_selectOrEditNode",function(e,t,o,r,i,n){var s,a,d,l=t.isSelected()&&i,c=this.multiSelectEnabled&&t.isSelected()&&o&&!l,h=t.isSelected()&&dynamicTree.treeNodeEdited!==t&&!this.multiSelectEnabled&&!o&&!l,u=null!=dynamicTree.treeNodeEdited&&(f||c),p=this.multiSelectEnabled&&!t.isSelected()&&r&&isNotNullORUndefined(this._lastSelectedNode)&&this._lastSelectedNode.parent===t.parent,m=this.multiSelectEnabled&&t.isSelected()&&r&&isNotNullORUndefined(this._lastSelectedNode)&&this._lastSelectedNode.parent===t.parent,f=!this.multiSelectEnabled&&!t.isSelected()||this.multiSelectEnabled&&!o&&!t.isSelected(),g=!t.isSelected()||f&&this.selectedNodes.length>1;if(r&&this._lastSelectedNode||(this._lastSelectedNode=t),c&&t.deselect(e),f&&this._deselectAllNodes(e),h)return void t.edit(e);if(u&&dynamicTree.treeNodeEdited.doEndEdit(e),p||m){d=t.parent;var v=d.childs.indexOf(this._lastSelectedNode),S=d.childs.indexOf(t);s=Math.min(v,S),a=Math.max(v,S)}if(p)if(s>-1)for(var y=s;a>=y;y++)d.childs[y].select(e);else d.childs[a].select(e);else if(m){for(var y=0;s>y;y++)d.childs[y].deselect(e);for(var y=a+1;y<d.childs.length;y++)d.childs[y].deselect(e)}else g&&t.select(e,t.nofocus,n)}),dynamicTree.Tree.addMethod("_deselectOthers",function(e,t,o,r,i){var n=this.multiSelectEnabled&&this.selectedNodes.length>1&&t.isSelected()&&!(o||r||i);n&&this.selectedNodes.findAll(function(e){return e!=t}.bind(this)).invoke("deselect",e)}),dynamicTree.Tree.addMethod("_selectNextNode",function(e,t){function o(e){return e=e.parent,e?e.nextSibling?e.nextSibling:o(e):null}var r=e.isOpen()&&e.getFirstChild()||e.nextSibling||o(e);r&&e.deselect()&&r.select(t)}),dynamicTree.Tree.addMethod("_selectPreviousNode",function(e,t){function o(e){return!(e.isOpen()&&e.hasChilds())&&e||o(e.getLastChild())}var r=e.prevSibling&&o(e.prevSibling)||e.parent;r&&e.deselect()&&r.select(t)}),dynamicTree.Tree.addMethod("_selectInwards",function(e,t){var o=e.isOpen()&&e.getFirstChild();o?e.deselect()&&o.select(t):e.handleNode(t)}),dynamicTree.Tree.addMethod("_selectOutwards",function(e,t){if(!e.isHiddenRootNode()){var o=e.isOpen()?null:e.parent;o?e.deselect()&&o.select(t):e.handleNode(t)}}),dynamicTree.Tree.addMethod("sortByOrder",function(e,t){var o=e.orderNumber,r=t.orderNumber;return null==o&&null==r?0:null==o?1:null==r?-1:o-r}),dynamicTree.Tree.addMethod("sortByName",function(e,t){var o=e.name.toLowerCase(),r=t.name.toLowerCase();return o>r?1:r>o?-1:0}),dynamicTree.Tree.addVar("TREE_WAIT_TEMPLATE_DOM_ID","list_responsive_collapsible:loading"),dynamicTree.Tree.addMethod("wait",function(){$(this.id).update($(this.TREE_WAIT_TEMPLATE_DOM_ID).cloneNode(!0))}),dynamicTree.Tree.addMethod("stopWaiting",function(){$(this.id).update("")}),dynamicTree.Tree.addMethod("_getTemplateElement",function(e){var t=this.templateDomId,o=$(t).cloneNode(!0);return o.writeAttribute("id",this.getId()),o.templateId=t,o.templateClassName=o.className,cloneCustomAttributes(e,o),o}),define("dynamicTree.tree",["prototype","dragdrop.extra","touchcontroller","utils.common","core.layout"],function(e){return function(){var t;return t||e.dynamicTree}}(this)),dynamicTree.TreeNode=function(e){this.id=dynamicTree.getNextId(),this.treeId=null,this.name=null!=e.name?e.name:this.DEFAULT_NAME,this.param=null!=e.param?e.param:{},this.orderNumber=null!=e.orderNumber?e.orderNumber:null,this.childs=[],this.parent=null,this.Types={
Folder:new dynamicTree.TreeNode.Type(this.FOLDER_TYPE_NAME)},this.isloaded=!1,this.delayedRendering=!0,this.haschilds=!1,this.editable=!1,this.isWaiting=!1,this.hidden=!1,this.isDropTarget=!1,dynamicTree.nodes[this.id]=this},dynamicTree.TreeNode.Type=function(e,t){this.name=e,t&&(this.cssClassName=t.cssClassName,this.templateDomId=t.templateDomId)},dynamicTree.TreeNode.State={OPEN:"open",CLOSED:"closed"},dynamicTree.TreeNode.addVar("FOLDER_TYPE_NAME","com.jaspersoft.jasperserver.api.metadata.common.domain.Folder"),dynamicTree.TreeNode.addVar("DEFAULT_NAME","unset name"),dynamicTree.TreeNode.addVar("NODE_ID_PREFIX","node"),dynamicTree.TreeNode.addVar("SUB_NODE_ID_SUFFIX","sub"),dynamicTree.TreeNode.addVar("HANDLER_ID_PREFIX","handler"),dynamicTree.TreeNode.addVar("NODE_CLASS_NAME","node").addVar("LEAF_CLASS_NAME","leaf").addVar("OPEN_CLASS_NAME","open").addVar("CLOSED_CLASS_NAME","closed").addVar("SELECTED_CLASS_NAME","selected").addVar("LOADING_CLASS_NAME","loading").addVar("ROOTS_CLASS_NAME","roots"),dynamicTree.TreeNode.addVar("nodeHeaderTemplateDomId","list_responsive_collapsible:leaf"),dynamicTree.TreeNode.addVar("nodeFooterTemplateDomId","list_responsive_collapsible"),dynamicTree.TreeNode.addVar("nodeInputTemplateDomId","list_responsive_collapsible:input"),dynamicTree.TreeNode.addVar("isSelectable",!1),dynamicTree.TreeNode.addMethod("getTreeId",function(){return this.treeId||this.parent&&this.parent.getTreeId()}),dynamicTree.TreeNode.addMethod("getState",function(){return dynamicTree.trees[this.getTreeId()].getState(this.id)}),dynamicTree.TreeNode.addMethod("isParent",function(){return this.param.type==this.Types.Folder.name}),dynamicTree.TreeNode.addMethod("addChild",function(e){if(this.isParent()){var t=this.childs[this.childs.length-1];t&&(t.nextSibling=e,e.prevSibling=t),this.childs.push(e),e.parent=this,this.resortChilds(),this.delayedRendering||(e.showNode(),e.render(this._getChildrenElement(),e.nextSibling))}}),dynamicTree.TreeNode.addMethod("removeChild",function(e){for(var t=0;t<this.childs.length;t++)if(this.childs[t]==e){this.childs.splice(t,1);break}if(e.deselect(),!this.delayedRendering){var o=e._getElement();o&&o.remove()}}),dynamicTree.TreeNode.addMethod("resortChilds",function(){var e=this.getTreeId(),t=dynamicTree.trees[e];if(t&&t.sortNodes&&isArray(this.childs)){this.childs.sort(function(e,o){return t.comparer(e,o)});for(var o=this.childs.length;o--;){var r=this.childs[o];r.prevSibling=this.childs[o-1],r.nextSibling=this.childs[o+1]}}}),dynamicTree.TreeNode.addMethod("resetChilds",function(){this.childs=[]}),dynamicTree.TreeNode.addMethod("setHasChilds",function(e){this.haschilds=e}),dynamicTree.TreeNode.addMethod("hasChilds",function(){return this.haschilds?!0:this.getChildCount()>0}),dynamicTree.TreeNode.addMethod("getChildCount",function(){return this.childs.length}),dynamicTree.TreeNode.addMethod("getFirstChild",function(){return this.hasChilds()?this.childs[0]:null}),dynamicTree.TreeNode.addMethod("getLastChild",function(){return this.hasChilds()?this.childs[this.childs.length-1]:null}),dynamicTree.TreeNode.addMethod("_getElement",function(e){return this._element||(this._element=$(this.NODE_ID_PREFIX+this.id)),this._element}),dynamicTree.TreeNode.addMethod("_getTitle",function(){var e=this._getElement().childElements()[0];e.cleanWhitespace();var t=e.childNodes[e.childNodes.length-1];return"#text"!==t.nodeName&&(t=document.createTextNode(""),e.appendChild(t)),t}),dynamicTree.TreeNode.addMethod("_getTitleInputElement",function(){return $(this._getElement().getElementsByTagName("input")[0])}),dynamicTree.TreeNode.addMethod("_getChildrenElement",function(){return this._childrenElement||(this._childrenElement=$(this.NODE_ID_PREFIX+this.id+this.SUB_NODE_ID_SUFFIX)),this._childrenElement}),dynamicTree.TreeNode.addMethod("isOpen",function(){return this.getState()===dynamicTree.TreeNode.State.OPEN}),dynamicTree.TreeNode.addMethod("changeName",function(e){this.name=e,this._getTitle().data=this.name}),dynamicTree.TreeNode.addMethod("getType",function(){for(var e in this.Types)if(this.param.type===this.Types[e].name)return this.Types[e]}),dynamicTree.TreeNode.addMethod("refreshStyle",function(e){if(e=$(e)||this._getElement()){e.templateClassName&&(e.className=e.templateClassName),this.isParent()?(e.addClassName(this.NODE_CLASS_NAME).removeClassName(this.LEAF_CLASS_NAME),this.isWaiting||(this.isOpen()?e.addClassName(this.OPEN_CLASS_NAME).removeClassName(this.CLOSED_CLASS_NAME):e.addClassName(this.CLOSED_CLASS_NAME).removeClassName(this.OPEN_CLASS_NAME))):e.addClassName(this.LEAF_CLASS_NAME).removeClassName(this.NODE_CLASS_NAME),this.isWaiting?e.addClassName(this.LOADING_CLASS_NAME):e.removeClassName(this.LOADING_CLASS_NAME),this.isSelected()?e.addClassName(this.SELECTED_CLASS_NAME):e.removeClassName(this.SELECTED_CLASS_NAME),this.hidden?e.addClassName(layoutModule.HIDDEN_CLASS):e.removeClassName(layoutModule.HIDDEN_CLASS),this.param.cssClass&&e.addClassName(this.param.cssClass);var t=this.getType();t&&t.cssClassName&&e.addClassName(t.cssClassName);var o=e.down();this.isDropTarget&&o&&o.addClassName(layoutModule.DROP_TARGET_CLASS),!this.isDropTarget&&o&&o.removeClassName(layoutModule.DROP_TARGET_CLASS)}}),dynamicTree.TreeNode.addMethod("_createNode",function(){var e=this.id,t=dynamicTree.trees[this.getTreeId()],o=this._getHeaderTemplateElement();o.id=this.NODE_ID_PREFIX+e,o.tabIndex=-1,this.refreshStyle(o),this.treeId=t.id,o.treeNode=this;var r=o.childElements()[0];r.insert(xssUtil.escape(this.name,{softHTMLEscape:!0,whiteList:["a"]})),null!=this.tooltip&&this.tooltip.length>0&&(r.title=this.tooltip),r.childElements().each(function(t,o){0===o&&(t.id=this.HANDLER_ID_PREFIX+e);var r=this.iconTooltip;r&&(t.title=isArray(r)?r[o]:r)}.bind(this)),this._element=o}),dynamicTree.TreeNode.addMethod("_createNodeChildren",function(){var e=this._getFooterTemplateElement();e.id=this.NODE_ID_PREFIX+this.id+this.SUB_NODE_ID_SUFFIX,this._childrenElement=e}),dynamicTree.TreeNode.addMethod("showNode",function(e){var t=dynamicTree.trees[this.getTreeId()];if(this._createNode(),this.isParent()){var o=this.isOpen()||t.showAllNodesOnStartup;if(o){this._createNodeChildren();for(var r=0;r<this.getChildCount();r++)this.childs[r].showNode(this._getChildrenElement());this.delayedRendering=!1,t.fireOpenEvent(this)}}this.render(e)}),dynamicTree.TreeNode.addMethod("render",function(e,t){if(!Object.isUndefined(e)){var o=$(e);o&&(this._getChildrenElement()&&this._getElement().insert(this._getChildrenElement()),t?o.insert(this._getElement(),{before:t._getElement()}):o.insert(this._getElement()))}}),dynamicTree.TreeNode.addMethod("_renderChildren",function(){var e=this._getElement();e&&this._getChildrenElement()&&e.insert(this._getChildrenElement())}),dynamicTree.TreeNode.addMethod("refreshNode",function(){if(this.refreshStyle(),this.isParent()&&this.isOpen()&&this.isloaded){this.delayedRendering?(this._createNodeChildren(),this._renderChildren()):this._getChildrenElement().update("");for(var e=0;e<this.getChildCount();e++)this.childs[e].showNode(this._getChildrenElement());this.delayedRendering=!1}var t=dynamicTree.trees[this.getTreeId()];t.refreshScroll()}),dynamicTree.TreeNode.addMethod("wait",function(){this.isWaiting=!0,this.refreshStyle()}),dynamicTree.TreeNode.addMethod("stopWaiting",function(){this.isWaiting=!1,this.refreshStyle()}),dynamicTree.TreeNode.addMethod("isHiddenRootNode",function(){var e=dynamicTree.trees[this.getTreeId()];return e.rootNode==this&&!e.bShowRoot}),dynamicTree.TreeNode.addMethod("deselect",function(e){var t=dynamicTree.trees[this.getTreeId()];return t&&this.isSelected()?(t.removeNodeFromSelected(this),this.refreshStyle(),e&&t.fireUnSelectEvent(this,e),!0):!1}),dynamicTree.TreeNode.addMethod("select",function(e,t,o){if(o=o||{},!t&&this.focus(),this.isSelected())return!1;var r=dynamicTree.trees[this.getTreeId()];return r.addNodeToSelected(this),this.refreshStyle(),!o.silent&&r.fireSelectEvent(this,e),!0}),dynamicTree.TreeNode.addMethod("focus",function(){var e=this;!isIPad()&&this._getElement()&&setTimeout(function(){e._getElement().focus()},100)}),dynamicTree.TreeNode.addMethod("isSelected",function(){var e=dynamicTree.trees[this.getTreeId()];return e&&e.isNodeSelected(this)}),dynamicTree.TreeNode.addMethod("_removeTitle",function(){var e=this._getTitle();e.data="",$(e.parentNode).cleanWhitespace()}),dynamicTree.TreeNode.addMethod("edit",function(e){if(this.editable){if(dynamicTree.treeNodeEdited==this)return;dynamicTree.treeNodeEdited=this;var t=this.name,o=$(this._getTitle().parentNode),r=this._getInputTemplateElement();this._getTitle().data="",o.cleanWhitespace(),o.insert(r),r.value=xssUtil.unescape(this.name),r.focus(),r.select(e),r.onclick=function(e){cancelEventBubbling(e)},r.ondblclick=function(e){cancelEventBubbling(e)},r.onmousedown=function(e){cancelEventBubbling(e)},r.onmouseup=function(e){cancelEventBubbling(e)},r.onkeydown=function(e){var o=window.event?window.event:e;13==o.keyCode?(r.onblur=null,this.doEndEdit(o)):27==o.keyCode&&(r.onblur=null,r.value=t,this.doEndEdit(o))}.bindAsEventListener(this),r.onblur=function(e){this.doEndEdit(e)}.bindAsEventListener(this),dynamicTree.trees[this.getTreeId()].fireStartEditEvent(this,r)}}),dynamicTree.TreeNode.addMethod("doEndEdit",function(e){this.editEnded(),dynamicTree.trees[this.getTreeId()].fireEndEditEvent(this)}),dynamicTree.TreeNode.addMethod("editEnded",function(){var e=dynamicTree.trees[this.getTreeId()];if(null!=dynamicTree.treeNodeEdited){var t=this._getTitleInputElement(),o=($(t.parentNode),t.value);if(o==dynamicTree.treeNodeEdited.name)return t.remove(),this._getTitle().data=dynamicTree.treeNodeEdited.name,void(dynamicTree.treeNodeEdited=null);e.fireEditEvent(dynamicTree.treeNodeEdited,o),dynamicTree.editaborted||(dynamicTree.treeNodeEdited.name=o,t.remove(),this._getTitle().data=o),dynamicTree.treeNodeEdited=null}}),dynamicTree.TreeNode.addMethod("scroll",function(e){var t=dynamicTree.trees[this.getTreeId()].rootNode._getElement(),o=e?$(e):$(t.parentNode),r=this._getElement();if(o){var i=o.clientHeight,n=o.clientWidth,s=o.scrollTop,a=o.scrollLeft,d=r.cumulativeOffset().top-o.cumulativeOffset().top,l=r.offsetLeft,c=r.clientHeight,h=r.clientWidth;d>s+i?o.scrollTop=d-(i/2-c/2):s>d+c&&(o.scrollTop=d-(i/2-c/2)),l>a+n?o.scrollLeft=l-(n/2-h/2):a>l+h&&(o.scrollTop=l-(n/2-h/2))}}),dynamicTree.TreeNode.addMethod("handleNode",function(e){if(this.isParent()){var t=dynamicTree.trees[this.getTreeId()];this.isOpen()?t.writeStates(this.id,dynamicTree.TreeNode.State.CLOSED):(t.writeStates(this.id,dynamicTree.TreeNode.State.OPEN),t.fireOpenEvent(this,e)),this.refreshNode()}}),dynamicTree.TreeNode.addMethod("openNode",function(e){if(this.isParent()){var t=dynamicTree.trees[this.getTreeId()];this.isOpen()||(t.writeStates(this.id,dynamicTree.TreeNode.State.OPEN),t.fireOpenEvent(this,e)),this.refreshNode()}}),dynamicTree.TreeNode.addMethod("_getHeaderTemplateElement",function(){var e=this.getType(),t=e&&e.templateDomId?e.templateDomId:this.nodeHeaderTemplateDomId,o=$(t).cloneNode(!0);return o.templateId=t,o.templateClassName=o.className,o}),dynamicTree.TreeNode.addMethod("_getFooterTemplateElement",function(){var e=this.nodeFooterTemplateDomId,t=$(e).cloneNode(!0);return t.templateId=e,t.update(""),t}),dynamicTree.TreeNode.addMethod("_getInputTemplateElement",function(){var e=this.nodeInputTemplateDomId,t=$(e).cloneNode(!0);return t.templateId=e,t}),define("dynamicTree.treenode",["prototype","underscore","dynamicTree.tree"],function(e){return function(){var t;return t||e.dynamicTree}}(this)),dynamicTree.Tree.addVar("NODE_PATTERN",".node").addVar("NODE_WRAPPER_PATTERN",".node > .wrap").addVar("NODE_ICON_PATTERN",".node > .wrap .icon").addVar("NODE_CUSTOM_PATTERNS",[]),dynamicTree.Tree.addVar("LEAF_PATTERN",".leaf").addVar("LEAF_WRAPPER_PATTERN",".leaf > .wrap").addVar("LEAF_ICON_PATTERN",".leaf > .wrap .icon").addVar("LEAF_CUSTOM_PATTERNS",[]),dynamicTree.Tree.addVar("EXPANDING_TIME",1e3),dynamicTree.Tree.addVar("draggables",[]),dynamicTree.Tree.addMethod("getTreeNodeByEvent",function(e){var t=Event.element(e);return this.getTreeNodeByElement(t)}),dynamicTree.Tree.addMethod("getTreeNodeByElement",function(e){for(;e&&e.readAttribute&&e.readAttribute("id")!==this.id;){var t=e.treeNode;if(t&&t.getTreeId()===this.getId())return t;e=$(e.parentNode)}return null}),dynamicTree.Tree.addMethod("isNodeEvent",function(e){var t=matchMeOrUp(e.element().parentNode,"LI");return t&&t.hasClassName(layoutModule.NODE_CLASS)}),dynamicTree.Tree.addMethod("isLeafEvent",function(e){var t=matchMeOrUp(e.element().parentNode,"LI");return t&&t.hasClassName(layoutModule.LEAF_CLASS)}),dynamicTree.Tree.addMethod("isIconEvent",function(e){return e.element().hasClassName(layoutModule.ICON_CLASS)}),dynamicTree.Tree.addMethod("_registerEvents",function(){this._cleanUpListeners(),this._registerClickEvents(),this._registerCustomEvents(),this._registerKeyEvents(),this._registerMouseEvents()}),dynamicTree.Tree.addMethod("_cleanUpListeners",function(){var e=this._getElement();e.stopObserving("click"),e.stopObserving("dblclick"),isSupportsTouch()?(e.stopObserving("touchstart"),e.stopObserving("drag:touchstart"),e.stopObserving("touchend")):(e.stopObserving("mousedown"),e.stopObserving("drag:mousedown"),e.stopObserving("mouseup")),e.stopObserving("mouseover"),e.stopObserving("mouseout")}),dynamicTree.Tree.addMethod("_registerClickEvents",function(){var e=this._getElement();e.observe("click",function(t){var o=matchMeOrUp(t.element(),layoutModule.BUTTON_PATTERN)&&this.getTreeNodeByEvent(t);if(o){var r=this.isIconEvent(t),i=this.isNodeEvent(t),n=this.isLeafEvent(t);i?(r&&e.fire("nodeIcon:click",{targetEvent:t,node:o}),e.fire("node:click",{targetEvent:t,node:o})):n&&(r&&e.fire("nodeIcon:click",{targetEvent:t,node:o}),e.fire("leaf:click",{targetEvent:t,node:o})),!isIPad()&&i&&r&&o.handleNode(t)}}.bindAsEventListener(this)),e.observe("dblclick",function(t){var o=matchMeOrUp(t.element(),layoutModule.BUTTON_PATTERN)&&this.getTreeNodeByEvent(t);if(o){var r=this.isIconEvent(t),i=this.isNodeEvent(t),n=this.isLeafEvent(t);i?(r&&e.fire("nodeIcon:dblclick",{targetEvent:t,node:o}),e.fire("node:dblclick",{targetEvent:t,node:o})):n&&(r&&e.fire("leafIcon:dblclick",{targetEvent:t,node:o}),e.fire("leaf:dblclick",{targetEvent:t,node:o})),this.handleNodeOnDblclick&&(i||n)&&!r&&o.handleNode(t)}}.bindAsEventListener(this))}),dynamicTree.Tree.addMethod("_registerMouseEvents",function(){var e=this._getElement();e.observe(isSupportsTouch()?"touchstart":"mousedown",function(t){var o=t.element(),r=matchMeOrUp(o,layoutModule.BUTTON_PATTERN)&&this.getTreeNodeByEvent(t);if(r){t.treeEvent=!0;var i=this.isIconEvent(t),n=this.isNodeEvent(t),s=this.isLeafEvent(t);if(isSupportsTouch())if(JRS.vars.ajax_in_progress)alert("please wait");else if(this.twofingers=!1,2==t.touches.length&&(this.twofingers=!0,this._selectOrEditNode(t,r,isMetaHeld(t),isShiftHeld(t),isRightClick(t)),r.isSelected()||designerBase&&designerBase.isInSelection(r))){var a=jQuery(o).parents("li:first");return void(a.hasClass("selected")&&document.fire(layoutModule.ELEMENT_CONTEXTMENU,{targetEvent:t,node:o}))}isSupportsTouch()&&JRS.vars.ajax_in_progress||(!this.selectOnMousedown||isSupportsTouch()&&1!=t.touches.length||this._selectOrEditNode(t,r,isMetaHeld(t),isShiftHeld(t),isRightClick(t)),n?(i&&e.fire("nodeIcon:mousedown",{targetEvent:t,node:r}),e.fire("node:mousedown",{targetEvent:t,node:r})):s&&(i&&e.fire("leafIcon:mousedown",{targetEvent:t,node:r}),e.fire("leaf:mousedown",{targetEvent:t,node:r})))}}.bindAsEventListener(this)),e.observe(isSupportsTouch()?"drag:touchstart":"drag:mousedown",function(t){var o=t.memo.targetEvent,r=matchMeOrUp(o.element(),layoutModule.BUTTON_PATTERN)&&this.getTreeNodeByEvent(o);if(r){o.treeEvent=!0;var i=this.isIconEvent(o),n=this.isNodeEvent(o),s=this.isLeafEvent(o);this.selectOnMousedown&&!isRightClick(o)&&this._selectOrEditNode(o,r,isMetaHeld(o),isShiftHeld(o),isRightClick(o)),n?(i&&e.fire("nodeIcon.drag:mousedown",{targetEvent:o,node:r}),e.fire("node.drag:mousedown",{targetEvent:o,node:r})):s&&(i&&e.fire("leafIcon.drag:mousedown",{targetEvent:o,node:r}),e.fire("leaf.drag:mousedown",{targetEvent:o,node:r}))}}.bindAsEventListener(this)),e.observe(isSupportsTouch()?"touchend":"mouseup",function(t){var o=matchMeOrUp(t.element(),layoutModule.BUTTON_PATTERN)&&this.getTreeNodeByEvent(t);if(o){t.treeEvent=!0;var r=this.isIconEvent(t),i=this.isNodeEvent(t),n=this.isLeafEvent(t);if(this.twofingers&&(t.isEmulatedRightClick=!0),isSupportsTouch()&&!this.twofingers&&(this.clickid==o.id&&!JRS.vars.ajax_in_progress&&t.timeStamp-this.clicktime<700&&(i?(r&&e.fire("nodeIcon:dblclick",{targetEvent:t,node:o}),e.fire("node:dblclick",{targetEvent:t,node:o})):n&&(r&&e.fire("leafIcon:dblclick",{targetEvent:t,node:o}),e.fire("leaf:dblclick",{targetEvent:t,node:o})),this.handleNodeOnDblclick&&(i||n)&&!r&&o.handleNode(t)),this.clicktime=t.timeStamp,this.clickid=o.id),!isSupportsTouch()||!JRS.vars.ajax_in_progress){this.selectOnMousedown||TouchController.element_scrolled||isSupportsTouch()&&1!=t.changedTouches.length||this._selectOrEditNode(t,o,isMetaHeld(t),isShiftHeld(t),isRightClick(t)),this._deselectOthers(t,o,isMetaHeld(t),isShiftHeld(t),isRightClick(t));i?(r&&e.fire("nodeIcon:mouseup",{targetEvent:t,node:o}),e.fire("node:mouseup",{targetEvent:t,node:o})):n&&(r&&e.fire("leafIcon:mouseup",{targetEvent:t,node:o}),e.fire("leaf:mouseup",{targetEvent:t,node:o})),isSupportsTouch()&&i&&r&&!TouchController.element_scrolled&&o.handleNode(t)}}}.bindAsEventListener(this)),"createTouch"in document||(e.observe("mouseover",function(t){var o=t.element(),r=matchMeOrUp(o,layoutModule.BUTTON_PATTERN)&&this.getTreeNodeByEvent(t);r&&(Draggables.dragging&&(clearTimeout(this.timeout_id),this.timeout_id=setTimeout(function(e){r.openNode(e)},this.EXPANDING_TIME)),this.createDraggableIfNeeded(t,r),!isIE7()&&e.fire("tree:mouseover",{targetEvent:t,node:r}))}.bindAsEventListener(this)),isIE7()||e.observe("mouseout",function(t){var o=matchMeOrUp(t.element(),layoutModule.BUTTON_PATTERN)&&this.getTreeNodeByEvent(t);o&&e.fire("tree:mouseout",{targetEvent:t,node:o})}.bindAsEventListener(this))),Droppables.add(e,{accept:this.dropClasses,onDrop:function(e){this.elementDropped=e}.bind(this)})}),dynamicTree.Tree.addMethod("_registerKeyEvents",function(){var e=this._getElement();e.observe("key:down",function(e){var t=this.getTreeNodeByEvent(e);dynamicTree.treeNodeEdited!==t&&t&&this._selectNextNode(t,e.memo.targetEvent)}.bindAsEventListener(this)),e.observe("key:up",function(e){var t=this.getTreeNodeByEvent(e);dynamicTree.treeNodeEdited!==t&&t&&this._selectPreviousNode(t,e.memo.targetEvent)}.bindAsEventListener(this)),e.observe("key:right",function(e){var t=this.getTreeNodeByEvent(e);dynamicTree.treeNodeEdited!==t&&t&&this._selectInwards(t,e.memo.targetEvent)}.bindAsEventListener(this)),e.observe("key:left",function(e){var t=this.getTreeNodeByEvent(e);dynamicTree.treeNodeEdited!==t&&t&&this._selectOutwards(t,e.memo.targetEvent)}.bindAsEventListener(this))}),dynamicTree.Tree.addMethod("_registerCustomEvents",function(){var e=this._getElement();e.observe("mousedown",function(t){dynamicTree.activeTreeId&&dynamicTree.activeTreeId===this.getId()||(e.fire("tree:blur",{targetEvent:t,tree:dynamicTree.getActiveTree()}),dynamicTree.activeTreeId=this.getId(),e.fire("tree:focus",{targetEvent:t,tree:dynamicTree.getActiveTree()}))}.bindAsEventListener(this)),e.observe("mouseover",function(t){var o=this.getTreeNodeByEvent(t);o||e.fire("tree:mouseover",{targetEvent:t,tree:this})}.bindAsEventListener(this)),e.observe("mouseout",function(t){var o=this.getTreeNodeByEvent(t);o||e.fire("tree:mouseout",{targetEvent:t,tree:this})}.bindAsEventListener(this))}),dynamicTree.Tree.addMethod("fireOpenEvent",function(e,t){var o=this._getElement();o.fire("node:open",{node:e,targetEvent:t})}),dynamicTree.Tree.addMethod("fireSelectEvent",function(e,t){var o=this._getElement();o.fire(e.isParent()?"node:selected":"leaf:selected",{node:e,targetEvent:t})}),dynamicTree.Tree.addMethod("fireUnSelectEvent",function(e,t){var o=this._getElement();o.fire(e.isParent()?"node:unselected":"leaf:unselected",{node:e,targetEvent:t})}),dynamicTree.Tree.addMethod("fireUnSelectAllEvent",function(e){var t=this._getElement();t.fire("items:unselected",{targetEvent:e})}),dynamicTree.Tree.addMethod("fireEditEvent",function(e,t){var o=this._getElement();o.fire(e.isParent()?"node:edit":"leaf:edit",{node:e,newValue:t})}),dynamicTree.Tree.addMethod("fireStartEditEvent",function(e,t){var o=this._getElement();o.fire(e.isParent()?"node:startEdit":"leaf:startEdit",{node:e,input:t})}),dynamicTree.Tree.addMethod("fireEndEditEvent",function(e){var t=this._getElement();t.fire(e.isParent()?"node:endEdit":"leaf:endEdit",{node:e})}),dynamicTree.Tree.addMethod("observe",function(e,t){this._getElement().observe(e,t)}),dynamicTree.Tree.addMethod("stopObserving",function(e,t){this._getElement().stopObserving(e,t)}),dynamicTree.Tree.addMethod("createDraggableIfNeeded",function(e,t){var o=e?e.element():t._getElement().down(this.dragPattern),r=this.draggables[o.identify()];if(this.dragPattern&&!r){var i=matchAny(o,[this.dragPattern],!0);if(i&&o.className.toLowerCase().indexOf("icon")<0&&!this.draggables[i.identify()])return this.draggables[i.identify()]=new Draggable(o,{superghosting:!0,mouseOffset:!0,delay:isIE()||isSupportsTouch()?200:0,onStart:this.setDragStartState.bind(this,t),onEnd:this.setDragEndState.bind(this,t)}),this.draggables[i.identify()]}return null}),dynamicTree.Tree.addMethod("setDragStartState",function(e,t,o){var r=e._getElement().templateClassName;r&&t.element.addClassName(r),t.element.setStyle({width:null,height:null}),t.element.addClassName(layoutModule.DRAGGING_CLASS).addClassName(this.getId()),this.dragClasses&&t.element.addClassName(this.dragClasses),this.selectedNodes.length>1&&t.element.update(new Template(this.TREE_NN_ITEMS_SELECTED).evaluate({count:this.selectedNodes.length})),t.element.node=e,t.element.nodes=this.selectedNodes,t.options.scroll=this._getElement(),t.options.scrollSensitivity=layoutModule.SCROLL_SENSITIVITY,Draggables.dragging=this.regionID||!0}),dynamicTree.Tree.addMethod("setDragEndState",function(e,t,o){delete Draggables.dragging}),define("dynamicTree.events",["prototype","dynamicTree.tree"],function(e){return function(){var t;return t||e.dynamicTree}}(this)),dynamicTree.TreeSupport=function(e,t){if(dynamicTree.Tree.call(this,e,t),this.providerId=t.providerId,this.hideLoader=t.hideLoader,this.rootUri=Object.isUndefined(t.rootUri)?"/":t.rootUri,this.nodeClass=t.nodeClass&&Object.isFunction(t.nodeClass)?t.nodeClass:dynamicTree.TreeNode,t.rootObjectModifier&&(this.modifyRootObject=t.rootObjectModifier),this.resetStatesOnShow=Object.isUndefined(t.resetStatesOnShow)||t.resetStatesOnShow,this.inInit=!0,this.ajaxBufferId="ajaxbuffer",this.nodeTextId="treeNodeText",this.urlGetNode=t.urlGetNode?t.urlGetNode:this._getFlowUrl("getNode"),this.urlGetChildren=t.urlGetChildren?t.urlGetChildren:this._getFlowUrl("getChildren"),this.urlGetMultipleChildren=t.urlGetMultipleChildren?t.urlGetMultipleChildren:this._getFlowUrl("getMultipleChildren"),this.urlGetMessage=t.urlGetMessage?t.urlGetMessage:this._getFlowUrl("getMessage"),this.additionalParams=t.additionalParams?t.additionalParams:{},null==this.TREE_NN_ITEMS_SELECTED){var o=function(e){this.TREE_NN_ITEMS_SELECTED=e}.bind(this);this.getMessage("TREE_NN_ITEMS_SELECTED",o,null)}this._initOpenListener()},dynamicTree.TreeSupport.prototype=deepClone(dynamicTree.Tree.prototype),dynamicTree.TreeSupport.addMethod("_initOpenListener",function(){this.observe("node:open",function(e){var t=e.memo.node;t&&!t.isloaded&&this.getTreeNodeChildren(t)}.bindAsEventListener(this))}),dynamicTree.TreeSupport.addMethod("stopObserving",function(e,t){this._getElement().stopObserving(e,t),"node:open"!==e||t||this._initOpenListener()}),dynamicTree.TreeSupport.addMethod("_getFlowUrl",function(e){return __jrsConfigs__.contextPath+"/flow.html?_flowId=treeFlow&method="+e}),dynamicTree.TreeSupport.addMethod("showTree",function(e,t,o,r){var i=this.urlGetNode+"&provider="+this.providerId+"&uri="+this.rootUri+"&depth="+e;r&&(i+="&forceHtmlEscape=true"),i+="&"+this._evaluateAdditionalParams(),this._showTree(i,t,o)}),dynamicTree.TreeSupport.addMethod("_evaluateAdditionalParams",function(){var e=this.additionalParams;return _.isFunction(e)&&(e=e.call(null)),_.isObject(e)?Object.toQueryString(e):null}),dynamicTree.TreeSupport.addMethod("showTreePrefetchNodes",function(e,t,o){var r=this.urlGetNode+"&provider="+this.providerId+"&uri="+this.rootUri;e&&(r+="&prefetch="+encodeURIComponent(e)),r+="&"+this._evaluateAdditionalParams(),this._showTree(r,t,o)}),dynamicTree.TreeSupport.addMethod("_showTree",function(e,t,o){var r=this;this.inInit=!0,this.wait();var i=function(e,t,o){return function(){return e.showTreeCallback(t,o)}}(this,t,o),n=function(){var e=!1;return r.httpErrorHandler&&(e=r.httpErrorHandler.apply(window,arguments)),e===!1&&(e=baseErrorHandler.apply(window,arguments)),e};ajaxTargettedUpdate(e,{fillLocation:this.ajaxBufferId,callback:i,errorHandler:n,hideLoader:this.hideLoader})}),dynamicTree.TreeSupport.addMethod("showTreeCallback",function(e,t){var o=document.getElementById(this.nodeTextId);if(null==o)return void(t?t():this.fireServerErrorEvent());var r=xssUtil.unescape(jQuery(o).text()),i=r.evalJSON();this.modifyRootObject&&(i=this.modifyRootObject(i,!1)),o=document.getElementById(this.ajaxBufferId),o.innerHTML="",this.setRootNode(this.processNode(i)),this.resortTree(),this.resetStatesOnShow&&this.resetStates(),this.renderTree(),this.inInit=!1,e?e():this.fireTreeLoadedEvent({tree:this})}),dynamicTree.TreeSupport.addMethod("processNode",function(e){var t={};t.id=e.id,t.type=e.type,t.uri=e.uri,t.extra=deepClone(e.extra),e.cssClass&&(t.cssClass=e.cssClass);var o=this.nodeClass,r=new o({name:unescapeBackslash(e.label),param:t,orderNumber:e.order});e.tooltip&&(r.tooltip=e.tooltip);var i=e.children;if(null!=i){var n=i.length;if(0===n)r.setHasChilds(!1);else for(var s=0;n>s;s++){var a=i[s];if(a){var d=this.processNode(a);r.addChild(d)}}r.isloaded=!0}return r}),dynamicTree.TreeSupport.addMethod("getTreeNodeChildren",function(e,t,o){var r=e.param.uri,i=function(e,t,o,r){return function(){return e.getTreeNodeChildrenCallback(t,o,r)}}(this,e.id,t,o),n=function(t){(500==t.status||t.getResponseHeader("JasperServerError"))&&e.stopWaiting(),baseErrorHandler(t)};ajaxTargettedUpdate(this.urlGetChildren+"&provider="+this.providerId+"&uri="+encodeURIComponent(encodeURIComponent(r))+"&"+this._evaluateAdditionalParams(),{fillLocation:this.ajaxBufferId,callback:i,errorHandler:n,hideLoader:this.hideLoader}),this.inInit||e.wait()}),dynamicTree.TreeSupport.addMethod("getTreeNodeChildrenCallback",function(e,t,o){var r=document.getElementById(this.nodeTextId);if(null==r)return void(o?o():this.fireServerErrorEvent());var i=xssUtil.unescape(jQuery(r).text()).evalJSON(),n=dynamicTree.nodes[e];this.modifyRootObject&&(i=this.modifyRootObject(i,!0,n)),r=document.getElementById(this.ajaxBufferId),r.innerHTML="",n.resetChilds(),n.stopWaiting();var s=i.length;if(0===s)n.setHasChilds(!1);else{var a=n.getTreeId(),d=a?dynamicTree.trees[a]:null,l=d?d.sortNodes:null;d&&(d.sortNodes=!1);for(var c=0;s>c;c++){var h=this.processNode(i[c]);n.addChild(h)}d&&(d.sortNodes=l,n.resortChilds())}n.isloaded=!0,n.refreshNode(),t?t(n.childs):this.fireChildrenLoadedEvent(n.childs)}),dynamicTree.TreeSupport.addMethod("getTreeMultipleNodesChildren",function(e,t,o){var r,i="",n=[];if(e&&e.length)for(r=0;r<e.length;r++)r>0&&(i+=","),i+=encodeURIComponent(encodeURIComponent(e[r].param.uri)),n[r]=e[r].id;if(i.length){var s=function(e,t,o,r){return function(){return e.getTreeMultipleNodesChildrenCallback(t,o,r)}}(this,n,t,o);if(ajaxTargettedUpdate(this.urlGetMultipleChildren+"&provider="+this.providerId,{fillLocation:this.ajaxBufferId,callback:s,postData:"uris="+i,errorHandler:baseErrorHandler,hideLoader:this.hideLoader}),!this.inInit)for(r=0;r<e.length;r++)e[r].wait()}}),dynamicTree.TreeSupport.addMethod("getTreeMultipleNodesChildrenCallback",function(e,t,o){var r=document.getElementById(this.nodeTextId);if(null==r)return void(o?o():this.fireServerErrorEvent());var i=xssUtil.unescape(jQuery(r).text()).evalJSON();r=document.getElementById(this.ajaxBufferId),r.innerHTML="",t?t(e,i):(this.setMultipleNodesChilden(e,i),this.fireMultipleChildrenLoadedEvent(e,i))}),dynamicTree.TreeSupport.addMethod("setMultipleNodesChilden",function(e,t,o){if(e&&t)for(var r=0;r<t.length;r++){for(var i=t[r],n=i.children,s=null,a=0;a<e.length;a++){var d=dynamicTree.nodes[e[a]];if(d.param.uri==i.parentUri){s=d;break}}if(s){s.resetChilds(),s.stopWaiting();var l=n.length;if(0===l)s.setHasChilds(!1);else{var c=s.getTreeId(),h=c?dynamicTree.trees[c]:null,u=h?h.sortNodes:null;h&&(h.sortNodes=!1);for(var p=0;l>p;p++){var m=this.processNode(n[p]);s.addChild(m)}h&&(h.sortNodes=u,s.resortChilds())}s.isloaded=!0,o||s.refreshNode()}}}),dynamicTree.TreeSupport.addMethod("getTreeNodeChildrenPrefetched",function(e,t,o,r,i,n,s){var a=e.param.uri,d=this.urlGetNode+"&provider="+this.providerId+"&uri="+a,l="";t&&(l="&prefetch="+t),i&&(d+="&depth="+i);var c=function(e,t,o,r,i,n){return function(){return e.getTreeNodeChildrenPrefetchedCallback(t,o,r,i,n)}}(this,e.id,o,r,n,s);ajaxTargettedUpdate(d,{fillLocation:this.ajaxBufferId,callback:c,postData:l,errorHandler:baseErrorHandler,hideLoader:this.hideLoader}),this.inInit||e.wait()}),dynamicTree.TreeSupport.addMethod("getTreeNodeChildrenPrefetchedCallback",function(e,t,o,r,i){var n=document.getElementById(this.nodeTextId);if(null==n)return void(o?o():this.fireServerErrorEvent());var s=xssUtil.unescape(jQuery(n).text()).evalJSON();n=document.getElementById(this.ajaxBufferId),n.innerHTML="";var a=dynamicTree.nodes[e];if(a.resetChilds(),a.stopWaiting(),s.children){var d=a.getTreeId(),l=d?dynamicTree.trees[d]:null,c=l?l.sortNodes:null;l&&(l.sortNodes=!1);for(var h=0;h<s.children.length;h++){var u=this.processNode(s.children[h]);a.addChild(u)}l&&(l.sortNodes=c,r||a.resortChilds())}a.isloaded=!0,i||a.refreshNode(),t?t():this.fireChildredPrefetchedLoadedEvent(a.childs)}),dynamicTree.TreeSupport.addMethod("openAndSelectNode",function(e,t,o,r){var i=function(e){var t=dynamicTree.trees[e.getTreeId()];e.parent&&t&&t.rootNode!=e.parent&&t.getState(e.parent.id)==dynamicTree.TreeNode.State.CLOSED&&e.parent.handleNode(),e&&jQuery("#dataChooserSource").length&&(e.nofocus=!0),t._selectOrEditNode(void 0,e,!1,!1,!1,r)};this.processNodePath(e,i,o);var n=this.getSelectedNode();n&&n.scroll(),t&&t()}),dynamicTree.TreeSupport.addMethod("processNodePath",function(e,t,o){var r=this.getRootNode();if("/"===e)t(r);else{var i,n=e.split("/");for(i=0;i<n.length;i++)if(n[i]){var s=r;if(r=this.findNodeChildByMetaName(r,n[i]),!r){if(!o)return;if(r=this.findNodeFirstNodeChildByAlphabeticalOrder(s),!r)return}t(r)}}}),dynamicTree.TreeSupport.addMethod("findLastLoadedNode",function(e){var t={node:null},o=function(e){return function(t){e.node=t}}(t);return this.processNodePath(e,o),t.node}),dynamicTree.TreeSupport.addMethod("findNodeChildByMetaName",function(e,t){if(e.hasChilds())for(var o=0;o<e.childs.length;o++)if(e.childs[o].param.id==t)return e.childs[o];return null}),dynamicTree.TreeSupport.addMethod("findNodeFirstNodeChildByAlphabeticalOrder",function(e){var t=null,o=null;if(e.childs.length>0){t=e.childs[0].param.id,o=0;for(var r=null,i=null,n=1;n<e.childs.length;n++){r=e.childs[n].param.id,i=n;for(var s=r.length<t.length?r.length:t.length,a=0;s>a;a++){if(r.charCodeAt(a)<t.charCodeAt(a)){t=r,o=i;break}if(r.charCodeAt(a)>t.charCodeAt(a))break}}return e.childs[o]}return null}),dynamicTree.TreeSupport.addMethod("findNodeById",function(e,t){return function o(e,t){if(!t||!e)return null;if(t.param.id===e)return t;if(t.hasChilds())for(var r=0;r<t.childs.length;++r){var i=o(e,t.childs[r]);if(i)return i}return null}(e,t?t:this.getRootNode())}),dynamicTree.TreeSupport.addMethod("hasVisibleFolders",function(e){
if(this.bShowRoot)return!0;var t=e.children;if(t)for(var o=0;o<t.length;o++){var r=e.children[o].children;if(r&&r.length>0)return!0}return!1}),dynamicTree.TreeSupport.addMethod("getMessage",function(e,t,o){var r=this.urlGetMessage+"&messageId="+e,i=function(e,t,o){return function(){return e.getMessageCallback(t,o)}}(this,t,o);ajaxTargettedUpdate(r,{fillLocation:this.ajaxBufferId,callback:i,errorHandler:baseErrorHandler,hideLoader:this.hideLoader})}),dynamicTree.TreeSupport.addMethod("getMessageCallback",function(e,t){var o=document.getElementById(this.ajaxBufferId);if(null==o)return void(t&&t());var r=trim(o.innerHTML);o.innerHTML="",e&&e(r)}),dynamicTree.TreeSupport.addMethod("fireServerErrorEvent",function(){this._getElement().fire("server:error",{})}),dynamicTree.TreeSupport.addMethod("fireTreeLoadedEvent",function(e){this._getElement().fire("tree:loaded",{tree:e})}),dynamicTree.TreeSupport.addMethod("fireChildrenLoadedEvent",function(e){this._getElement().fire("children:loaded",{nodes:e})}),dynamicTree.TreeSupport.addMethod("fireMultipleChildrenLoadedEvent",function(e,t){this._getElement().fire("multipleChildren:loaded",{parentNodeIds:e,metaNodes:t})}),dynamicTree.TreeSupport.addMethod("fireChildredPrefetchedLoadedEvent",function(e){this._getElement().fire("childredPrefetched:loaded",{nodes:e})}),define("components.dynamicTree",["prototype","dynamicTree.tree","dynamicTree.treenode","dynamicTree.events","core.ajax"],function(e){return function(){var t;return t||e.dynamicTree}}(this)),dynamicTree.RepositoryFolder=function(e){dynamicTree.TreeNode.call(this,e),this.Types={Folder:new dynamicTree.TreeNode.Type("com.jaspersoft.jasperserver.api.metadata.common.domain.Folder"),SuperRoot:new dynamicTree.TreeNode.Type("superroot"),Root:new dynamicTree.TreeNode.Type("root")},this.nodeHeaderTemplateDomId="list_responsive_collapsible_folders:folders",this.param.extra&&this.param.extra.isActiveThemeFolder&&(this.param.cssClass=this.ACTIVE_THEME_CLASS)},dynamicTree.TreeNode&&(dynamicTree.RepositoryFolder.prototype=deepClone(dynamicTree.TreeNode.prototype)),dynamicTree.RepositoryFolder.addVar("ACTIVE_THEME_CLASS","activeTheme"),dynamicTree.RepositoryFolder.addMethod("isParent",function(){return this.param.type==this.Types.Folder.name||this.param.type==this.Types.SuperRoot.name||this.param.type==this.Types.Root.name}),dynamicTree.RepositoryFolder.addMethod("isSuperRoot",function(){return this.param.type==this.Types.SuperRoot.name}),dynamicTree.RepositoryFolder.addMethod("isPublic",function(){return"public"===this.param.id}),dynamicTree.createRepositoryTree=function(e,t){var o=null!=t.organizationId&&""!==t.organizationId;null==t.bShowRoot&&(t.bShowRoot=!o),t.nodeClass||(t.nodeClass=dynamicTree.RepositoryFolder),t.templateDomId="list_responsive_collapsible_folders";var r=new dynamicTree.TreeSupport(e,t);if(r.organizationId=t.organizationId,r.publicFolderUri=t.publicFolderUri,r.orgMode=o,r.modifyRootObject=function(e,t,o){var r;if(t){r=[];for(var i=0;i<e.length;i++)e[i].uri==this.publicFolderUri&&o&&"/"!=o.param.uri||r.push(e[i])}else if(this.orgMode&&null!=e.children){for(var n,s=e.children,a=[],i=0;i<s.length;i++)s[i].uri==this.publicFolderUri?n=s[i]:a.push(s[i]);e.children=a,r={type:"superroot",label:"",extra:{}},r.children=[e,n]}else r=e;return r},r.getRootNode=function(){var e=this.rootNode;return e.isSuperRoot()?e.childs[0].isPublic()?e.childs[1]:e.childs[0]:e},r.findNodeChildByMetaName=function(e,t){if(e.isSuperRoot()){var o,i;if(e.childs[0].isPublic()?(o=e.childs[0],i=e.childs[1]):(o=e.childs[1],i=e.childs[0]),"public"===t)return o;e=i}if(e.hasChilds())for(var n=0;n<e.childs.length;n++)if(e.childs[n].param.id==t)return e.childs[n];return"public"==t&&e.parent&&e.parent.isSuperRoot()?r.findNodeChildByMetaName(e.parent,t):null},isIPad()){var i=$(e);r.touchController=new TouchController(i,i.up(1),{absolute:!0})}return r},define("dynamicTree.utils",["components.dynamicTree","touchcontroller","dynamicTree.treenode"],function(e){return function(){var t;return t||e.dynamicTree}}(this)),define("tools.infiniteScroll",["require","prototype","utils.common"],function(e){"use strict";e("prototype"),e("utils.common");var t=function(e){this._id=e.id,this._contentId=e.contentId?e.contentId:void 0,this._scroll=e.scroll,this._loadFactor=e.loadFactor?e.loadFactor:.95,this._lastContentHeight=0,this._loading=!1,e.control?void 0!==e.control.length&&e.control.length>1?this._control=$(e.control[0]):this._control=$(e.control):this._control=this._scroll?this._scroll.parent:$(this._id),this._scroll?this._content=this._scroll.element:e.content?void 0!==e.content.length&&e.content.length>1?this._content=$(e.content[0]):this._content=$(e.content):this._content=this._contentId?$(this._contentId):this._control.childElements()[0],this._eventType=isSupportsTouch()?"touchmove":"scroll",this._control.observe(this._eventType,this._onScrollHandler.bind(this))};return t.addMethod("destroy",function(){this._control&&this._control.stopObserving(this._eventType,this._handler)}),t.addMethod("_onScrollHandler",function(e){var t=this._scroll?-1*this._scroll.y:this._control.scrollTop,o=this._content.getHeight(),r=this._control.getHeight();o!=this._lastContentHeight&&(this._loading=!1);var i=!this._loading&&0!=o;i=this._scroll?i&&this._scroll.isBottom():i&&(r+t)/o>this._loadFactor,i&&(this._loading=!0,this._lastContentHeight=o,isIPad()&&this.wait(),this.onLoad())}),t.addMethod("onLoad",doNothing),t.addMethod("reset",function(){isIPad()?this._scroll.reset():this._control.scrollTop=0,this._loading=!1}),t.addMethod("wait",function(){if(!this._waitIndicator){this._waitIndicator=new Element("div",{"class":"dimmer resultsOverlay"});var e=this._control.getDimensions(),t=this._control.positionedOffset();this._waitIndicator.setStyle({zIndex:"4000",top:t.top+"px",left:t.left+"px",height:e.height+"px",width:e.width+"px"}),this._control.insert({after:this._waitIndicator})}this._waitIndicator.show()}),t.addMethod("stopWaiting",function(){this._waitIndicator&&this._waitIndicator.hide()}),window.InfiniteScroll=t,t}),define("common/enum/httpStatusCodes",{100:"continue",101:"switchingProtocols",200:"ok",201:"created",202:"accepted",203:"nonAuthoritativeInformation",204:"noContent",205:"resetContent",206:"partialContent",300:"multipleChoices",301:"movedPermanently",302:"found",303:"seeOther",304:"notModified",305:"useProxy",307:"temporaryRedirect",400:"badRequest",401:"unauthorized",402:"paymentRequired",403:"forbidden",404:"notFound",405:"methodNotAllowed",406:"notAcceptable",407:"proxyAuthenticationRequired",408:"requestTimeout",409:"conflict",410:"gone",411:"lengthRequired",412:"preconditionFailed",413:"requestEntityTooLarge",414:"requestUriTooLong",415:"unsupportedMediaType",416:"requestedRangeNotSatisfiable",417:"expectationFailed",500:"internalServerError",501:"notImplemented",502:"badGateway",503:"serviceUnavailable",504:"gatewayTimeout",505:"httpVersionNotSupported"}),define("common/enum/errorCodes",["require"],function(e){"use strict";return{UNEXPECTED_ERROR:"unexpected.error",INVALID_RESOURCE_TYPE:"invalid.resource.type"}}),define("common/model/BaseModel",["require","underscore","backbone","common/enum/httpStatusCodes","common/enum/errorCodes"],function(e){"use strict";var t=e("underscore"),o=e("backbone"),r=e("common/enum/httpStatusCodes"),i=e("common/enum/errorCodes"),n=o.Model.extend({initialize:function(){this.on("error",n.unifyServerErrors)},serialize:function(){return t.clone(this.attributes)}},{unifyServerErrors:function(e,t){var o=r[t.status],i=n.createServerError(t);e.trigger("error:"+o,e,i,t),e.trigger("error:all",e,i,t)},createServerError:function(e){var t;try{t=JSON.parse(e.responseText)}catch(o){t={message:"Can't parse server response",errorCode:i.UNEXPECTED_ERROR,parameters:[]}}return t}});return n}),define("tenantImportExport/export/model/ResourcesModel",["require","backbone","request"],function(e){var t=e("backbone"),o=e("request");return t.Model.extend({url:"rest_v2/settings/exportResourceOptions",fetch:function(){return o({url:this.url,type:"GET"})}})}),define("tenantImportExport/export/enum/exportTypesEnum",{ROOT_TENANT:"rootTenant",TENANT:"tenant",SERVER_CE:"serverCE",SERVER_PRO:"serverPRO",REPOSITORY:"repository"}),define("tenantImportExport/export/factory/exportModelAttributesFactory",["require","underscore","tenantImportExport/export/enum/exportTypesEnum"],function(e){var t=e("underscore"),o=e("tenantImportExport/export/enum/exportTypesEnum"),r={},i={roles:null,users:null,everything:!0,userForRoles:!1,rolesForUser:!1,includeReports:!0,includeOtherResourceFiles:!0,includeDataSources:!0,includeDependentObjects:!0,includeAttributes:!0,includeAttributeValues:!0},n={includeAccessEvents:!1,includeAuditEvents:!1,includeMonitoringEvents:!1},s={includeDomains:!0,includeAdHocViews:!0,includeDashboards:!0},a={includeSubOrganizations:!0},d={includeServerSettings:!0};return r[o.ROOT_TENANT]=t.extend({},i,n,s,a,d),r[o.TENANT]=t.extend({},i,s,a),r[o.SERVER_PRO]=t.extend({},i,n,s,a,d),r[o.SERVER_CE]=t.extend({},i,d,{includeAccessEvents:!0}),function(e){return r[e]}}),define("tenantImportExport/export/model/ExportModel",["require","jquery","underscore","backbone","backbone.validation","bundle!ImportExportValidationBundle","common/util/i18nMessage","common/model/BaseModel","../model/ResourcesModel","tenantImportExport/export/factory/exportModelAttributesFactory","tenantImportExport/export/enum/exportTypesEnum"],function(e){function t(e){var t,o,i=[];return e.get("everything")?(i.push("everything"),e.get("includeAccessEvents")&&i.push("include-access-events")):(t=r(e)&&e.get("includeRepositoryPermissions")&&!n.isEmpty(e.get("uris")),o=!e.get("includeAttributeValues")||!e.get("includeAttributes"),e.get("userForRoles")&&i.push("role-users"),e.get("rolesForUser")&&i.push("users-roles"),t&&i.push("repository-permissions"),!e.get("includeSubOrganizations")&&i.push("skip-suborganizations"),e.get("includeAttributes")&&i.push("include-attributes"),o&&i.push("skip-attribute-values"),e.get("includeServerSettings")&&i.push("include-server-settings"),(!r(e)||!e.get("includeDependentObjects"))&&i.push("skip-dependent-resources")),e.get("includeAuditEvents")&&i.push("include-audit-events"),e.get("includeMonitoringEvents")&&i.push("include-monitoring-events"),e.get("encryptFile")&&i.push("encrypted"),i}function o(e){var t=[],o=new i.Deferred;return!e.get("everything")&&r(e)?e.resources.fetch().done(function(r){for(var i in f)e.get(i)&&t.push(r[f[i]]);o.resolve(n.flatten(t))}):o.resolve(null),o}function r(e){var t=n.keys(f);return n.filter(t,function(t){return e.get(t)}).length}var i=e("jquery"),n=e("underscore"),s=e("backbone"),a=e("backbone.validation"),d=e("bundle!ImportExportValidationBundle"),l=e("common/util/i18nMessage").extend({bundle:d}),c=e("common/model/BaseModel"),h=e("../model/ResourcesModel"),u=e("tenantImportExport/export/factory/exportModelAttributesFactory"),p=e("tenantImportExport/export/enum/exportTypesEnum"),m=256,f={includeReports:"report",includeDomains:"domain",includeAdHocViews:"adhocDataView",includeDataSources:"dataSource",includeDashboards:"dashboard",includeOtherResourceFiles:"others"},g=c.extend({defaults:{uris:["/"],fileName:"export.zip",encryptFile:!1,includeRepositoryPermissions:!0,includeScheduledReportJobs:!0},validation:{fileName:[{required:!0,msg:new l("export.file.name.empty")},{maxLength:m,msg:new l("export.file.name.too.long",m)},{fn:function(e){return/[\\/?*%:|"<>]/g.test(e)?new l("export.file.name.contains.not.supported.characters"):/^[\.]{1,2}$/g.test(e)?new l("export.file.name.not.valid"):void 0}}],uris:[{fn:function(){var e=this.toExportTask();return!(e.uris||e.roles||e.users||n.filter(e.parameters,function(e){return"role-users"!==e&&"users-roles"!==e}).length)}}]},initialize:function(){c.prototype.initialize.call(this),n.bindAll(this),this.resources=new h},url:function(){return"rest_v2/export"},save:function(){var e=new i.Deferred,t=new s.Model,r=this;t.url=this.url;var a={};return o(this).done(function(o){o&&(a.resourceTypes=o),t.save(n.extend(r.toExportTask(),a)).done(function(t){e.resolve(t)}).fail(function(t){e.reject(t),r.trigger("error",r,t)})}),e},cancel:function(){var e=this.url()+"/"+this.id;this.destroy({url:e})},toExportTask:function(){var e=this.get("everything"),o=this.get("roles"),i=this.get("users"),s=n.clone(this.get("uris")),a=e||this.get("includeReports")&&this.get("includeScheduledReportJobs"),d={uris:s,scheduledJobs:this.get("includeScheduledReportJobs")?s:null,parameters:this.get("includeRepositoryPermissions")?["repository-permissions"]:[]},l={uris:r(this)?s:null,roles:n.isEmpty(o)?null:o,users:n.isEmpty(i)?null:i,scheduledJobs:a?s:null,organization:this.get("organization"),parameters:t(this)};return this.type!==p.REPOSITORY?l:d},reset:function(e,t){this.type=t;var o=n.extend({},this.defaults,u(t));this.clear().set(n.extend({},o,e))}});return n.extend(g.prototype,a.mixin),g}),define("tenantImportExport/export/model/ExportStateModel",["require","underscore","common/model/BaseModel"],function(e){var t=e("underscore"),o=e("common/model/BaseModel"),r={INPROGRESS:"inprogress",READY:"finished",FAILED:"failed",PENDING:"pending",CANCELLED:"cancelled"};return o.extend({url:function(){return"rest_v2/export/"+this.id+"/state"},initialize:function(e){o.prototype.initialize.call(this),this.on("change:phase",function(e,o){o==r.INPROGRESS&&t.isUndefined(e.interval)?e.interval=window.setInterval(function(){e.fetch({cache:!1}).fail(t.bind(e.stopPolling,e))},1e3):e.stopPolling()})},stopPolling:function(){t.isUndefined(this.interval)||(window.clearInterval(this.interval),this.interval=void 0)}},{STATE:r})}),define("tenantImportExport/export/model/AuthorityPickerModel",["require","jquery","backbone","components.templateengine","underscore"],function(e){"use strict";var t=e("jquery"),o=e("backbone"),r=e("components.templateengine"),i=e("underscore");return o.Model.extend({defaults:{items:[]},url:function(){return r.renderUrl(this.urlTemplate,this.context,!0)},parse:function(e){return{items:e?e.role?e.role:e.user:[]}},defaultErrorHandler:function(e,o){var r;try{r=t.parseJSON(o.responseText)}catch(i){r=null}this.trigger("error:server",o.status,r,e)},setContext:function(e){this.context=i.extend(this.context||{},e),this.fetch({error:i.bind(this.defaultErrorHandler,this)})}},{instance:function(e,t){var o=new this;return o.urlTemplate=e,t&&o.setContext(t),o}})}),define("text!tenantImportExport/export/template/authorityPickerTemplate.htm",[],function(){return'<div class="control combo {{- customClass}} " title="{{- title}}">\n    <span class="wrap">{{- title}}</span>\n        <span class="control searchLockup ">\n            <div class="wrap">\n                <input type="text" tabindex="">\n            </div>\n            <b class="right">\n                <a class="button searchClear"></a>\n            </b>\n            <a class="button search up"></a>\n        </span>\n\n    <div class="authorityPicker" onselectstart="return false">\n        <div class="selectBorder upper"></div>\n        <ul class="list"></ul>\n        <div class="selectBorder lower"></div>\n    </div>\n\n    <div class="button-select-all" title="{{- selectLabel }}">\n        <i class="icon"></i>\n        <a class="label">\n            <span class="text">{{- selectLabel }}</span>\n        </a>\n    </div>\n</div>'}),define("text!tenantImportExport/export/template/authorityPickerOptionsTemplate.htm",[],function(){return'{{ for (var i = 0, l = items.length; i<l; i++){ }}\n<li class="leaf">\n    <div class=""><span class="leftColumn">{{- items[i].name}}{{- items[i].username}}</span>\n        {{ if (items[i].tenantId){ }}\n            <span class="rightColumn">{{- items[i].tenantId }}</span>\n        {{ } }}\n    </div>\n</li>\n{{ } }}\n'}),define("tenantImportExport/export/view/AuthorityPickerView",["require","jquery","backbone","text!tenantImportExport/export/template/authorityPickerTemplate.htm","text!tenantImportExport/export/template/authorityPickerOptionsTemplate.htm","underscore"],function(e){"use strict";function t(e,t,o){return o<=Math.max(e,t)&&o>=Math.min(e,t)}var o=e("jquery"),r=e("backbone"),i=e("text!tenantImportExport/export/template/authorityPickerTemplate.htm"),n=e("text!tenantImportExport/export/template/authorityPickerOptionsTemplate.htm"),s=e("underscore");return r.View.extend({events:{"click .button.search":"search","click .button.searchClear":"clear","click .button-select-all":"_selectAllHandler","keydown input[type=text]":"keyHandler","mousedown li":"selectionStarted","mouseenter li":"mouseEntered","mouseleave li":"mouseLeave","mouseup ul":"selectionFinished","mouseenter ul":"stopScroll","mouseleave ul":"startScroll"},cursor:-1,baseCursor:-1,selecting:!1,scrollSpeed:30,initialize:function(e){this.model.on("change",s.bind(this.renderList,this)),this.model.on("error:server",s.bind(function(){this.trigger("error:server",arguments)},this)),this.upHandler=s.bind(function(e){this.stopScroll(e),this.selecting=!1},this),this.el=!1,this.initOptions=e},render:function(){return this.mainTemplate||(this.mainTemplate=s.template(i)),this.optionsTemplate||(this.optionsTemplate=s.template(n)),this.el||(this.$el=o("<div/>").html(this.mainTemplate(this.initOptions)).children(),this.el=this.$el[0],this.subEl=this.$el.find(".authorityPicker ul"),this.delegateEvents()),this.model.context||this.model.setContext(),this},renderList:function(){return this.subEl.html(this.optionsTemplate(this.model.attributes)).find("li").each(function(e,t){o(t).attr("index",e)}),this.cursor=-1,this.baseCursor=-1,this.scrollSpeed=this.subEl.find("li:eq(0)").height(),this.subEl.scrollTop(0),this.trigger("change:selection",[]),this},getSelected:function(){return s.reduce(this.subEl.find(".selected"),function(e,t){return e.push(s.pluck(o(t).find("span"),"innerHTML").join("|")),e},[])},search:function(){var e=this.$el.find("input[type=text]").val();this.model.setContext({searchString:e}),e?this.$el.find(".button.searchClear").addClass("up"):this.$el.find(".button.searchClear").removeClass("up")},_selectAllHandler:function(){this.selectAll()},clear:function(){this.$el.find("input[type=text]").val(""),this.search()},keyHandler:function(e){13===e.which&&this.search()},setDisabled:function(e){var t=this.$el.find(".button-select-all").children();e?(this.subEl.addClass("disabled"),t.addClass("disabled"),this.undelegateEvents()):(this.subEl.removeClass("disabled"),t.removeClass("disabled"),this.delegateEvents()),this.$el.find("input[type=text]").attr("disabled",e)},highlightSet:function(e){this.subEl.find("li").each(function(t,r){r=o(r),r.toggleClass("highlighted",s.contains(e,s.pluck(r.find("span"),"innerHTML").join("|")))})},selectAll:function(e){this.subEl.find("li").each(function(e,t){o(t).addClass("selected")}),e||this.trigger("change:selection",this.getSelected())},selectNone:function(e){this.subEl.find("li").each(function(e,t){o(t).removeClass("selected")}),e||this.trigger("change:selection",this.getSelected())},selectInverse:function(e){this.subEl.find("li").each(function(e,t){o(t).toggleClass("selected")}),e||this.trigger("change:selection",this.getSelected())},selectItem:function(e,t){this.subEl.find("li[index="+e+"]").addClass("selected"),t||this.trigger("change:selection",this.getSelected())},unSelectItem:function(e,t){this.subEl.find("li[index="+e+"]").removeClass("selected"),t||this.trigger("change:selection",this.getSelected())},selectRange:function(e,t,r){var i=Math.min(e,t),n=Math.max(e,t);this.subEl.find("li:lt("+(n+1)+")").each(function(e,t){e>=i&&o(t).addClass("selected")}),r||this.trigger("change:selection",this.getSelected())},selectionStarted:function(e){this.selecting=!0,e.ctrlKey||e.metaKey||this.selectNone(!0);var t=+o(e.target).parents("li").toggleClass("selected").attr("index");e.shiftKey?-1!=this.cursor&&this.selectRange(this.cursor,t,!0):(this.cursor=t,this.baseCursor=this.cursor)},mouseEntered:function(e){this.selecting&&(this.cursor=+o(e.target).parents("li").addClass("selected").attr("index"))},mouseLeave:function(e){if(this.selecting){var r=o(e.target).parents("li"),i=o(e.relatedTarget).parents("li");t(this.cursor,this.baseCursor,+i.attr("index"))&&r.removeClass("selected")}},selectionFinished:function(e){this.selecting=!1,this.trigger("change:selection",this.getSelected())},startScroll:function(e){if(this.selecting){if(o(e.relatedTarget).hasClass("upper"))this.direction=-1;else{if(!o(e.relatedTarget).hasClass("lower"))return void(this.selecting=!1);this.direction=1}o(document.body).on("mouseup",this.upHandler),this.scrollTimer=setInterval(s.bind(this.scrollList,this),200)}},stopScroll:function(e){this.selecting&&(clearInterval(this.scrollTimer),this.direction=0,o(document.body).off("mouseup",this.upHandler))},scrollList:function(){this.subEl.scrollTop(+this.subEl.scrollTop()+this.scrollSpeed*this.direction),t(this.cursor,this.baseCursor,this.cursor+this.direction)?this.unSelectItem(this.cursor,!0):this.selectItem(this.cursor+this.direction,!0),this.cursor=this.cursor+this.direction}})}),define("text!tenantImportExport/export/template/loadingDialogTemplate.htm",[],function(){return'<div class="panel dialog loading overlay moveable centered_horz centered_vert {{- additionalCssClasses }}" tabindex="-1">\n    <div class="content">\n        <div class="header mover">\n            <div class="title">{{- title }}</div>\n        </div>\n        <div class="body">\n            <p class="message"></p>\n        </div>\n    </div>\n</div>\n'}),define("tenantImportExport/export/view/LoadingDialog",["require","common/component/dialog/Dialog","underscore","bundle!CommonBundle","text!tenantImportExport/export/template/loadingDialogTemplate.htm"],function(e){var t=e("common/component/dialog/Dialog"),o=e("underscore"),r=e("bundle!CommonBundle"),i=e("text!tenantImportExport/export/template/loadingDialogTemplate.htm");return t.extend({defaultTemplate:i,constructor:function(e){o.defaults(e,{contentContainer:".body > .message",title:r["dialog.overlay.title"],modal:!0}),t.call(this,e)}})}),define("text!tenantImportExport/import/template/dependentResourcesDialogTemplate.htm",[],function(){return'{{ if (message) { }}<p class="message">{{- message }}</p> {{ } }}\n<div class="control groupBox">\n    <ol class="list tabular oneColumn">\n        {{ for (var i = 0; i<items.length; i++) { }}\n        <li class="leaf {{-  i === 0 ? \' first\' : \'\' }} {{- i === items.length - 1 ? \'last\' : \'\' }}" tabindex="-1">\n            <div class="wrap">\n                <div class="column one">\n                    <p class="uri">{{- items[i] }} </p>\n                </div>\n            </div>\n        </li>\n        {{ } }}\n    </ol>\n\n</div>\n\n'}),define("tenantImportExport/view/BaseWarningDialogView",["require","jquery","underscore","common/component/dialog/Dialog","bundle!ImportExportBundle","text!tenantImportExport/import/template/dependentResourcesDialogTemplate.htm"],function(e){var t=(e("jquery"),e("underscore")),o=e("common/component/dialog/Dialog"),r=e("bundle!ImportExportBundle"),i=e("text!tenantImportExport/import/template/dependentResourcesDialogTemplate.htm");return o.extend({events:{resize:"onResizeHeight"},onResizeHeight:function(){this.$contentContainer.height(this.$el.height()-this._resizableContainerShiftHeight),this.$(".control.groupBox").css("min-height",this.$contentContainer.height()-this.$(".message").outerHeight(!0))},constructor:function(e){e=e||{},this.options=e,o.prototype.constructor.call(this,{modal:!0,resizable:e.resizable,minWidth:e.minWidth,minHeight:e.minHeight,additionalCssClasses:e.additionalCssClasses||"dependent-resources-dialog",title:e.title||r["dialog.broken.dependencies.title"],content:"",buttons:e.buttons}),this.template=t.template(e.template||i)},open:function(e){this.setContent(this.template(t.defaults(e,{message:""}))),o.prototype.open.apply(this,arguments),this.$contentContainer.scrollTop(0),this._resizableContainerShiftHeight=this.$(".m-Dialog-footer").outerHeight()+this.$(".m-Dialog-header").outerHeight()+this.$contentContainer.outerHeight()-this.$contentContainer.height()}})}),define("tenantImportExport/export/view/ExportDependentResourcesDialogView",["require","underscore","bundle!CommonBundle","bundle!ImportExportBundle","tenantImportExport/view/BaseWarningDialogView"],function(e){var t=e("underscore"),o=e("bundle!CommonBundle"),r=e("bundle!ImportExportBundle"),i=e("tenantImportExport/view/BaseWarningDialogView");return i.extend({constructor:function(e){e||(e={}),t.extend(e,{resizable:!0,buttons:[{label:r["export.button.continue"],action:"export",primary:!0},{label:o["button.cancel"],action:"cancel",primary:!1}]}),i.prototype.constructor.call(this,e),this.on("button:export",t.bind(this.close,this)),this.on("button:cancel",t.bind(this.close,this))},open:function(e){t.extend(e,{message:r["export.dialog.broken.dependencies.intro"]}),i.prototype.open.call(this,e)}})}),define("text!common/component/notification/template/notificationTemplate.htm",[],function(){return'<div class="notificationAlert">\n    <p class="notificationMessage">\n        <span>{{- message }}</span>\n        <span class="close">| <a href="#">{{- i18n[\'notification.button.close\'] }}</a></span>\n    </p>\n</div>'}),define("common/component/notification/Notification",["require","underscore","jquery","backbone","bundle!js-sdk/CommonBundle","text!./template/notificationTemplate.htm","css!notifications"],function(e){"use strict";var t,o,r=e("underscore"),i=e("jquery"),n=e("backbone"),s=e("bundle!js-sdk/CommonBundle"),a=e("text!./template/notificationTemplate.htm");e("css!notifications");var d={SUCCESS:"success",WARNING:"warning"},l=2e3,c={};return c[d.WARNING]=d.WARNING,o=n.View.extend({template:r.template(a),events:{"click .close a":"hide"},el:function(){return this.template({message:this.message,i18n:s})},initialize:function(){this.render()},render:function(){return i("body").append(this.$el),this.$el.hide(),this.$messageContainer=this.$(".notificationMessage > span:first-child"),this},show:function(e){return e=r.extend({type:d.WARNING,delay:l},e),this.$messageContainer.text(e.message),this.$messageContainer.removeClass().attr({"class":c[e.type]}),this.$el.slideDown(),e.delay&&r.delay(r.bind(this.hide,this),e.delay),this},hide:function(){return arguments.length&&arguments[0].preventDefault&&arguments[0].preventDefault(),this.$el.slideUp(),this},remove:function(){n.View.prototype.remove.apply(this,arguments)}},{show:function(){return t||(t=new o),t.show.apply(t,arguments)},hide:function(){return t||(t=new o),t.hide.apply(t,arguments)}})}),define("common/view/mixin/epoxyCustomBindingHandlers",["require"],function(e){return{}}),define("common/view/mixin/epoxyCustomBindingFilters",["require"],function(e){return{}}),define("common/view/mixin/epoxyViewMixin",["require","backbone.epoxy","underscore","./epoxyCustomBindingHandlers","./epoxyCustomBindingFilters"],function(e){var t=e("backbone.epoxy"),o=e("underscore"),r=e("./epoxyCustomBindingHandlers"),i=e("./epoxyCustomBindingFilters");return{epoxifyView:function(){var e=this.remove;t.View.mixin(this),e&&(this.remove=e),this.bindingFilters?this.bindingFilters=o.extend({},i,this.bindingFilters):i,this.bindingHandlers?this.bindingHandlers=o.extend({},r,this.bindingHandlers):r},applyEpoxyBindings:function(){this.applyBindings()},removeEpoxyBindings:function(){this.removeBindings()}}}),define("text!tenantImportExport/export/template/assetsToIncludeExtendedVersionTemplate.htm",[],function(){return'<div class="section resources tenant-options">\n    <p class="title">{{- i18n["export.dialog.resources"] }}</p>\n\n    <div class="group">\n        <div class="control checkBox">\n            <label class="wrap" title="">{{- i18n["export.dialog.resources.data.sources"] }}</label>\n            <input class="includeDataSources" name="includeDataSources" type="checkbox"\n                   data-bind="checked:includeDataSources, disabled:everything">\n        </div>\n        {{ if(!isServerCe) { }}\n        <div class="control checkBox">\n            <label class="wrap" title="">{{- i18n["export.dialog.resources.domains"] }}</label>\n            <input class="includeDomains" name="includeDomains" type="checkbox"\n                   data-bind="checked:includeDomains, disabled:everything">\n        </div>\n        <div class="control checkBox">\n            <label class="wrap" title="">{{- i18n["export.dialog.resources.ad.hoc.views"] }}</label>\n            <input class="includeAdHocViews" name="includeAdHocViews" type="checkbox"\n                   data-bind="checked:includeAdHocViews, disabled:everything">\n        </div>\n        {{ } }}\n        <div class="control checkBox">\n            <label class="wrap" title="">{{- i18n["export.dialog.resources.reports"] }}</label>\n            <input class="includeReports" name="includeReports" type="checkbox"\n                   data-bind="checked:includeReports, disabled:everything">\n        </div>\n        {{ if(!isServerCe) { }}\n        <div class="control checkBox">\n            <label class="wrap" title="">{{- i18n["export.dialog.resources.dashboards"] }}</label>\n            <input class="includeDashboards" name="includeDashboards" type="checkbox"\n                   data-bind="checked:includeDashboards, disabled:everything">\n        </div>\n        {{ } }}\n        <div class="control checkBox">\n            <label class="wrap" title="">{{- i18n["export.dialog.resources.scheduled.report.jobs"] }}</label>\n            <input class="includeScheduledReportJobs" name="includeScheduledReportJobs" type="checkbox"\n                   data-bind="checked:includeScheduledReportJobs, enabled:enableReportJobs">\n        </div>\n        <div class="control checkBox">\n            <label class="wrap" title="">{{- i18n["export.dialog.resources.other.resources"] }}</label>\n            <input class="includeOtherResourceFiles" name="includeOtherResourceFiles" type="checkbox"\n                   data-bind="checked:includeOtherResourceFiles, disabled:everything">\n        </div>\n    </div>\n</div>\n\n<div class="section assets tenant-options">\n    <p class="title">{{- i18n["export.dialog.assets"] }}</p>\n\n    <div class="group">\n        {{ if(!isServerCe) { }}\n        <div class="control checkBox">\n            <label class="wrap" title="">{{- i18n["export.dialog.assets.sub.organizations"] }}</label>\n            <input class="includeSubOrganizations" name="includeSubOrganizations" type="checkbox"\n                   data-bind="checked:includeSubOrganizations, disabled:everything">\n        </div>\n        {{ } }}\n        <div class="control checkBox">\n            <label class="wrap" title="">{{- i18n["export.dialog.assets.dependent.objects"] }}</label>\n            <input class="includeDependentObjects" name="includeDependentObjects" type="checkbox"\n                   data-bind="checked:includeDependentObjects, enabled:someResourceIsChecked">\n        </div>\n\n        <div class="control checkBox">\n            <label class="wrap" title="">{{- i18n["export.dialog.assets.repository.permissions"] }}</label>\n            <input class="includeRepositoryPermissions" name="includeRepositoryPermissions" type="checkbox"\n                   data-bind="checked:includeRepositoryPermissions, enabled:someResourceIsChecked">\n        </div>\n        {{ if (isServerOrRootType) { }}\n        <div class="control checkBox">\n            <label class="wrap" title="">{{- i18n["export.dialog.assets.server.settings"] }}</label>\n            <input class="includeServerSettings" name="includeServerSettings" type="checkbox"\n                   data-bind="checked:includeServerSettings, disabled:everything">\n        </div>\n        {{ } }}\n        <div class="control checkBox">\n            <label class="wrap" title="">{{- i18n["export.dialog.assets.attributes"] }}</label>\n            <input class="includeAttributes" name="includeAttributes" type="checkbox"\n                   data-bind="checked:includeAttributes, disabled:everything">\n        </div>\n        <div class="control checkBox">\n            <label class="wrap" title="">{{- i18n["export.dialog.assets.attribute.values"] }}</label>\n            <input class="includeAttributeValues" name="includeAttributeValues" type="checkbox"\n                   data-bind="checked:includeAttributeValues, enabled:enableAttributesValues">\n        </div>\n    </div>\n</div>\n';
}),define("text!tenantImportExport/export/template/eventsToIncludeTemplate.htm",[],function(){return'<div class="section events">\n    <p class="title">{{- i18n["export.dialog.events"] }}</p>\n    <div class="group">\n        <div class="control checkBox">\n            <label class="wrap" title="">{{- i18n["export.dialog.events.access.events"] }}</label>\n            <input class="includeAccessEvents" name="includeAccessEvents" type="checkbox" data-bind="checked:includeAccessEvents, enabled:everything">\n        </div>\n        {{ if(!isServerCe) { }}\n        <div class="control checkBox">\n            <label class="wrap" title="">{{- i18n["export.dialog.events.audit.events"] }}</label>\n            <input class="includeAuditEvents" name="includeAuditEvents" type="checkbox" data-bind="checked:includeAuditEvents">\n        </div>\n        <div class="control checkBox">\n            <label class="wrap" title="">{{- i18n["export.dialog.events.monitoring.events"] }}</label>\n            <input class="includeMonitoringEvents" name="includeMonitoringEvents" type="checkbox" data-bind="checked:includeMonitoringEvents">\n        </div>\n        {{ } }}\n    </div>\n</div>'}),define("text!tenantImportExport/export/template/exportDataFileTemplate.htm",[],function(){return'<div class="section file-name">\n    {{ if (!isRepository) { }} <p class="title">{{- i18n["export.dialog.file.properties"] }}</p> {{ } }}\n    <div class="group">\n        <div class="control input" data-bind="validationErrorClass:fileName" data-model-attr="fileName">\n            <span class="wrap">{{- i18n["export.dialog.file.properties.data.file.name"]}}</span>\n            <input type="text" class="fileName"  data-bind="value:fileName, events:[\'keyup\']"/>\n            <span class="message warning fileNameMessage" data-bind="validationErrorText:fileName" data-model-attr="fileName"></span>\n        </div>\n\n        {{ if (0) { }}\n        <div class="control checkBox encryptFileWrapper">\n            <label class="wrap" title="">{{- i18n["export.dialog.file.properties.encrypt.file"] }}</label>\n            <input class="encryptFile" name="encryptFile" type="checkbox" data-bind="checked:encryptFile">\n        </div>\n        {{ } }}\n    </div>\n</div>\n'}),define("text!tenantImportExport/export/template/rolesAndUsersToIncludeTemplate.htm",[],function(){return'<div class="section roles-users">\n    <p class="title">{{- i18n["export.dialog.roles.users"] }}</p>\n    <div class="group rolesAndUsers">\n        <div class="control radio">\n            <label class="wrap" title="" for="selectedUsersRoles">{{- i18n["export.dialog.roles.users.selected.roles.users"] }}</label>\n            <input id="selectedUsersRoles" class="selectedUsersRoles" name="sample" type="radio" data-bind="disabled:everything" checked="checked">\n        </div>\n        <div class="control radio">\n            <label class="wrap" title="" for="usersWithSelectedRoles">{{- i18n["export.dialog.roles.users.users.with.selected.roles"] }}</label>\n            <input id="usersWithSelectedRoles" class="usersWithSelectedRoles" name="sample" type="radio" data-bind="disabled:everything">\n        </div>\n        <div class="control radio">\n            <label class="wrap" title="" for="rolesWithSelectedUsers">{{- i18n["export.dialog.roles.users.roles.with.selected.users"] }}</label>\n            <input id="rolesWithSelectedUsers" class="rolesWithSelectedUsers" name="sample" type="radio" data-bind="disabled:everything">\n        </div>\n    </div>\n    <div class="group">\n        <div class="selectRolesUsers column two control pickWells"></div>\n    </div>\n</div>'}),define("text!tenantImportExport/export/template/exportOptionsContainerTemplate.htm",[],function(){return'<div class="export-options">\n    {{ if (!isRepository) { }}\n    <p class="title export-options-title">{{- i18n["export.dialog.options"] }}</p>\n    <div class="section everything">\n        <div class="control checkBox everything">\n            <label class="wrap" title="">{{- i18n["export.dialog.everything"] }}</label>\n            <input class="everything" name="everything" type="checkbox" data-bind="checked:everything">\n        </div>\n    </div>\n    {{ } }}\n</div>'}),define("text!tenantImportExport/export/template/repositoryExportTemplate.htm",[],function(){return'<div class="section resources">\n    <p>{{- i18n["export.dialog.options"] }}</p>\n    <div class="group">\n        <div class="control checkBox">\n            <label class="wrap" title="">{{- i18n["export.report.jobs"] }}</label>\n            <input class="includeScheduledReportJobs" name="includeScheduledReportJobs" type="checkbox" data-bind="checked:includeScheduledReportJobs">\n        </div>\n        <div class="control checkBox">\n            <label class="wrap" title="">{{- i18n["export.include.permissions"] }}</label>\n            <input class="includeRepositoryPermissions" name="includeRepositoryPermissions" type="checkbox" data-bind="checked:includeRepositoryPermissions">\n        </div>\n    </div>\n</div>'}),define("tenantImportExport/export/factory/exportTemplateFactory",["require","jquery","text!tenantImportExport/export/template/assetsToIncludeExtendedVersionTemplate.htm","text!tenantImportExport/export/template/eventsToIncludeTemplate.htm","text!tenantImportExport/export/template/exportDataFileTemplate.htm","text!tenantImportExport/export/template/rolesAndUsersToIncludeTemplate.htm","text!tenantImportExport/export/template/exportOptionsContainerTemplate.htm","text!tenantImportExport/export/template/repositoryExportTemplate.htm","tenantImportExport/export/enum/exportTypesEnum"],function(e){var t=e("jquery"),o=e("text!tenantImportExport/export/template/assetsToIncludeExtendedVersionTemplate.htm"),r=e("text!tenantImportExport/export/template/eventsToIncludeTemplate.htm"),i=e("text!tenantImportExport/export/template/exportDataFileTemplate.htm"),n=e("text!tenantImportExport/export/template/rolesAndUsersToIncludeTemplate.htm"),s=e("text!tenantImportExport/export/template/exportOptionsContainerTemplate.htm"),a=e("text!tenantImportExport/export/template/repositoryExportTemplate.htm"),d=e("tenantImportExport/export/enum/exportTypesEnum"),l={};return l[d.ROOT_TENANT]=[n,o,r].join(""),l[d.TENANT]=[n,o].join(""),l[d.SERVER_PRO]=[n,o,r].join(""),l[d.SERVER_CE]=[n,o,r].join(""),l[d.REPOSITORY]=[a].join(""),function(e){return e=e||{},i+t(s).append(l[e.type])[0].outerHTML}}),define("tenantImportExport/export/view/ExportView",["require","css!importExport","jquery","underscore","backbone","../model/ExportModel","../model/ExportStateModel","../model/AuthorityPickerModel","./AuthorityPickerView","./LoadingDialog","./ExportDependentResourcesDialogView","common/component/notification/Notification","common/view/mixin/epoxyViewMixin","tenantImportExport/export/factory/exportTemplateFactory","tenantImportExport/export/enum/exportTypesEnum","bundle!ImportExportBundle","bundle!CommonBundle"],function(e){"use strict";function t(e){this.rolesList=new c({model:l.instance("rest_v2/{{#tenantId}}organizations/{{{tenantId}}}/{{/tenantId}}roles?q={{{searchString}}}{{#excludeSubOrgs}}&includeSubOrgs=false{{/excludeSubOrgs}}",{tenantId:e.tenantId}),customClass:"selectedRoles",title:v["export.dialog.roles.users.roles.label"],selectLabel:v["export.dialog.roles.users.select.all.roles.label"]}),this.rolesList.on("change:selection",this.bindWithRoles),this.rolesList.render(),this.usersList=new c({model:l.instance("rest_v2/{{#tenantId}}organizations/{{{tenantId}}}/{{/tenantId}}users?q={{{searchString}}}{{#excludeSubOrgs}}&includeSubOrgs=false{{/excludeSubOrgs}}",{tenantId:e.tenantId}),customClass:"select selectedUsers",title:v["export.dialog.roles.users.users.label"],selectLabel:v["export.dialog.roles.users.select.all.users.label"]}),this.usersList.on("change:selection",this.bindWithUsers),this.usersList.render(),this.rolesToUsers=l.instance("rest_v2/users?hasAllRequiredRoles=false{{#roles}}&requiredRole={{{.}}}{{/roles}}"),this.rolesToUsers.on("change",this.onRolesToUsersChange),this.usersToRoles=l.instance("rest_v2/roles?hasAllUsers=false{{#users}}&user={{{.}}}{{/users}}"),this.usersToRoles.on("change",this.onUsersToRolesChange),this.changeEnabledState(),this.listenTo(this.model,"change:everything",this.changeEnabledState),this.$el.find(".selectRolesUsers").append(this.rolesList.el).append(this.usersList.el),this.listenTo(this.model,"change:includeSubOrganizations",this.filterAuthoritiesBySubOrgs)}function o(){var e=document.createElement("iframe");e.src=this.model.url()+"/"+this.stateModel.id+"/"+this.model.get("fileName"),e.style.display="none",i("body").append(e)}function r(e){this.model.cancel(),this.stateModel.set("phase",e)}e("css!importExport");var i=e("jquery"),n=e("underscore"),s=e("backbone"),a=e("../model/ExportModel"),d=e("../model/ExportStateModel"),l=e("../model/AuthorityPickerModel"),c=e("./AuthorityPickerView"),h=e("./LoadingDialog"),u=e("./ExportDependentResourcesDialogView"),p=e("common/component/notification/Notification"),m=e("common/view/mixin/epoxyViewMixin"),f=e("tenantImportExport/export/factory/exportTemplateFactory"),g=e("tenantImportExport/export/enum/exportTypesEnum"),v=e("bundle!ImportExportBundle"),S=e("bundle!CommonBundle"),y=s.View.extend({className:"export-view",events:{"change .usersWithSelectedRoles":"includeRolesByUsers","change .rolesWithSelectedUsers":"includeUsersWithRoles","change .selectedUsersRoles":"includeSelectedRolesUsersOnly","click .section .checkBox label":"_clickOnCheckbox"},computeds:{includeAccessEventsChecked:function(){return this.model.get("everything")?this.model.get("includeAccessEvents"):!1},enableAttributesValues:{deps:["everything","includeAttributes"],get:function(e,t){return!e&&t}},enableReportJobs:{deps:["everything","includeReports"],get:function(e,t){return!e&&t}},someResourceIsChecked:{deps:["everything","includeReports","includeAdHocViews","includeDashboards","includeDomains","includeDataSources","includeOtherResourceFiles"],get:function(e,t,o,r,i,n,s){return!e&&(t||o||r||i||n||s)}}},initialize:function(){n.bindAll(this),this.model||(this.model=new a),this.stateModel=new d,this.epoxifyView(),this.loadingDialog=new h({content:S["dialog.overlay.loading"]}),this.notification=new p,this.dependentResourcesDialogView=new u,this.listenTo(this.model,"change",this._onModelChange),this.listenTo(this.stateModel,"change:phase",this.handleExportPhase,this),this.listenTo(this.model,"error:unauthorized",window.location.reload),this.listenTo(this.stateModel,"error:unauthorized",window.location.reload);var e={delay:!1,message:v["export.error.cancelled"]},t={delay:!1,message:v["export.error.unexpected"]};this.listenTo(this.model,"error:notFound",n.bind(this.notification.show,this.notification,e)),this.listenTo(this.stateModel,"error:notFound",n.bind(this.notification.show,this.notification,e)),this.listenTo(this.model,"error:internalServerError",n.bind(this.notification.show,this.notification,t)),this.listenTo(this.stateModel,"error:internalServerError",n.bind(this.notification.show,this.notification,t)),this.listenTo(this.model,"error",n.bind(this.loadingDialog.close,this.loadingDialog)),this.listenTo(this.stateModel,"error",n.bind(this.loadingDialog.close,this.loadingDialog)),this.listenTo(this.dependentResourcesDialogView,"button:export",n.compose(n.bind(this.dependentResourcesDialogView.close,this.dependentResourcesDialogView),n.bind(function(){o.call(this),this._showNotification({message:v["export.finished"],type:"success"})},this))),this.listenTo(this.dependentResourcesDialogView,"button:cancel",n.bind(r,this,d.STATE.CANCELLED))},render:function(e){e=e||{},this.type=e.type;var o=this._isServerLevel(this.type),r=o||this.type===g.ROOT_TENANT;return r?this.$el.addClass("with-events"):this.$el.removeClass("with-events"),this.stopListening(this.model,"change:includeSubOrganizations",this.filterAuthoritiesBySubOrgs),this._resetModel(e),this.template=n.template(f(e))({everything:!1,i18n:v,isServerOrRootType:r,isServerLevel:o,isServerCe:this.type===g.SERVER_CE,isRepository:this.type===g.REPOSITORY}),this.$el.html(this.template),this.$(".selectRolesUsers").length&&t.call(this,e),this.applyEpoxyBindings(),this},doExport:function(){var e=this;this.model.isValid(!0)&&(this.loadingDialog.open(),this.model.save().done(function(t){e.stateModel.unset("brokenDependencies",{silent:!0}),e.stateModel.set(t),e.model.id=t.id}))},handleExportPhase:function(){var e,t=this.stateModel.get("phase"),r=this._getBrokenDependencies();t==d.STATE.READY&&(this.loadingDialog.close(),n.isEmpty(r)?(o.call(this),e={message:v["export.finished"],type:"success"}):this.dependentResourcesDialogView.open({items:r})),t==d.STATE.FAILED&&(e={message:v["export.error.unexpected"]}),t==d.STATE.CANCELLED&&(e={message:v["export.error.cancelled"]}),e&&this._showNotification(e)},filterAuthoritiesBySubOrgs:function(){var e={excludeSubOrgs:!this.model.get("includeSubOrganizations")};this.rolesList.model.setContext(e),this.usersList.model.setContext(e)},bindWithRoles:function(e){this.model.set({roles:e}),this.onUsersToRolesChange(),e.length?this.rolesToUsers.setContext({roles:e}):this.rolesToUsers.set({items:[]})},bindWithUsers:function(e){this.model.set({users:e}),this.onRolesToUsersChange(),e.length?this.usersToRoles.setContext({users:e}):this.usersToRoles.set({items:[]})},changeEnabledState:function(){var e=this.model.get("everything");this.rolesList.setDisabled(e||this.model.get("rolesForUser")),this.usersList.setDisabled(e||this.model.get("userForRoles")),e&&(this.rolesList.selectNone(),this.usersList.selectNone())},includeRolesByUsers:function(e){var t=i(e.target).is(":checked");this.model.set({rolesForUser:!t,userForRoles:t}),this.onRolesToUsersChange(),this._includeUsersOrRoles(!t,t)},includeUsersWithRoles:function(e){var t=i(e.target).is(":checked");this.model.set({rolesForUser:t,userForRoles:!t}),this.onUsersToRolesChange(),this._includeUsersOrRoles(t,!t)},includeSelectedRolesUsersOnly:function(e){i(e.target).is(":checked")&&(this.model.set({userForRoles:!1,rolesForUser:!1}),this.onRolesToUsersChange(),this.onUsersToRolesChange(),this._includeUsersOrRoles(!1,!1))},sendParameters:function(e){this.model.isValid(!0)&&this.model.save()},onRolesToUsersChange:function(){this.model.get("userForRoles")?(this.usersList.highlightSet(n.map(this.rolesToUsers.get("items"),function(e){return e.username+(e.tenantId?"|"+e.tenantId:"")})),this.rolesList.highlightSet([])):this.usersList.highlightSet([])},onUsersToRolesChange:function(){this.model.get("rolesForUser")?(this.rolesList.highlightSet(n.map(this.usersToRoles.get("items"),function(e){return e.name+(e.tenantId?"|"+e.tenantId:"")})),this.usersList.highlightSet([])):this.rolesList.highlightSet([])},_isServerLevel:function(e){return e===g.SERVER_CE||e===g.SERVER_PRO},_includeUsersOrRoles:function(e,t){this.rolesList.setDisabled(e),this.usersList.setDisabled(t),this.rolesList.selectNone(),this.usersList.selectNone()},_showNotification:function(e){e=n.defaults(e,{type:"warning"}),this.loadingDialog.isVisible()&&this.loadingDialog.close(),this.notification.show({delay:!1,message:e.message,type:e.type})},_getBrokenDependencies:function(){var e=this.stateModel.get("warnings"),t=[];return n.each(e,function(e){"export.broken.dependency"===e.code&&t.push(e.parameters)}),n.flatten(n.sortBy(t,function(e){return e}))},_clickOnCheckbox:function(e){var t=i(e.target).next();t[0].disabled||this.model.set(t[0].name,!t[0].checked)},_onModelChange:function(){this.model.isValid(!0)},_resetModel:function(e){var t={organization:this.type==g.REPOSITORY?null:e.tenantId};if(this.type===g.ROOT_TENANT||this.type===g.TENANT){var o=this.type===g.ROOT_TENANT?"root_export.zip":e.tenantId+"_export.zip";n.extend(t,{fileName:o})}this.model.reset(t,this.type)}});return n.extend(y.prototype,m),y}),define("tenantImportExport/export/view/ExportDialogView",["require","jquery","underscore","common/component/dialog/Dialog","./ExportView","bundle!CommonBundle","bundle!ImportExportBundle","tenantImportExport/export/enum/exportTypesEnum"],function(e){function t(e){return r.isArray(e)?r.pluck(e,"URIString"):[e.URIString]}function o(e){return r.isArray(e)||(e=[e]),!!r.reduce(e,function(e,t){return e||!t.resourceType||t.resourceType.indexOf("ReportUnit")+1||t.resourceType.indexOf("ReportOptions")+1},!1)}var r=(e("jquery"),e("underscore")),i=e("common/component/dialog/Dialog"),n=e("./ExportView"),s=e("bundle!CommonBundle"),a=e("bundle!ImportExportBundle"),d=e("tenantImportExport/export/enum/exportTypesEnum");return i.extend({constructor:function(e){e||(e={}),this.options=e,i.prototype.constructor.call(this,{model:this.model,resizable:!0,modal:!0,content:"",buttons:[{label:s["button.export"],action:"export",primary:!0},{label:s["button.cancel"],action:"cancel",primary:!1}]}),this.on("button:export",r.bind(this._onExportButtonClick,this)),this.on("button:cancel",r.bind(this._closeExportDialog,this))},initialize:function(e){this.exportView=new n,this.listenTo(this.exportView.model,"validated",function(e){e?this.buttons.enable("export"):this.buttons.disable("export")},this),i.prototype.initialize.apply(this,arguments)},openRepoDialog:function(e){var r={type:d.REPOSITORY},i=" "+a["export.dialog.repository.title"];this.addCssClasses("repository-export-dialog"),this._openExportDialog(r,i),this.exportView.model.set({uris:t(e),includeScheduledReportJobs:o(e)})},openTenantDialog:function(e){var t=" "+e.name,o=e.isRoot()?d.ROOT_TENANT:d.TENANT,r={type:o,tenantId:e.id};this.addCssClasses("tenant-export-dialog"),this._openExportDialog(r,t)},fieldIsValid:function(){},fieldIsInvalid:function(e){},_onExportButtonClick:function(){this.exportView.doExport(),this._closeExportDialog()},_closeExportDialog:function(){this.$el.css({width:this.width}),this.close()},_openExportDialog:function(e,t){var o=a["export.dialog.title"]+(t?t:"");this.setContent(this.exportView.render(e).$el),this.setTitle(o),this.exportView.applyEpoxyBindings(),this.exportView.delegateEvents(),i.prototype.open.apply(this,arguments),this.$el.css({minHeight:this.$el.outerHeight()}),this.width=this.$el.outerWidth()}})}),repositorySearch.secondarySearchBox={_searchBox:null,initialize:function(e){this._searchBox=new SearchBox({id:"secondarySearchBox"}),this._searchBox.onSearch=function(e){repositorySearch.fire(repositorySearch.Event.SEARCH_SEARCH,{text:e})},this.setText(e)},setText:function(e){this._searchBox.setText(e)}},repositorySearch.toolbar={_bulkActions:{},initialize:function(e){this._bulkActions=e,toolbarButtonModule.initialize(this._toActionMap(this._bulkActions)),this.refresh()},refresh:function(){for(var e in this._bulkActions){var t=this._bulkActions[e].buttonId,o=toFunction(this._bulkActions[e].test);toolbarButtonModule.setButtonState($(t),o())}},_toActionMap:function(e){var t={};for(var o in e){var r=e[o],i=r.buttonId;t[i]=function(e,t){return function(){var o=getAsFunction(e),r=t,i=localContext&&localContext[e];r&&isArray(r)?o.apply(i?localContext:null,r):o.call(i?localContext:null,r)}}(r.action,r.actionArgs)}return t}},repositorySearch.foldersPanel={_treeId:"foldersTree",_uri:"/",_cookieName:"lastFolderUri",_canDoBrowse:!0,_touchController:null,initialize:function(e){if(e.isFolderSet)this._uri=e.state.folderUri;else{var t=window.localStorage?localStorage.getItem(this._cookieName):void 0;this._uri=t&&t.length>0?t:"/"}return this._container=$(this.getTreeId()).up(1),this.tree=new dynamicTree.createRepositoryTree(this.getTreeId(),{providerId:"repositoryExplorerTreeFoldersProvider",rootUri:repositorySearch.model.getRootFolderUri(),organizationId:e.organizationId,publicFolderUri:e.publicFolderUri,urlGetNode:"flow.html?_flowId=searchFlow&method=getNode",urlGetChildren:"flow.html?_flowId=searchFlow&method=getChildren",dragPattern:".draggable",selectOnMousedown:!1}),disableSelectionWithoutCursorStyle($(this.getTreeId()).up(1)),this.tree.observe("key:contextMenu",function(e){var t=e.memo.node,o=getBoxOffsets(t,!0);repositorySearch.actionModel.showFolderMenu(e,{menuLeft:o[0]+100,menuTop:o[1]+20}),Event.stop(e)}),this.tree.observe("key:escape",function(e){actionModel.hideMenu(),Event.stop(e)}),this.tree.observe("tree:mouseover",function(e){this.tree._overNode=e.memo.node}.bindAsEventListener(this)),this.tree.observe("tree:mouseout",function(e){this.tree.refreshDropTarget(!1),this.tree._overNode==e.memo.node&&(this.tree._overNode=null)}.bindAsEventListener(this)),this.tree.setDragStartState=function(e,t,o){dynamicTree.Tree.prototype.setDragStartState.call(this,e,t,o);var r=new Folder(e);isMetaHeld(o,!0)?(canFolderBeCopied(r)&&invokeFolderAction("CopyFolder",r),$(document.body).addClassName(layoutModule.COPY_CLASS)):canFolderBeMoved(r)&&invokeFolderAction("MoveFolder",r)},this.tree.setDragEndState=function(e,t,o){repositorySearch.CopyMoveController.cancel(),this.refreshDropTarget(!1),$(document.body).removeClassName(layoutModule.COPY_CLASS),dynamicTree.Tree.prototype.setDragEndState.call(this,e,t,o)},this.tree.refreshDropTarget=function(e){this._overNode&&(this._overNode.isDropTarget=e,this._overNode.refreshStyle())},Droppables.remove(this.getTreeId()),Droppables.add(this.getTreeId(),{accept:["dragging","wrap"],onHover:function(e,t,o){if(this.tree._overNode){var r=new Folder(this.tree._overNode),i=e.node&&canFolderBeCopiedOrMovedToFolder(r)||e.items&&canAllBeCopiedOrMovedToFolder(r);this.tree.refreshDropTarget(i)}}.bind(this),onDrop:function(e,t,o){var r;if(Draggables.supportsTouch){var i=o.changedTouches[0];r=this.tree.getTreeNodeByElement($(document.elementFromPoint(i.pageX,i.pageY)))}else r=this.tree.getTreeNodeByEvent(o);if(r&&(this.tree._overNode=r),this.tree._overNode){var n=new Folder(this.tree._overNode);e.node&&canFolderBeCopiedOrMovedToFolder(n)&&invokeFolderAction("PasteFolder",n),e.items&&canAllBeCopiedOrMovedToFolder(n)&&invokeFolderAction("PasteResources",n)}}.bind(this)}),this.tree.observe("server:error",function(){window.console&&alert("Tree load error.")}),this.tree.observe("childredPrefetched:loaded",function(e){this.tree.openAndSelectNode(this._uri)}.bindAsEventListener(this)),this.tree.observe("tree:loaded",function(e){this._canDoBrowse=!1,"/"==this._uri?this.tree.rootNode.select():this.tree.openAndSelectNode(this._uri),this._canDoBrowse=!0;var t=this.tree.getSelectedNode();t&&t.scroll($(this._treeId).parentNode),this.doBrowse()}.bindAsEventListener(this)),this.tree.observe("node:selected",function(e){this._uri=e.memo.node.param.uri,window.localStorage&&localStorage.setItem(this._cookieName,this._uri),repositorySearch.model.setSelectedFolder(new Folder(e.memo.node)),this.doBrowse()}.bindAsEventListener(this)),this.tree.observe("node:mouseup",function(e){repositorySearch.model.setContextFolder(new Folder(e.memo.node))}),this.tree.showTreePrefetchNodes(this._uri),this},doBrowse:function(){this._canDoBrowse&&repositorySearch.fire(repositorySearch.Event.SEARCH_BROWSE,{uri:this._uri})},getSelectedUri:function(){return this._uri},getTreeId:function(){return this._treeId},selectFolder:function(e){this.tree.openAndSelectNode(e.URI)},reselectFolder:function(e){e.node.isSelected()&&(e.node.deselect(),e.node.select())},refreshFolder:function(e){this.selectFolder(e),this.updateSubFolders(e)},updateFolder:function(e,t,o){e.label=t,e.description=o,e.node.changeName(e.label),e.node.param.extra.desc=e.description,this.tree.resortSubtree(e.node.parent),e.node.parent.refreshNode()},updateSubFolders:function(e){e.node.hasChilds()||e.node.setHasChilds(!0),e.node.isOpen()&&e.node.handleNode(),e.node.isloaded=!1,e.node.handleNode()},isFolderContextMenu:function(e){return this.tree.getTreeNodeByEvent(e)&&!this.tree.isIconEvent(e)},moveOrCopyFolder:function(e,t,o){var r=e.getParentFolder().node;return o||r.removeChild(e.node),this.tree.getTreeNodeChildren(t.node,function(t){if(t){var o=t.detect(function(t){return t.param.id==e.name});o&&this.tree.openAndSelectNode(o.param.uri)}}.bind(this))}},repositorySearch.resultsPanel={_list:null,_infiniteScroll:null,_resultListHeaderId:"resultsListHeader",_resultListId:"resultsList",_resultsContainerId:"resultsContainer",_touchScroller:null,_folderDisplayPathCache:{},NOTHING_TO_DISPLAY_ID:"nothingToDisplay",RESOURCE_NAME_TOOLTIP_ID:"resourceNameTooltip",NAME_PATTERN:".resourceName",LINK_NAME_PATTERN:".resourceName > a",DISCLOSURE_PATTERN:".disclosure",SCHEDULED_PATTERN:".scheduled",LOADING_CLASS_NAME:"loading",initialize:function(e){var t=this;return this._container=$(this._resultListId).up(),this._header=$(this._resultListHeaderId),this._list=new dynamicList.List(this._resultListId,{listTemplateDomId:"tabular_fourColumn_resources",itemTemplateDomId:"tabular_fourColumn_resources:leaf",dragPattern:e.enableDnD?".draggable":"",multiSelect:!0,selectOnMousedown:!isIPad()}),this._intiListEvents(),this._initDnD(),this.getList().show(),isSupportsTouch()&&(this._touchController=new TouchController(document.getElementById(this._resultListId),document.getElementById(this._resultsContainerId),{scrollbars:!0}),jQuery("#"+this._resultListId).on("layout_update orientationchange",function(){jQuery("#"+t._resultListId).css("min-width",jQuery("#"+t._resultsContainerId).width()+"px"),jQuery("#"+t._resultListId).width(jQuery("#"+t._resultsContainerId).width())})),isIPad()?this._infiniteScroll=new InfiniteScroll({id:this._container.identify(),contentId:this._resultListId,scroll:this._touchController}):this._infiniteScroll=new InfiniteScroll({id:this._container.identify(),contentId:this._resultListId}),this._infiniteScroll.onLoad=function(){repositorySearch.fire(repositorySearch.Event.SEARCH_NEXT)},disableSelectionWithoutCursorStyle(this._container),Event.observe($(window),"resize",function(){this.refresh()}.bind(this)),this._fixHeaderWidth(),this},_fixHeaderWidth:function(){isIPad()||this._header.setStyle({marginRight:this._container.getWidth()-$(this._resultListId).getWidth()+"px"})},_createResourceItem:function(e){var t;e.hasChildren?(t=new dynamicList.CompositeItem({cssClassName:layoutModule.NODE_CLASS,label:e.label,value:e,openHandlerPattern:".disclosure.icon",closeHandlerPattern:".disclosure.icon",excludeFromSelectionTriggers:[".disclosure.icon"],listOptions:{listTemplateDomId:"tabular_fourColumn_resources_sublist",itemTemplateDomId:"tabular_fourColumn_resources_sublist:leaf",multiSelect:!0}}),t.setLoading=function(e){this.isLoading=e,this.refreshStyle(),repositorySearch.resultsPanel.refresh()}):t=new dynamicList.ListItem({cssClassName:layoutModule.LEAF_CLASS,label:e.label,value:e}),t.processTemplate=function(e){var t=canBeRun(this.getValue())||canBeOpened(this.getValue()),o=t?repositorySearch.resultsPanel.LINK_NAME_PATTERN:repositorySearch.resultsPanel.NAME_PATTERN,r=e.select(o)[0],i=e.select(repositorySearch.resultsPanel.NAME_PATTERN)[0],n=e.select(".resourceDescription")[0];r.update(xssUtil.escape(this.getValue().label));var s=this;new JSTooltip(i,{text:[xssUtil.escape(this.getValue().label),xssUtil.escape(repositorySearch.messages.loading)],templateId:repositorySearch.resultsPanel.RESOURCE_NAME_TOOLTIP_ID,loadTextCallback:function(e){function t(e,t){var o=repositorySearch.model.getFolderSeparator();return e===o?e+t:e+o+t}function o(o,i,n){i=xssUtil.escape(i),r=xssUtil.escape(t(o,n)),e.updateText([i,r])}var r,i=s.getValue().parentFolder,n=repositorySearch.resultsPanel._folderDisplayPathCache[i];if(n)o(n,s.getValue().label,s.getValue().name);else{var a=new repositorySearch.ServerAction(repositorySearch.InfoAction.GET_DISPLAY_PATH,{data:{resourceUri:i,isFolder:!0}});a.onSuccess=function(e){repositorySearch.resultsPanel._folderDisplayPathCache[i]=e,o(e,s.getValue().label,s.getValue().name)},a.onError=repositorySearch.defaultErrorHandler,a.invokeAction()}}});var a=this.getValue().description;n.update(xssUtil.escape(a)),a?new JSTooltip(n,{text:a}):n.jsTooltip&&n.jsTooltip.disable();var d=e.select(".resourceType")[0],l=e.select(".modifiedDate")[0],c=e.select(".createdDate")[0];return d.update(this.getValue().type),l.update(this.getValue().updateDate),new JSTooltip(l,{text:this.getValue().updateDateTime}),c.update(this.getValue().date),new JSTooltip(c,{text:this.getValue().dateTime}),e};var o=t.refreshStyle;return t.refreshStyle=function(){o.call(this);var e=this._getElement();this.getValue().isScheduled&&e.addClassName(layoutModule.SCHEDULED_CLASS),this.isLoading&&e.addClassName(layoutModule.LOADING_CLASS)},t},_initDnD:function(){var e=this.getList();e.setDragStartState=function(e,t,o){dynamicList.List.prototype.setDragStartState.call(this,e,t,o),isMetaHeld(o,!0)&&$(document.body).addClassName(layoutModule.COPY_CLASS).setStyle({cursor:null}),invokeBulkAction(isMetaHeld(o,!0)?"Copy":"Move")},e.setDragEndState=function(e,t,o){repositorySearch.CopyMoveController.cancel(),repositorySearch.foldersPanel.tree.refreshDropTarget(!1),$(document.body).removeClassName(layoutModule.COPY_CLASS),dynamicList.List.prototype.setDragEndState.call(this,e,t,o)}},_intiListEvents:function(){this.getList().observe("item:click",function(e){var t=e.memo.item,o=e.memo.targetEvent,r=t.getValue();this._isLinkEvent(o)&&(canBeRun(r)?invokeRedirectAction("RunResourceAction"):canBeOpened(r)&&invokeRedirectAction("OpenResourceAction")),this._isScheduleIconEvent(o)&&canBeScheduled(r)&&invokeRedirectAction("ScheduleAction")}.bindAsEventListener(this)),this.getList().observe("item:selected",function(e){var t=(e.memo.item,this.getList().getSelectedItems().collect(function(e){return e.getValue()}));repositorySearch.model.setSelectedResources(t),repositorySearch.actionModel.refreshToolbar()}.bindAsEventListener(this)),this.getList().observe("item:unselected",function(e){var t=(e.memo.item,this.getList().getSelectedItems().collect(function(e){return e.getValue()}));repositorySearch.model.setSelectedResources(t),repositorySearch.actionModel.refreshToolbar()}.bindAsEventListener(this)),this.getList().observe("item:mouseup",function(e){}),this.getList().observe("item:open",function(e){var t=e.memo.item,o=t.getValue();o.isLoaded()||(t.setLoading(!0),repositorySearch.fire(repositorySearch.Event.SEARCH_CHILDREN,{resource:o,item:t})),this.refresh()}.bindAsEventListener(this)),this.getList().observe("item:closed",function(e){this.refresh()}.bindAsEventListener(this)),this.getList().observe("key:contextMenu",function(e){var t=e.memo.node,o=getBoxOffsets(t,!0),r={menuLeft:o[0]+100,menuTop:o[1]+20};this.getList().getSelectedItems().length>1?repositorySearch.actionModel.showResourceBulkMenu(e,r):repositorySearch.actionModel.showResourceMenu(e,r),Event.stop(e)}.bindAsEventListener(this)),this.getList().observe("key:escape",function(e){actionModel.hideMenu(),Event.stop(e)})},_isLinkEvent:function(e){var t=Event.element(e);return null!=matchAny(t,[this.LINK_NAME_PATTERN])},_isScheduleIconEvent:function(e){var t=Event.element(e);return t.match(this.SCHEDULED_PATTERN)},_isDisclosureEvent:function(e){var t=Event.element(e);return null!=matchAny(t,[this.DISCLOSURE_PATTERN])},_refreshEmptyListMessage:function(){var e=$(this.NOTHING_TO_DISPLAY_ID);0===this._list.getItems().length?(e.removeClassName(layoutModule.HIDDEN_CLASS),centerElement(e,{horz:!0,vert:!0})):e.addClassName(layoutModule.HIDDEN_CLASS)},getList:function(){return this._list},removeResources:function(e){var t=e.findAll(function(e){return e.isChild}),o=e.findAll(function(e){return!e.isChild}),r=this.getList().getItems(),i=[],n=[];r.each(function(e){e.isComposite&&n.push(e),o.include(e.getValue())&&i.push(e)}),n.each(function(e){e.getItems()&&e.removeItems(e.getItems().findAll(function(e){return t.include(e.getValue())}))}),this.getList().removeItems(i),this._refreshEmptyListMessage(),this.refresh()},setResources:function(e,t){var o=e.collect(this._createResourceItem);t?(t.setItems(o),t.refresh()):(this._infiniteScroll&&this._infiniteScroll.reset(),this.getList().setItems(o),this.getList().show(),this._refreshEmptyListMessage()),this.refresh(),this._infiniteScroll.stopWaiting()},addResources:function(e){var t=e.collect(this._createResourceItem);this.getList().addItems(t),this.getList().refresh(),
this.refresh(),this._infiniteScroll.stopWaiting()},isResourceContextMenu:function(e){return this.getList().getItemByEvent(e)},updateResource:function(e){var t=this.getList().getItems();t.each(function(t){t.getValue().URIString==e.URIString&&(t.setValue(e),t.refresh(),this.getList().isItemSelected(t)&&this.getList().selectItem(t))}.bind(this))},findResource:function(e){var t=this.getList().getItems(),o=t.detect(function(t){return t.getValue().URIString===e});return o?o.getValue():null},refresh:function(){this._fixHeaderWidth(),tooltipModule.cleanUp()}},repositorySearch.filtersPanel={_id:"filtersPanel",_container:void 0,_filtersLists:{},_cookieName:"filtersPopularity",_ignoreFilterEvent:!1,initialize:function(e,t){this._getContainer().update(),e.each(function(e,t){this._getContainer().insert(new Element("ul",{id:e.id,"data-tab-index":5+t,"data-component-type":"list"}));var o=this._createFiltersList(e.id,e);o.show(),this._filtersLists[e.id]=o}.bind(this));for(var o in t)this.select(o,t[o]);return isSupportsTouch()&&(this._touchController=new TouchController(document.getElementById(this._id),$(this._id).up())),this},_refreshScroll:function(){var e=layoutModule.scrolls.get(this._id);e&&e.refresh()},_createItemsList:function(e){var t=e.options,o=0,r=t.collect(function(e){return new dynamicList.ListItem({value:e,cssClassName:layoutModule.LEAF_CLASS,label:repositorySearch.getMessage(e.labelId)})}).partition(function(){return o++,-1===e.showCount||e.showCount>o});return r[1].length>0&&r[0].push(new dynamicList.CompositeItem({value:{isMore:!0},templateDomId:"list_responsive_filters:node",openUp:!0,openHandlerPattern:".more.launcher",closeHandlerPattern:".fewer.launcher",respondOnItemEvents:!1,items:r[1]})),r[0]},_createFiltersList:function(e,t){var o=new dynamicList.List(e,{listTemplateDomId:"list_responsive_filters",itemTemplateDomId:"list_responsive_filters:leaf",items:this._createItemsList(t)});return o.addItems([new dynamicList.CompositeItem({templateDomId:"list_responsive_filters:separator",respondOnItemEvents:!1,value:{isSeparator:!0}})].compact()),o.observe("item:selected",function(e){var t=e.memo.item;t.getValue().isSeparator||t.getValue().isMore||this._ignoreFilterEvent||repositorySearch.fire(repositorySearch.Event.SEARCH_FILTER,{filterId:o.getId(),optionId:t.getValue().id})}.bindAsEventListener(this)),o},select:function(e,t,o){var r=this._filtersLists[e],i=function(e){if(e.getValue().id==t)throw e.isSelected()||(this._ignoreFilterEvent=o,e.select(),this._ignoreFilterEvent=!1),$break;if(e.isComposite){var r=e._getElement();baseList.isItemOpen(r)||baseList.openItem(r),e.getItems()&&e.getItems().each(i)}}.bind(this);r.getItems().each(i)},_getContainer:function(){return this._container||(this._container=$(this._id),this._container.hasClassName(layoutModule.SWIPE_SCROLL_PATTERN)&&(this._container=this._container.down())),this._container}},repositorySearch.filterPath={_containerId:"filterPath",_contentBodySelector:".primary.column>.content>.body",initialize:function(){return this._filterPathList=new dynamicList.List(this._containerId,{listTemplateDomId:"list_control_path",itemTemplateDomId:"list_control_path:step"}),this._filterPathList.observe("item:selected",function(e){var t=e.memo.item;t.getValue().isLast||repositorySearch.fire(repositorySearch.Event.SEARCH_ROLLBACK,{position:t.getValue().position})}),this},setPathItems:function(e){if(e.length>1){var t=e.length-1,o=e.collect(function(e,o){return e.isLast=o==t,new dynamicList.ListItem({label:e.label,value:e})});this._filterPathList.setItems(o),this._filterPathList.show(),$(this._containerId).up().removeClassName("hidden"),$(document.body).select(this._contentBodySelector)[0].addClassName("showingSubHeader")}else this._filterPathList.setItems([]),this._filterPathList.show(),$(this._containerId).up().addClassName("hidden"),$(document.body).select(this._contentBodySelector)[0].removeClassName("showingSubHeader")}},repositorySearch.sortersPanel={_LABEL_TEMPLATE_DOM_ID:"sortPanelLabelTemplate",_containerId:"sortMode",_ignoreSortEvent:!1,sortersList:null,initialize:function(e,t){var o=new dynamicList.ListItem({label:repositorySearch.getMessage("SEARCH_SORT_BY")+":",value:{isLabel:!0},templateDomId:"tabSet_control_horizontal_responsive:label",respondOnItemEvents:!1}),r=e.collect(function(e,t){return new dynamicList.ListItem({label:repositorySearch.getMessage(e.labelId),value:e})});return this.sortersList=new dynamicList.List(this._containerId,{listTemplateDomId:"tabSet_control_horizontal_responsive",itemTemplateDomId:"tabSet_control_horizontal_responsive:tab",items:[o].concat(r)}),this.sortersList.observe(this.sortersList.Event.ITEM_SELECTED,function(e){var t=e.memo.item;t.getValue().isLabel||this._ignoreSortEvent||repositorySearch.fire(repositorySearch.Event.SEARCH_SORT,{sorterId:t.getValue().id})}),this.sortersList.show(),o.disable(),this.select(t),this},select:function(e,t){this.sortersList.getItems().each(function(o){return o.getValue().id!=e||o.isSelected()?void 0:(this._ignoreSortEvent=t,this.sortersList.selectItem(o),void(this._ignoreSortEvent=!1))}.bind(this))},_getContainer:function(){return this._container||(this._container=$(this._containerId)),this._container},_getLabelTemplate:function(){var e=$(this._LABEL_TEMPLATE_DOM_ID).cloneNode(!0);return e.removeAttribute("id"),e}};var ResourcePermissions=function(e){this._resource=e,this._isVisible=!1,this._listId=this.ENTITY_LIST_ID,this._listContainerId=this.LIST_CONTAINER_ID,this._searchBoxId=this.SEARCH_BOX_ID,this.viewBy="USER",this._processTemplate()};ResourcePermissions.addVar("TEMPLATE_DOM_ID","permissions"),ResourcePermissions.addVar("TOOLTIP_TEMPLATE_DOM_ID","orgTooltip"),ResourcePermissions.addVar("LIST_TEMPLATE_ID","tabular_twoColumn_setLeft"),ResourcePermissions.addVar("ITEM_TEMPLATE_ID","tabular_twoColumn_setLeft:leaf"),ResourcePermissions.addVar("WAIT_ITEM_TEMPLATE_ID","tabular_twoColumn_setLeft:loading"),ResourcePermissions.addVar("ENTITY_LIST_ID","permissionsList"),ResourcePermissions.addVar("LIST_CONTAINER_ID","permissionsListContainer"),ResourcePermissions.addVar("SEARCH_BOX_ID","searchPermissionsBox"),ResourcePermissions.addVar("NAME_TOOLTIP_PATTERN",".one"),ResourcePermissions.addVar("NAME_PATTERN",".one>a.launcher"),ResourcePermissions.addVar("PERMISSIONS_PATTERN",".two>select"),ResourcePermissions.addVar("VIEW_BY_TAB_SET_PATTERN","#permissionsViewBy"),ResourcePermissions.addVar("TAB_PATTERN",".tab>p"),ResourcePermissions.addVar("PATH_PATTERN",".path"),ResourcePermissions.addVar("SUBMIT_BUTTON","#permissionsOk"),ResourcePermissions.addVar("APPLAY_BUTTON","#permissionsApply"),ResourcePermissions.addVar("CANCEL_BUTTON","#permissionsCancel"),ResourcePermissions.addVar("BODY_PATTERN","div.body"),ResourcePermissions.addMethod("_processTemplate",function(){this._dom=$(this.TEMPLATE_DOM_ID).cloneNode(!0),this._dom.writeAttribute("id",null),this._dom.down(".body").writeAttribute("id","");var e=this._dom.select(this.PATH_PATTERN)[0];e.update(xssUtil.escape(this._resource.URIString.truncate(50))),e.writeAttribute("title",this._resource.URIString),this._viewByTabSet=this._dom.select(this.VIEW_BY_TAB_SET_PATTERN)[0],this._byUsersButton=this._dom.select(this.TAB_PATTERN)[0],this._byRolesButton=this._dom.select(this.TAB_PATTERN)[1],this._submitButton=this._dom.select(this.SUBMIT_BUTTON)[0],this._applyButton=this._dom.select(this.APPLAY_BUTTON)[0],this._cancelButton=this._dom.select(this.CANCEL_BUTTON)[0],this._byUsersButton.viewType="USER",this._byRolesButton.viewType="ROLE",this._submitButton.writeAttribute("id",null),this._applyButton.writeAttribute("id",null),this._cancelButton.writeAttribute("id",null);var t=this._dom.select("#"+this.ENTITY_LIST_ID)[0],o=this._dom.select("#"+this.LIST_CONTAINER_ID)[0],r=this._dom.select("#"+this.SEARCH_BOX_ID)[0];this._listId=t.writeAttribute("id",null).identify(),this._listContainerId=o.writeAttribute("id",null).identify(),this._searchBoxId=r.writeAttribute("id",null).identify()}),ResourcePermissions.addMethod("_updateValueAndLabel",function(e,t,o,r){var i=e.select(t)[0];return i.writeAttribute("id",null),i.setValue(o),e.select(r)[0].writeAttribute("for",i.identify()),i}),ResourcePermissions.addMethod("_updateContentAndLabel",function(e,t,o,r){var i=e.select(t)[0];return i.writeAttribute("id",null),i.update(o),e.select(r)[0].writeAttribute("for",i.identify()),i}),ResourcePermissions.addMethod("_buttonClickHandler",function(e){var t=e.element();if(!this._waiting){var o=matchAny(t,[layoutModule.BUTTON_PATTERN],!0),r=this._resource.URIString;[this._submitButton,this._applyButton].include(o)&&(this._byUsersButton.addClassName(layoutModule.BUTTON_CLASS),this._byRolesButton.addClassName(layoutModule.BUTTON_CLASS),repositorySearch.fire(repositorySearch.PermissionEvent.UPDATE,{uri:r,entities:this.getChangedEntities(),finishEdit:o==this._submitButton})),[this._byUsersButton,this._byRolesButton].include(o)&&(this.isChanged()?(this._showWarning(),e.stop()):(this._hideWarning(),this.viewBy=o.viewType,repositorySearch.fire(repositorySearch.PermissionEvent.BROWSE,{uri:r,type:this.viewBy}))),[this._cancelButton].include(o)&&this.hide()}}),ResourcePermissions.addMethod("_showWarning",function(){this._dom.select(this.BODY_PATTERN)[0].addClassName(layoutModule.ERROR_CLASS)}),ResourcePermissions.addMethod("_hideWarning",function(){this._dom.select(this.BODY_PATTERN)[0].removeClassName(layoutModule.ERROR_CLASS)}),ResourcePermissions.addMethod("_launcherClickHandler",function(e){var t=e.element();if(!this._waiting){var o=matchAny(t,[this.NAME_PATTERN],!0);if(o){var r=t.up("li");if(r&&r.listItem){var i=r.listItem.getValue();i.navigateToManager()}}}e.stop()}),ResourcePermissions.addMethod("_selectChangeHandler",function(e){var t=e.element();if(e.stop(),!this._waiting){if("select"==t.tagName.toLowerCase()){var o=t.options[t.selectedIndex].value,r=t.up("li");if(r&&r.listItem){var i=r.listItem.getValue();r.listItem.getValue().permission.newPermission=o!=i.permission.getResolvedPermission()?o:void 0,r.listItem.refresh()}}this.isChanged()?(this._byUsersButton.removeClassName(layoutModule.BUTTON_CLASS),this._byRolesButton.removeClassName(layoutModule.BUTTON_CLASS)):(this._byUsersButton.addClassName(layoutModule.BUTTON_CLASS),this._byRolesButton.addClassName(layoutModule.BUTTON_CLASS))}}),ResourcePermissions.addMethod("_selectMouseOverHandler",function(e){var t=matchAny(e.element(),[this.PERMISSIONS_PATTERN],!0);t&&e.stop()}),ResourcePermissions.addMethod("_initControls",function(){this.list=new dynamicList.List(this._listId,{listTemplateDomId:this.LIST_TEMPLATE_ID,itemTemplateDomId:this.ITEM_TEMPLATE_ID});var e=$(this._listId).up();isSupportsTouch()&&(this._touchController||(this._touchController=new TouchController($(this._listId),$(this._listId).up(),{forceLayout:!0}))),this._infiniteScroll=new InfiniteScroll({id:e.identify(),contentId:this._listId,scroll:this._touchController||void 0}),this._searchBox=new SearchBox({id:this._searchBoxId});var t=this._resource.URIString;this._infiniteScroll.onLoad=function(){this._waiting||repositorySearch.fire(repositorySearch.PermissionEvent.NEXT,{text:this._searchBox.getText(),uri:t,type:this.viewBy})}.bind(this),this._searchBox.onSearch=function(e){this._waiting||(this.isChanged()?this._showWarning():(this._hideWarning(),repositorySearch.fire(repositorySearch.PermissionEvent.SEARCH,{text:e,uri:t,type:this.viewBy})))}.bind(this)}),ResourcePermissions.addMethod("show",function(){this._isVisible||(document.body.insert(this._dom),this._initControls(),this.list.setItems([]),this.list.show(),orgModule.entityList._createEntityItem=this._createEntityItem,this.viewBy="ROLE",repositorySearch.fire(repositorySearch.PermissionEvent.BROWSE,{initialize:!0,uri:this._resource.URIString,type:this.viewBy,isFolder:this._resource.isFolder()}),this._isVisible=!0,document.getElementById(this._listId).parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.style.height="360px",dialogs.popup.show(this._dom),this._dom.observe("click",this._buttonClickHandler.bindAsEventListener(this)),isSupportsTouch()&&this._viewByTabSet.observe("touchstart",this._buttonClickHandler.bindAsEventListener(this)),this._dom.observe("click",this._launcherClickHandler.bindAsEventListener(this)),this._dom.observe("mouseover",this._selectMouseOverHandler.bindAsEventListener(this)))}),ResourcePermissions.addMethod("showAndWait",function(){this._isVisible||(this._waiting=!0,this.show(),this._waitingItem=new dynamicList.ListItem({templateDomId:this.WAIT_ITEM_TEMPLATE_ID}),this.list.addItems([this._waitingItem]),this.list.refresh(),this.disable())}),ResourcePermissions.addMethod("stopWaiting",function(){this._waiting&&(this._waiting=!1,this.list.removeItems([this._waitingItem]),this.enable())}),ResourcePermissions.addMethod("hide",function(){dialogs.popup.hide(this._dom),this._dom.remove(),this._dom.stopObserving("click"),this._dom.stopObserving("change"),this._dom.stopObserving("mouseover"),isSupportsTouch()&&this._viewByTabSet.stopObserving("touchstart"),repositorySearch.dialogsPool.removePermissionsDialog(this._resource)}),ResourcePermissions.addMethod("enable",function(){this._searchBox.enable(),buttonManager.enable(this._byUsersButton),buttonManager.enable(this._byRolesButton)}),ResourcePermissions.addMethod("disable",function(){this._searchBox.disable(),buttonManager.disable(this._byUsersButton),buttonManager.disable(this._byRolesButton)}),ResourcePermissions.addMethod("_createItem",function(e){var t=new dynamicList.ListItem({label:e.getDisplayName(),value:e}),o=this.NAME_TOOLTIP_PATTERN,r=this.NAME_PATTERN,i=this.PERMISSIONS_PATTERN,n=this.TOOLTIP_TEMPLATE_DOM_ID,s=this;return t.processTemplate=function(e){var t=e.select(o)[0],a=e.select(r)[0],d=e.select(i)[0],l=this.getValue().permission,c=this.getValue().tenantId;if(l.newPermission?a.addClassName(layoutModule.EMPHASIS_CLASS):a.removeClassName(layoutModule.EMPHASIS_CLASS),a.update(xssUtil.escape(this.getValue().getDisplayName())),c&&c.length>0){new JSTooltip(t,{text:xssUtil.escape(c),templateId:n});var h=e.remove;e.remove=function(){tooltipModule.hideJSTooltip(t),tooltipModule.cleanUp(),h.apply(this)}}d.update("");for(var u=0,p=repositorySearch.model.getConfiguration().permissions,m=0;m<p.length;m++){var f=repositorySearch.getMessage(p[m].labelId),g=new Element("option",{value:p[m].name});d.insert(g.update(l.inheritedPermission==p[m].name?xssUtil.escape(f+" *"):xssUtil.escape(f))),l.newPermission?l.newPermission==p[m].name&&(u=m):l.getResolvedPermission()==p[m].name&&(u=m)}return d.observe("change",s._selectChangeHandler.bindAsEventListener(s)),d.selectedIndex=u,this.getValue().permission.isDisabled&&d.writeAttribute("disabled","disabled"),e},t}),ResourcePermissions.addMethod("addEntities",function(e){var t=e.collect(this._createItem.bind(this));this.list.addItems(t),this.list.refresh(),this._infiniteScroll.stopWaiting()}),ResourcePermissions.addMethod("resetList",function(e){var t=jQuery("#"+e);t.find("[js-nonmodal-tabindex]").removeAttr("js-nonmodal-tabindex"),t.find("[js-navtype]").attr("js-navtype",!1),t.find("[tabindex]").removeAttr("tabindex")}),ResourcePermissions.addMethod("scrollReset",function(){var e=this._listId,t=this.resetList,o=jQuery("#"+this._listContainerId).find(".content").find(".body");o.on("scroll",_.debounce(function(){t(e)},100))}),ResourcePermissions.addMethod("setEntities",function(e){this.list.setItems([]),this._touchController&&this._touchController.reset(),this.addEntities(e),this.resetList(this._listId),this.scrollReset()}),ResourcePermissions.addMethod("getChangedEntities",function(){var e=this.list.getItems(),t=[];return e.each(function(e){var o=e.getValue();o.permission&&o.permission.newPermission&&t.push(o)}),t}),ResourcePermissions.addMethod("updateEntities",function(e){var t=this.list.getItems();t.each(function(t){var o=t.getValue(),r=e.detect(function(e){return e.equals(o)});r&&(t.setValue(r),t.refresh())})}),ResourcePermissions.addMethod("isChanged",function(){return this.getChangedEntities().length>0}),repositorySearch.dialogsPool={POOL_NOT_FOUND_EXCEPTION:"PoolNotFoundException",DIALOD_EXIST_EXCEPTION:"DialodExistException",NULL_RESOURCE_EXCEPTION:"NullResourceException",_permissionsDialogPool:{},_propertiesDialogPool:{},_getPool:function(e){var t;if(e==ResourcePermissions&&(t=this._permissionsDialogPool),e==ResourceProperties&&(t=this._propertiesDialogPool),t)return t;throw{name:this.POOL_NOT_FOUND_EXCEPTION,message:"Can't find pool for "+e.toString()}},_createDialog:function(e,t,o){var r=t.URIString,i=this._getPool(e);if(null==t)throw{name:this.NULL_RESOURCE_EXCEPTION,message:"Resource is null."};if(i[r])throw{name:this.DIALOD_EXIST_EXCEPTION,message:e.toString()+" dilaog for resource '"+r+"' arleady exist."};return i[r]=new e(t,o),i[r]},_createOrGetDialog:function(e,t,o){try{return this._createDialog(e,t,o)}catch(r){if(r.name==this.DIALOD_EXIST_EXCEPTION)return this._getDialog(e,t);throw r}},_getDialog:function(e,t){var o=Object.isString(t)?t:t.URIString;return this._getPool(e)[o]},_getAllDialogs:function(e){var t=this._getPool(e),o=[];for(var r in t)t[r]&&o.push(t[r]);return o},_removeDialog:function(e,t){var o=Object.isString(t)?t:t.URIString;this._getPool(e)[o]=void 0},createPermissionsDialog:function(e){return this._createDialog(ResourcePermissions,e)},createPropertiesDialog:function(e){return this._createDialog(ResourceProperties,e)},createOrGetPermissionsDialog:function(e){return this._createOrGetDialog(ResourcePermissions,e)},createOrGetPropertiesDialog:function(e,t){return this._createOrGetDialog(ResourceProperties,e,t)},getAllPermissionsDialogs:function(){return this._getAllDialogs(ResourcePermissions)},getAllPropertiesDialogs:function(){return this._getAllDialogs(ResourceProperties)},getPermissionsDialog:function(e){return this._getDialog(ResourcePermissions,e)},getPropertiesDialog:function(e){return this._getDialog(ResourceProperties,e)},removePermissionsDialog:function(e){return this._removeDialog(ResourcePermissions,e)},removePropertiesDialog:function(e){return this._removeDialog(ResourceProperties,e)}};var ResourceProperties=function(e,t){this._resource=e,this._changedCallback=t.changedCallback,this._showMode=t.showMode,this._processTemplate()};ResourceProperties.addVar("TEMPLATE_DOM_ID","propertiesResource"),ResourceProperties.addMethod("_processTemplate",function(){this._dom=$(this.TEMPLATE_DOM_ID).cloneNode(!0),this._dom.writeAttribute("id",null),this._dom.addClassName("_activeResourcePropertiesDialog");var e=this._dom.select(".title")[0];e.update(e.innerHTML.strip()+": "+xssUtil.escape(this._resource.label).truncate(50)),this._label=this._updateValueAndLabel(this._dom,"input#displayName",this._resource.label,'label[for="displayName"]'),this._description=this._updateContentAndLabel(this._dom,"textarea#description",xssUtil.escape(this._resource.description),'label[for="description"]'),this._path=this._updateValueAndLabel(this._dom,"input#path",xssUtil.escape(this._resource.URIString),'label[for="path"]'),this._showMode&&(this._dom.addClassName("showMode"),this._label.writeAttribute("readonly","readonly"),this._description.writeAttribute("readonly","readonly")),this._updateValueAndLabel(this._dom,"div#resourceID",xssUtil.escape(this._resource.name),'label[for="resourceID"]'),this._updateValueAndLabel(this._dom,"input#type",xssUtil.escape(this._resource.type),'label[for="type"]'),this._updateValueAndLabel(this._dom,"input#createdDate",xssUtil.escape(this._resource.date),'label[for="createdDate"]'),this._updateValueAndLabel(this._dom,"input#userAccess",xssUtil.escape(this._resource.permissionsToString()),'label[for="userAccess"]'),this._submitButton=this._dom.select("button.submit")[0],this._cancelButton=this._dom.select("button.cancel")[0],this._okButton=this._dom.select("button.ok")[0]}),ResourceProperties.addMethod("_updateValueAndLabel",function(e,t,o,r){var i=e.select(t)[0];return i.writeAttribute("id",null),i.writeAttribute("value",o),i.setValue?i.setValue(o):i.update(o),e.select(r)[0].writeAttribute("for",i.identify()),i}),ResourceProperties.addMethod("_updateContentAndLabel",function(e,t,o,r){var i=e.select(t)[0];return i.writeAttribute("id",null),i.update(o),e.select(r)[0].writeAttribute("for",i.identify()),i}),ResourceProperties.addMethod("_buttonClickHandler",function(e){var t=matchAny(e.element(),[layoutModule.BUTTON_PATTERN],!0);if(t==this._submitButton){if(this._showMode)this._hide();else if(this._isDataValid()){if(this._changedCallback){var o=this._resource.clone();o.label=this._label.getValue(),o.description=this._description.getValue(),this._changedCallback(o)}this._hide()}}else(t==this._cancelButton||t==this._okButton)&&this._hide()}),ResourceProperties.addMethod("_isDataValid",function(e){return ValidationModule.validate([{validator:ResourcesUtils.labelValidator,element:this._label},{validator:ResourcesUtils.descriptionValidator,element:this._description}])}),ResourceProperties.addMethod("show",function(e){document.body.insert(this._dom),e&&e.cascade?dialogs.popup.show(this._dom,!1,e):dialogs.popup.show(this._dom),this._dom.observe("click",this._buttonClickHandler.bindAsEventListener(this))}),ResourceProperties.addMethod("_hide",function(){dialogs.popup.hide(this._dom),this._dom.remove(),this._dom.stopObserving("click"),repositorySearch.dialogsPool.removePropertiesDialog(this._resource)}),ResourceProperties.addMethod("isChanged",function(){return this._resource.label!=this._label.getValue()||this._resource.description!=this._description.getValue()}),repositorySearch.showCreateFolderConfirm=function(e){var t,o=$("addFolder"),r=$("addFolderInputName"),i=$("addFolderInputDescription"),n=$("addFolderBtnAdd"),s=$("addFolderBtnCancel"),a=function(e){t=e,dialogs.popup.show(o),r.setValue(repositorySearch.messages["action.create.folder.name"]),accessibilityModule.disable(),setTimeout(function(){r.focus(),r.select()},500)},d=function(e){r.clear(),i.clear(),ValidationModule.hideError(r),ValidationModule.hideError(i),dialogs.popup.hide(o),accessibilityModule.enable(),e.stop()},l=function(){var e=ValidationModule.validate([{validator:ResourcesUtils.labelValidator,element:r},{validator:ResourcesUtils.descriptionValidator,element:i}]);return e},c=function(e){"disabled"!==n.readAttribute("disabled")&&(new repositorySearch.ServerAction.createFolderAction(repositorySearch.FolderAction.CREATE,{toFolder:t,label:r.getValue(),desc:i.getValue()}).invokeAction(),d(e))};n.observe("click",function(e){l()&&c(e),e.stop()}),s.observe("click",d),repositorySearch.showCreateFolderConfirm=a,a(e)},repositorySearch.DeleteConfirmation={ID_DELETE_DIALOG_CONTAINER:"standardConfirm",ID_DELETE_DIALOG_OK_BUTTON:"deleteResourceOK",ID_DELETE_DIALOG_CANCEL_BUTTON:"deleteResourceCancel"},repositorySearch.showDeleteFolderConfirm=function(e){var t=repositorySearch.getMessage("SEARCH_DELETE_FOLDER_CONFIRM_MSG",{folderUri:e.URI}),o=new repositorySearch.ServerAction.createFolderAction(repositorySearch.FolderAction.DELETE,{folder:e});repositorySearch._showDeleteDialog(t,o)},repositorySearch.showDeleteResourceConfirm=function(e){var t=repositorySearch.getMessage("SEARCH_DELETE_CONFIRM_MSG",{resourceUri:e.URIString}),o=new repositorySearch.ServerAction.createResourceAction(repositorySearch.ResourceAction.DELETE,{resources:[e]});repositorySearch._showDeleteDialog(t,o)},repositorySearch.showBulkDeleteResourcesConfirm=function(e){var t=repositorySearch.getMessage("SEARCH_BULK_DELETE_CONFIRM_MSG",{count:e.length}),o=new repositorySearch.ServerAction.createResourceAction(repositorySearch.ResourceAction.DELETE,{resources:e});repositorySearch._showDeleteDialog(t,o)},repositorySearch._showDeleteDialog=function(e,t){var o=$(repositorySearch.DeleteConfirmation.ID_DELETE_DIALOG_CONTAINER);o.down(".body").update(e),dialogs.popupConfirm.show(o,!0,{okButtonSelector:"#"+repositorySearch.DeleteConfirmation.ID_DELETE_DIALOG_OK_BUTTON,cancelButtonSelector:"#"+repositorySearch.DeleteConfirmation.ID_DELETE_DIALOG_CANCEL_BUTTON}),jQuery("#"+repositorySearch.DeleteConfirmation.ID_DELETE_DIALOG_OK_BUTTON).on("click",function(){t.invokeAction()})},repositorySearch.showResourceProperties=function(e,t){var o=repositorySearch.dialogsPool.createOrGetPropertiesDialog(e,{showMode:!0});o.show(t)},repositorySearch.editResourceProperties=function(e,t){var o=repositorySearch.dialogsPool.createOrGetPropertiesDialog(e,{changedCallback:function(e){var t=new repositorySearch.ServerAction.createResourceAction(repositorySearch.ResourceAction.UPDATE,{resource:e});t.invokeAction()}});o.show(t)},repositorySearch.showFolderProperties=function(e){var t=repositorySearch.dialogsPool.createOrGetPropertiesDialog(e,{showMode:!0});t.show()},repositorySearch.editFolderProperties=function(e){var t=repositorySearch.dialogsPool.createOrGetPropertiesDialog(e,{changedCallback:function(e){var t=new repositorySearch.ServerAction.createFolderAction(repositorySearch.FolderAction.UPDATE,{folder:e});t.invokeAction()}});t.show()},repositorySearch.editResourcePermissions=function(e){var t=repositorySearch.dialogsPool.createOrGetPermissionsDialog(e);t.showAndWait()},repositorySearch.editFolderPermissions=function(e){var t=repositorySearch.dialogsPool.createOrGetPermissionsDialog(e);t.showAndWait()},repositorySearch.showUploadThemeConfirm=function(e,t){var o,r,i=$("uploadTheme"),n=$("themeName"),s=$("themeZip"),a=$("uploadThemeBtnUpload"),d=$("uploadThemeBtnCancel"),l=function(e,t){o=e,r=t,dialogs.popup.show(i),n.removeAttribute("disabled"),n.setValue(repositorySearch.messages.RM_NEW_THEME_NAME),r&&(n.writeAttribute("disabled"),n.setValue(o.name)),n.select(),n.focus()},c=function(e){n.clear(),s.clear(),dialogs.popup.hide(i),e.stop()},h=function(){var e=ValidationModule.validate([{validator:ResourcesUtils.labelValidator,element:n},{validator:ResourcesUtils.zipFileTypeValidator,element:s}]);return e},u=function(e){var t={};if(t.themeName=n.getValue(),t._eventId="uploadTheme",t._flowExecutionKey=repositorySearch.flowExecutionKey,t.folderUri=o.URI,t.folderUri=o.URI,r){var i=o.URI;t.folderUri=i.slice(0,i.lastIndexOf("/")),t.reuploadAction=r,t._eventId="reuploadTheme"}var a=function(e){var i;if(s=$("themeZip"),e)try{if(i=e.evalJSON(),i&&"OK"==i.status){if(i.data.themeExist){var n=confirm(repositorySearch.messages.SEARCH_OVERWRITE_THEME_CONFIRM_MSG);if(n){var a=new repositorySearch.ServerAction.createFolderAction(repositorySearch.ThemeAction.REUPLOAD,t);a.invokeAction()}}else if(i.data.isActiveTheme){var d=i.data.themeUri,a=new repositorySearch.ServerAction.createFolderAction(repositorySearch.ThemeAction.SETTHEME,{folderUri:d});a.invokeAction()}}else i&&"ERROR"==i.status?alert(i.data):alert(repositorySearch.messages.RM_UPLOAD_THEME_ERROR)}catch(l){alert(l)}r&&i.data.isActiveTheme||repositorySearch.foldersPanel.refreshFolder(o)};fileSender.upload(s,"searchFlow",t,a),c(e)};a.observe("click",function(e){h()&&u(e),e.stop()}),d.observe("click",c),repositorySearch.showUploadThemeConfirm=l,l(e,t)};var GenerateResource=function(e,t){this._resource=e,this._callback=t.okCallback,this._processTemplate(t);var o=this;repositorySearch.observe("resource:generated",function(){o._hide()})};GenerateResource.addVar("TEMPLATE_DOM_ID","generateResource"),GenerateResource.addVar("TEMPLATE_TITLE_TEXT",!1),GenerateResource.addVar("LABEL_MAX_LEN",94),GenerateResource.addVar("DESC_MAX_LEN",200),GenerateResource.addMethod("_processTemplate",function(e){this._dom=$(this.TEMPLATE_DOM_ID);var t=this._dom.select(".title")[0];this.TEMPLATE_TITLE_TEXT||(GenerateResource.prototype.TEMPLATE_TITLE_TEXT=t.innerHTML.strip()),t.update(this.TEMPLATE_TITLE_TEXT+" "+xssUtil.escape(this._resource.label.truncate(50)));var o=e.useDefaultLabel?this._resource.label+" "+repositorySearch.messages["dialog.generateResource.defaultNameSuffix"]:"";this._nameInput=this._dom.select("#generateResourceInputName")[0],this._nameInput.setValue(o),this._descriptionInput=this._dom.select("#generateResourceInputDescription")[0],this._descriptionInput.setValue(this._resource.description),this._tree=dynamicTree.createRepositoryTree("generateResourceFoldersTree",{providerId:"repositorySaveReportProvider",rootUri:repositorySearch.model.getRootFolderUri(),organizationId:localContext.rsInitOptions.organizationId,publicFolderUri:localContext.rsInitOptions.publicFolderUri,urlGetNode:"flow.html?_flowId=searchFlow&method=getNode",urlGetChildren:"flow.html?_flowId=searchFlow&method=getChildren"}),this._cancelButton=this._dom.select("#generateResourceBtnCancel")[0],this._okButton=this._dom.select("#generateResourceBtnCreate")[0],this._okAndRunButton=this._dom.select("#generateResourceBtnCreateAndRun")[0]}),GenerateResource.addMethod("_buttonClickHandler",function(e){var t=matchAny(e.element(),[layoutModule.BUTTON_PATTERN],!0);if(t==this._okButton||t==this._okAndRunButton){var o=this._nameInput.getValue(),r=this._descriptionInput.getValue();if(o.length<=this.LABEL_MAX_LEN&&r.length<=this.DESC_MAX_LEN){var i=this._tree.getSelectedNode();i||alert(repositorySearch.messages.ADH_162_NULL_SAVE_REPORT_FOLDER_MESSAGE),i.param.extra&&!i.param.extra.isWritable&&this.showAccessDenied(i.param.uri),this._callback&&this._callback({label:o,description:r,location:i.param.uri,overwrite:!1,run:t==this._okAndRunButton})}else{var n,s;o.length>this.LABEL_MAX_LEN?(n=repositorySearch.messages.ADH_1001_ADHOC_SAVE_REPORT_LABEL_ERROR,s=this.LABEL_MAX_LEN):r.length>this.DESC_MAX_LEN&&(n=repositorySearch.messages.ADH_1001_ADHOC_SAVE_REPORT_DESCRIPTION_ERROR,s=this.DESC_MAX_LEN),n&&alert(n.replace("{0}",s))}}t==this._cancelButton&&this._hide()}),GenerateResource.addMethod("_focusName",function(){this._nameInput.select(),this._nameInput.focus()}),GenerateResource.addMethod("_enableSave",function(e){this._okButton.disabled=!e,this._okAndRunButton.disabled=!e}),GenerateResource.addMethod("show",function(){var e=this;this._tree.showTreePrefetchNodes("/",function(){e._focusName()}),this._dom.observe("click",this._buttonClickHandler.bindAsEventListener(this)),dialogs.popup.show(this._dom),setTimeout(function(){e._focusName()},500)}),GenerateResource.addMethod("showAccessDenied",function(e){var t=repositorySearch.messages.ADH_1001_SERVER_REPOSITORY_ACCESS_DENIED;alert(t.replace("{0}",e))}),GenerateResource.addMethod("_hide",function(){dialogs.popup.hide(this._dom),this._dom.stopObserving("click")}),window.require(["tenantImportExport/export/view/ExportDialogView","tenantImportExport/export/enum/exportTypesEnum"],function(e,t){repositorySearch.exportDialog=new e,repositorySearch.exportDialog.render({type:t.REPOSITORY})}),define("repository.search.components",["repository.search.main","prototype","underscore","utils.common","dynamicTree.utils","tools.infiniteScroll","tenantImportExport/export/view/ExportDialogView","tenantImportExport/export/enum/exportTypesEnum"],function(e){return function(){var t;return t||e.GenerateResource}}(this)),repositorySearch.Action=function(e){Object.isFunction(e)&&(this.invokeAction=e)},repositorySearch.Action.DEFAULT="default-action",repositorySearch.Action.addMethod("invokeAction",doNothing),repositorySearch.folderActionFactory={CreateFolder:function(e){return new repositorySearch.Action(function(){repositorySearch.showCreateFolderConfirm(e)})},CopyFolder:function(e){return new repositorySearch.Action(function(){repositorySearch.CopyMoveController.copy(e)})},MoveFolder:function(e){return new repositorySearch.Action(function(){repositorySearch.CopyMoveController.move(e)})},PasteFolder:function(e){return new repositorySearch.Action(function(){var t,o=e?e:repositorySearch.model.getContextFolder();repositorySearch.CopyMoveController.object;if(repositorySearch.CopyMoveController.isCopyFolder())t=repositorySearch.FolderAction.COPY;else{if(!repositorySearch.CopyMoveController.isMoveFolder())return;t=repositorySearch.FolderAction.MOVE}var r=new repositorySearch.ServerAction.createFolderAction(t,{toFolder:o,folder:repositorySearch.CopyMoveController.object});r.invokeAction()})},PasteResources:function(e){return new repositorySearch.Action(function(){var t,o=e?e:repositorySearch.model.getContextFolder();
o||(o=repositorySearch.model.getSelectedFolder());var r=repositorySearch.CopyMoveController.object,i=repositorySearch.CopyMoveController.isBulkAction()?[].concat(r):[r];if(repositorySearch.CopyMoveController.isCopyResource())t=repositorySearch.ResourceAction.COPY;else{if(!repositorySearch.CopyMoveController.isMoveResource())return;t=repositorySearch.ResourceAction.MOVE}for(var n=0;n<i.length;n++)if(i[n].parentResource){for(var s=i[n].parentResource.URI,a=!1,d=0;d<i.length&&!a;d++)a|=i[d].URI==s;a||i.push(i[n].parentResource)}var l=new repositorySearch.ServerAction.createResourceAction(t,{resources:i,folder:o});l.invokeAction()})},DeleteFolder:function(e){return new repositorySearch.Action(function(){actionModel.hideMenu(),repositorySearch.showDeleteFolderConfirm(e)})},ShowFolderProperties:function(e){return new repositorySearch.Action(function(){repositorySearch.showFolderProperties(e)})},EditFolderProperties:function(e){return new repositorySearch.Action(function(){repositorySearch.editFolderProperties(e)})},AssignPermissions:function(e){return new repositorySearch.Action(function(){repositorySearch.editFolderPermissions(e)})},SetActiveThemeFolder:function(e){return new repositorySearch.Action(function(){var t=new repositorySearch.ServerAction.createFolderAction(repositorySearch.ThemeAction.SETTHEME,{folder:e});t.invokeAction()})},DownloadTheme:function(e){return new repositorySearch.Action(function(){var t=new repositorySearch.ServerAction.createFolderAction(repositorySearch.ThemeAction.DOWNLOAD_THEME,{folder:e});t.initDownload()})},UploadTheme:function(e){return new repositorySearch.Action(function(){repositorySearch.showUploadThemeConfirm(e,!1)})},ReuploadTheme:function(e){return new repositorySearch.Action(function(){repositorySearch.showUploadThemeConfirm(e,!0)})},Export:function(e){return new repositorySearch.Action(function(){repositorySearch.exportDialog.openRepoDialog(e)})}},repositorySearch.resourceActionFactory={Copy:function(e){return new repositorySearch.Action(function(){repositorySearch.CopyMoveController.copy(e)})},Move:function(e){return new repositorySearch.Action(function(){repositorySearch.CopyMoveController.move(e)})},Delete:function(e){return new repositorySearch.Action(function(){actionModel.hideMenu(),repositorySearch.showDeleteResourceConfirm(e)})},Export:function(e,t){return new repositorySearch.Action(function(){repositorySearch.exportDialog.openRepoDialog(e)})},ShowProperties:function(e,t){return new repositorySearch.Action(function(){repositorySearch.showResourceProperties(e,t)})},EditProperties:function(e,t){return new repositorySearch.Action(function(){repositorySearch.editResourceProperties(e,t)})},AssignPermissionsToResourceAction:function(e){return new repositorySearch.Action(function(){repositorySearch.editResourcePermissions(e)})},GenerateResourceAction:function(e,t){return new repositorySearch.Action(function(){JRS.CreateReport.selectGenerator(e.URIString)})},ConvertResourceAction:function(e,t){return new repositorySearch.Action(function(){var t=new repositorySearch.ServerAction.createConvertAction(repositorySearch.ResourceAction.CONVERT,{reportUri:e.URIString});t.invokeAction()})}},repositorySearch.bulkActionFactory={Run:function(e){return new repositorySearch.Action(function(){e.each(function(e,t){var o=repositorySearch.RedirectAction.createRunResourceAction(e,0!==t);o.invokeAction()})})},Edit:function(e){return new repositorySearch.Action(function(){e.each(function(e,t){var o=repositorySearch.RedirectAction.createEditResourceAction(e,0!==t);o.invokeAction()})})},Open:function(e){return new repositorySearch.Action(function(){e.each(function(t,o){var r=repositorySearch.RedirectAction.createOpenResourceAction(t,e.length>1);r.invokeAction()})})},Copy:function(e){return new repositorySearch.Action(function(){repositorySearch.CopyMoveController.copy(e)})},Move:function(e){return new repositorySearch.Action(function(){repositorySearch.CopyMoveController.move(e)})},Delete:function(e){return new repositorySearch.Action(function(){actionModel.hideMenu(),1==e.length?repositorySearch.showDeleteResourceConfirm(e[0]):repositorySearch.showBulkDeleteResourcesConfirm(e)})},ShowProperties:function(e){return new repositorySearch.Action(function(){e.each(function(t,o){invokeResourceAction("ShowProperties",t,{cascade:!0,position:o,number:e.length})})})},EditProperties:function(e){return new repositorySearch.Action(function(){e.each(function(t,o){invokeResourceAction("EditProperties",t,{cascade:!0,position:o,number:e.length})})})},Export:function(e){return new repositorySearch.Action(function(){repositorySearch.exportDialog.openRepoDialog(e)})}},repositorySearch.ServerAction=function(e,t){this.actionURL="flow.html?_flowExecutionKey="+repositorySearch.flowExecutionKey+"&_eventId="+e,this.data=Object.toQueryString(t.data)},repositorySearch.ServerAction.addMethod("invokeAction",function(){ajaxTargettedUpdate(this.actionURL,{postData:this.data,callback:function(e){"OK"==e.status?this.onSuccess(e.data):this.onError(e.data)}.bind(this),errorHandler:this._serverErrorHandler,mode:AjaxRequester.prototype.EVAL_JSON})}),repositorySearch.ServerAction.addMethod("initDownload",function(){var e=this.actionURL+"&"+this.data;ajaxIframeDownload(e,{onload:function(){var e=$("ajax-download-iframe").contentDocument.body.innerHTML;try{var t=e.evalJSON();alert(t.data)}catch(o){}}})}),repositorySearch.ServerAction.addMethod("_serverErrorHandler",function(e){return baseErrorHandler(e)}),repositorySearch.ServerAction.addMethod("onSuccess",doNothing),repositorySearch.ServerAction.addMethod("onError",doNothing),repositorySearch.ServerAction.createSearchAction=function(e,t){t.mode=repositorySearch.mode;var o=new repositorySearch.ServerAction(e,{data:t});return o.onSuccess=function(o){e==repositorySearch.SearchAction.NEXT?repositorySearch.fire(repositorySearch.Event.RESULT_NEXT,o):e==repositorySearch.SearchAction.GET_RESOURCE_CHILDREN?repositorySearch.fire(repositorySearch.Event.CHILDREN_LOADED,{inputData:t,responseData:o}):(repositorySearch.fire(repositorySearch.Event.RESULT_CHANGED,o),repositorySearch.fire(repositorySearch.Event.STATE_CHANGED,o),repositorySearch.mode==repositorySearch.Mode.SEARCH&&repositorySearch.fire(repositorySearch.Event.FILTER_PATH_CHANGED,o))},o.onError=function(e){repositorySearch.fire(repositorySearch.Event.RESULT_ERROR,e)},o},repositorySearch.ServerAction.createFolderAction=function(e,t){var o,r,i;repositorySearch.FolderAction.DELETE==e?(o={sourceFolderUri:t.folder.URI},r=repositorySearch.FolderEvent.DELETED,i=repositorySearch.FolderEvent.DELETE_ERROR):repositorySearch.FolderAction.CREATE==e?(o={destFolderUri:t.toFolder.URI,folder:Object.toJSON({URI:"",label:t.label,desc:t.desc})},r=repositorySearch.FolderEvent.CREATED,i=repositorySearch.FolderEvent.CREATE_ERROR):repositorySearch.FolderAction.COPY==e?(o={destFolderUri:t.toFolder.URI,sourceFolderUri:t.folder.URI},r=repositorySearch.FolderEvent.COPIED,i=repositorySearch.FolderEvent.COPY_ERROR):repositorySearch.FolderAction.MOVE==e?(o={destFolderUri:t.toFolder.URI,sourceFolderUri:t.folder.URI},r=repositorySearch.FolderEvent.MOVED,i=repositorySearch.FolderEvent.MOVE_ERROR):repositorySearch.FolderAction.UPDATE==e?(o={folder:Object.toJSON({URI:t.folder.URI,label:t.folder.label,desc:t.folder.description})},r=repositorySearch.FolderEvent.UPDATED,i=repositorySearch.FolderEvent.UPDATE_ERROR):repositorySearch.ThemeAction.SETTHEME==e?(t.folder?o={folderUri:t.folder.URI}:t.folderUri&&(o={folderUri:t.folderUri}),r=repositorySearch.ThemeEvent.UPDATED):repositorySearch.ThemeAction.DOWNLOAD_THEME==e?(o={folderUri:t.folder.URI},i=repositorySearch.ThemeEvent.THEME_ERROR):repositorySearch.ThemeAction.REUPLOAD==e&&(o={themeName:t.themeName,folderUri:t.folderUri},r=repositorySearch.ThemeEvent.REUPLOADED,i=repositorySearch.ThemeEvent.THEME_ERROR),o&&r&&i||new Error("Unsupported folder action.");var n=new repositorySearch.ServerAction(e,{data:o});return n.onSuccess=function(e){repositorySearch.fire(r,{responseData:e,inputData:t})},n.onError=function(e){repositorySearch.fire(i,{responseData:e,inputData:t})},n},repositorySearch.ServerAction.createResourceAction=function(e,t){function o(o,r){dialogs.dependentResources.show(o,{dependenciesBtnOk:function(){var o=new repositorySearch.ServerAction.createResourceAction(e,{resources:r,folder:t.folder});o.invokeAction()}},{buttons:["ok","cancel"],dialogTitle:repositorySearch.getMessage("dialog.resources.exist.title"),topMessage:repositorySearch.getMessage("dialog.resources.exist"),bottomMessage:repositorySearch.getMessage("dialog.resources.exist.confirm.skip")})}function r(r){var i;if(repositorySearch.ResourceAction.COPY!=e&&repositorySearch.ResourceAction.MOVE!=e)return r;try{i=jQuery.parseJSON(r)}catch(n){return r}if(!i||!i.existingLabels)return r;var s=_.filter(t.resources,function(e){return-1==i.existingLabels.indexOf(e.label)});return 0===s.length?(1==i.existingLabels.length?repositorySearch.getMessage("dialog.resources.one.exists"):repositorySearch.getMessage("dialog.resources.all.exist"))+" "+t.folder.URIString:(o(i.existingLabels,s),null)}var i,n,s;if(repositorySearch.ResourceAction.DELETE==e){var a=ResourcesUtils.getResourceUriAndTypeList(t.resources);i={selectedResources:Object.toJSON(a)},n=repositorySearch.ResourceEvent.DELETED,s=repositorySearch.ResourceEvent.DELETE_ERROR}else if(repositorySearch.ResourceAction.COPY==e){var d=ResourcesUtils.getResourceUris(t.resources);i={selectedResources:Object.toJSON(d),destFolderUri:t.folder.URI},n=repositorySearch.ResourceEvent.COPIED,s=repositorySearch.ResourceEvent.COPY_ERROR}else if(repositorySearch.ResourceAction.MOVE==e){var l=ResourcesUtils.getResourceUris(t.resources);i={selectedResources:Object.toJSON(l),destFolderUri:t.folder.URI},n=repositorySearch.ResourceEvent.MOVED,s=repositorySearch.ResourceEvent.MOVE_ERROR}else repositorySearch.ResourceAction.UPDATE==e&&(i={selectedResource:Object.toJSON(t.resource)},n=repositorySearch.ResourceEvent.UPDATED,s=repositorySearch.ResourceEvent.UPDATE_ERROR);i&&n&&s||new Error("Unsupported resource action.");var c=new repositorySearch.ServerAction(e,{data:i});return c.onSuccess=function(o){repositorySearch.ResourceAction.MOVE==e&&repositorySearch.CopyMoveController.cancel(),repositorySearch.fire(n,{responseData:o,inputData:t})},c.onError=function(e){var o=r(e);o&&repositorySearch.fire(s,{responseData:o,inputData:t})},c},repositorySearch.ServerAction.createPermissionAction=function(e,t){var o=new repositorySearch.ServerAction(e,{data:t}),r=e==repositorySearch.PermissionAction.UPDATE?repositorySearch.PermissionEvent.UPDATED:repositorySearch.PermissionEvent.LOADED;return o.onSuccess=function(o){repositorySearch.fire(r,{responseData:o,inputData:t,doSet:e!=repositorySearch.PermissionAction.NEXT})},o.onError=function(e){repositorySearch.fire(repositorySearch.PermissionEvent.ERROR,e)},o},repositorySearch.ServerAction.createGenerateAction=function(e,t){var o=new repositorySearch.ServerAction(e,{data:{data:Object.toJSON(t)}});return o.actionURL="reportGenerator.html?action="+e,o.onSuccess=function(e){repositorySearch.fire(repositorySearch.ResourceEvent.GENERATED,{responseData:e,inputData:t})},o.onError=function(e){repositorySearch.fire(repositorySearch.ResourceEvent.GENERATE_ERROR,{responseData:e,inputData:t})},o},repositorySearch.ServerAction.createConvertAction=function(e,t){var o=new repositorySearch.ServerAction(e,{data:t});return o.actionURL="dataViewConverter.html?action="+e,o.onSuccess=function(e){repositorySearch.fire(repositorySearch.ResourceEvent.CONVERTED,{responseData:e,inputData:t})},o.onError=function(e){repositorySearch.fire(repositorySearch.ResourceEvent.CONVERT_ERROR,{responseData:e,inputData:t})},o},repositorySearch.RedirectAction=function(e,t){this.type=e,this.flowId=t.flowId,this.url=t.url?t.url:this.flowId?this.FLOW_URL:void 0,this.paramsMap=t.paramsMap||{},this.hash=t.hash?"#"+t.hash:"",this.encode=t.encode,this.type!==repositorySearch.RedirectType.FLOW_REDIRECT&&this.url===this.FLOW_URL&&(this.paramsMap._flowId=this.flowId)},repositorySearch.RedirectAction.addMethod("FLOW_URL","flow.html"),repositorySearch.RedirectAction.addMethod("_serializeParams",function(e,t){if(e){var o="";for(var r in e)Object.isUndefined(r)||(o+="&"+r+"="+(t?encodeURIComponent(e[r]):e[r]));return o&&o.length>0?o.substring(1):""}return""}),repositorySearch.RedirectAction.addMethod("invokeAction",function(){if(this.type===repositorySearch.RedirectType.FLOW_REDIRECT){var e=$("redirectForm"),t=$("flowParams");t.setValue(this.flowId+"?"+this._serializeParams(this.paramsMap,this.encode));var o=new repositorySearch.ServerAction("isServerAvailable",{data:{}});o.onSuccess=function(t){"Yes"==t.strip()?(++ajax.ajaxRequestCount,dialogs.popup.show(ajax.LOADING_ID,!0),e.submit(),repositorySearch.fire(repositorySearch.Event.FLOW_REDIRECT_RUNNING,t)):repositorySearch.fire(repositorySearch.Event.REDIRECT_ERROR,t)},o.onError=function(e){repositorySearch.fire(repositorySearch.Event.REDIRECT_ERROR,e)},o.invokeAction()}else if(this.type===repositorySearch.RedirectType.LOCATION_REDIRECT){var r=this.url+(jQuery.isEmptyObject(this.paramsMap)?"":"?"+this._serializeParams(this.paramsMap,this.encode))+this.hash;redirectToUrl(r)}else if(this.type===repositorySearch.RedirectType.WINDOW_REDIRECT){var i=window.open(),n=this._serializeParams(this.paramsMap,this.encode);i.opener=null,i.document.location=this.url+(n?"?"+n:"")+this.hash}}),repositorySearch.runActionFactory={ReportUnit:function(e,t){var o=t?repositorySearch.RedirectType.WINDOW_REDIRECT:repositorySearch.RedirectType.FLOW_REDIRECT;return new repositorySearch.RedirectAction(o,{url:"flow.html",flowId:"viewReportFlow",paramsMap:{_flowId:"viewReportFlow",reportUnit:t?encodeURIComponent(e.URIString):e.URIString,standAlone:!0,ParentFolderUri:e.parentFolder}})},AdhocReportUnit:function(e,t){var o=t?repositorySearch.RedirectType.WINDOW_REDIRECT:repositorySearch.RedirectType.FLOW_REDIRECT;return new repositorySearch.RedirectAction(o,{url:"flow.html",flowId:"viewAdhocReportFlow",paramsMap:{reportUnit:t?encodeURIComponent(e.URIString):e.URIString,standAlone:!0,ParentFolderUri:e.parentFolder}})},OlapUnit:function(e,t){var o=t?repositorySearch.RedirectType.WINDOW_REDIRECT:repositorySearch.RedirectType.LOCATION_REDIRECT;return new repositorySearch.RedirectAction(o,{url:"olap/viewOlap.html",paramsMap:{name:t?encodeURIComponent(e.URIString):e.URIString,"new":!0,parentFlow:"searchFlow",ParentFolderUri:e.parentFolder}})},DashboardResource:function(e,t){var o=t?repositorySearch.RedirectType.WINDOW_REDIRECT:repositorySearch.RedirectType.FLOW_REDIRECT;return new repositorySearch.RedirectAction(o,{url:"flow.html",flowId:"dashboardRuntimeFlow",paramsMap:{dashboardResource:t?encodeURIComponent(e.URIString):e.URIString}})},DashboardModelResource:function(e,t){var o=t?repositorySearch.RedirectType.WINDOW_REDIRECT:repositorySearch.RedirectType.LOCATION_REDIRECT;return new repositorySearch.RedirectAction(o,{url:"dashboard/viewer.html#"+encodeURIComponent(e.URIString)})},ReportOptions:function(e,t){var o,r={reportOptionsURI:t?encodeURIComponent(e.URIString):e.URIString,standAlone:!0,ParentFolderUri:e.parentFolder},i=e.parentResource;i&&i.typeEquals(repositorySearch.ResourceType.ADHOC_REPORT_UNIT)?(o="viewAdhocReportFlow",r.reportUnit=t?encodeURIComponent(i.URIString):i.URIString):o="viewReportFlow";var n=t?repositorySearch.RedirectType.WINDOW_REDIRECT:repositorySearch.RedirectType.FLOW_REDIRECT;return new repositorySearch.RedirectAction(n,{url:"flow.html",flowId:o,paramsMap:r})}},repositorySearch.RedirectAction.createRunResourceAction=function(e,t){e||(e=e?e:repositorySearch.model.getSelectedResources()[0]);var o=repositorySearch.runActionFactory[e.typeSuffix()];return o?o(e,t):new repositorySearch.Action(function(){alert("Run action for resource type '"+e.resourceType+"' is not implemented!")})},repositorySearch.RedirectAction.createRunResourceInNewTabAction=function(e,t){return repositorySearch.RedirectAction.createRunResourceAction(e,!0)},repositorySearch.editActionFactory={"default-action":function(e,t){return ResourcesUtils.isCustomDataSource(e)?repositorySearch.editActionFactory.JdbcReportDataSource(e,t):new repositorySearch.Action(function(){alert("Edit action for resource type '"+e.resourceType+"' is not implemented!")})},ReportUnit:function(e,t){return new repositorySearch.RedirectAction(t,{flowId:"reportUnitFlow",paramsMap:{selectedResource:e.URIString,ParentFolderUri:e.parentFolder}})},AdhocReportUnit:function(e,t){return repositorySearch.editActionFactory.ReportUnit(e,t)},DataDefinerUnit:function(e,t){return new repositorySearch.RedirectAction(t,{flowId:"queryBuilderFlow",paramsMap:{uri:e.URIString,ParentFolderUri:e.parentFolder}})},OlapUnit:function(e,t){return new repositorySearch.RedirectAction(t,{flowId:"olapUnitFlow",paramsMap:{resource:e.URIString,isEdit:"edit",ParentFolderUri:e.parentFolder}})},DashboardResource:function(e,t){return new repositorySearch.RedirectAction(t,{flowId:"dashboardRuntimeFlow",paramsMap:{dashboardResource:e.URIString}})},ReportOptions:function(e,t){return new repositorySearch.RedirectAction(t,{flowId:"reportOptionsEditFlow",paramsMap:{reportOptionsURI:e.URIString,ParentFolderUri:e.parentFolder}})},JdbcReportDataSource:function(e,t){return new repositorySearch.RedirectAction(t,{flowId:"addDataSourceFlow",paramsMap:{resource:e.URIString,ParentFolderUri:e.parentFolder}})},JndiJdbcReportDataSource:function(e,t){return repositorySearch.editActionFactory.JdbcReportDataSource(e,t)},CustomReportDataSource:function(e,t){return repositorySearch.editActionFactory.JdbcReportDataSource(e,t)},BeanReportDataSource:function(e,t){return repositorySearch.editActionFactory.JdbcReportDataSource(e,t)},VirtualReportDataSource:function(e,t){return repositorySearch.editActionFactory.JdbcReportDataSource(e,t)},HiveDataSourceService:function(e,t){return repositorySearch.editActionFactory.JdbcReportDataSource(e,t)},CassandraDataSourceService:function(e,t){return repositorySearch.editActionFactory.JdbcReportDataSource(e,t)},DiagnosticCustomDataSourceService:function(e,t){return repositorySearch.editActionFactory.JdbcReportDataSource(e,t)},MongoDbDataSourceService:function(e,t){return repositorySearch.editActionFactory.JdbcReportDataSource(e,t)},AwsReportDataSource:function(e,t){return repositorySearch.editActionFactory.JdbcReportDataSource(e,t)},AzureSqlReportDataSource:function(e,t){return repositorySearch.editActionFactory.JdbcReportDataSource(e,t)},Query:function(e,t){return new repositorySearch.RedirectAction(t,{flowId:"queryFlow",paramsMap:{currentQuery:e.URIString,isEdit:!0,ParentFolderUri:e.parentFolder}})},InputControl:function(e,t){return new repositorySearch.RedirectAction(t,{flowId:"addInputControlFlow",paramsMap:{isEdit:!0,resource:e.URIString,ParentFolderUri:e.parentFolder}})},ListOfValues:function(e,t){return new repositorySearch.RedirectAction(t,{flowId:"addListOfValuesFlow",paramsMap:{resource:e.URIString,isEdit:"edit",ParentFolderUri:e.parentFolder}})},DataType:function(e,t){return new repositorySearch.RedirectAction(t,{flowId:"dataTypeFlow",paramsMap:{resource:e.URIString,isEdit:"edit",ParentFolderUri:e.parentFolder}})},MondrianConnection:function(e,t){return new repositorySearch.RedirectAction(t,{flowId:"olapClientConnectionFlow",paramsMap:{selectedResource:e.URIString,isEdit:"edit",ParentFolderUri:e.parentFolder}})},SecureMondrianConnection:function(e,t){return repositorySearch.editActionFactory.MondrianConnection(e,t)},XMLAConnection:function(e,t){return repositorySearch.editActionFactory.MondrianConnection(e,t)},MondrianXMLADefinition:function(e,t){return new repositorySearch.RedirectAction(t,{flowId:"mondrianXmlaSourceFlow",paramsMap:{selectedResource:e.URIString,isEdit:"edit",ParentFolderUri:e.parentFolder}})},FileResource:function(e,t){return new repositorySearch.RedirectAction(t,{flowId:"addFileResourceFlow",paramsMap:{selectedResource:e.URIString,ParentFolderUri:e.parentFolder}})},SemanticLayerDataSource:function(e,t){return new repositorySearch.RedirectAction(t,{flowId:"createSLDatasourceFlow",paramsMap:{uri:e.URIString,ParentFolderUri:e.parentFolder}})}},repositorySearch.RedirectAction.createEditResourceAction=function(e,t){e||(e=repositorySearch.model.getSelectedResources()[0]);var o=t?repositorySearch.RedirectType.WINDOW_REDIRECT:repositorySearch.RedirectType.FLOW_REDIRECT,r=repositorySearch.editActionFactory[e.typeSuffix()];return r?r(e,o):repositorySearch.editActionFactory[repositorySearch.Action.DEFAULT](e,o)},repositorySearch.openActionFactory={ContentResource:function(e,t){return t===repositorySearch.RedirectType.FLOW_REDIRECT&&(t=repositorySearch.RedirectType.LOCATION_REDIRECT),new repositorySearch.RedirectAction(t,{url:"fileview/fileview"+e.URIString,paramsMap:{}})},DashboardResource:function(e,t){return new repositorySearch.RedirectAction(t,{flowId:"dashboardDesignerFlow",paramsMap:{resource:e.URIString,ParentFolderUri:e.parentFolder}})},DashboardModelResource:function(e,t){var o=t?repositorySearch.RedirectType.WINDOW_REDIRECT:repositorySearch.RedirectType.LOCATION_REDIRECT;return new repositorySearch.RedirectAction(o,{url:"dashboard/designer.html#"+encodeURIComponent(e.URIString)})},DataDefinerUnit:function(e,t){return new repositorySearch.RedirectAction(t,{flowId:"queryBuilderFlow",paramsMap:{uri:e.URIString,ParentFolderUri:e.parentFolder}})},AdhocReportUnit:function(e,t){return new repositorySearch.RedirectAction(t,{flowId:"adhocFlow",paramsMap:{resource:e.URIString,ParentFolderUri:e.parentFolder}})},AdhocDataView:function(e,t){return new repositorySearch.RedirectAction(t,{flowId:"adhocFlow",paramsMap:{resource:e.URIString,ParentFolderUri:e.parentFolder}})}},repositorySearch.RedirectAction.createOpenResourceAction=function(e,t){e||(e=repositorySearch.model.getSelectedResources()[0]);var o=t?repositorySearch.RedirectType.WINDOW_REDIRECT:repositorySearch.RedirectType.FLOW_REDIRECT,r=repositorySearch.openActionFactory[e.typeSuffix()];return r?r(e,o):new repositorySearch.Action(function(){alert("Open action for resource type '"+e.resourceType+"' is not implemented!")})},repositorySearch.RedirectAction.createRunInBackgroundResourceAction=function(){var e=repositorySearch.model.getSelectedResources()[0],t="";return e.resourceType.endsWith(".ReportUnit")||e.resourceType.endsWith(".AdhocReportUnit")||e.resourceType.endsWith(".DashboardModelResource")||e.resourceType.endsWith(".ReportOptions")?(e.parentResource&&(t="@@parentReportURI="+e.parentResource.URIString+"@@"),new repositorySearch.RedirectAction(repositorySearch.RedirectType.LOCATION_REDIRECT,{url:JRS.vars.contextPath+"/scheduler/main.html",paramsMap:{reportUnitURI:e.URIString,parentReportUnitURI:e.parentResource?e.parentResource.URIString:"",resourceType:e.resourceType.substring(e.resourceType.lastIndexOf(".")+1)},hash:"runInBackground@"+e.URIString+t,encode:!0})):void 0},repositorySearch.RedirectAction.createScheduleAction=function(){var e=repositorySearch.model.getSelectedResources()[0],t="";return e.resourceType.endsWith(".ReportUnit")||e.resourceType.endsWith(".AdhocReportUnit")||e.resourceType.endsWith(".DashboardModelResource")||e.resourceType.endsWith(".ReportOptions")?(e.parentResource&&(t="@@parentReportURI="+e.parentResource.URIString+"@@"),new repositorySearch.RedirectAction(repositorySearch.RedirectType.LOCATION_REDIRECT,{url:JRS.vars.contextPath+"/scheduler/main.html",paramsMap:{reportUnitURI:e.URIString,resourceType:e.resourceType.substring(1+e.resourceType.lastIndexOf(".")),parentReportUnitURI:e.parentResource?e.parentResource.URIString:""},hash:e.URIString+t,encode:!0})):void 0},repositorySearch.createActionFactory={OlapClientConnection:function(e){return new repositorySearch.RedirectAction(repositorySearch.RedirectType.FLOW_REDIRECT,{flowId:"olapClientConnectionFlow",paramsMap:{ParentFolderUri:e.URI}})},OlapUnit:function(e){return new repositorySearch.RedirectAction(repositorySearch.RedirectType.FLOW_REDIRECT,{flowId:"olapUnitFlow",paramsMap:{ParentFolderUri:e.URI}})},ReportDataSource:function(e){return new repositorySearch.RedirectAction(repositorySearch.RedirectType.FLOW_REDIRECT,{flowId:"addDataSourceFlow",paramsMap:{ParentFolderUri:e.URI}})},SemanticLayerDataSource:function(e){return new repositorySearch.RedirectAction(repositorySearch.RedirectType.FLOW_REDIRECT,{flowId:"createSLDatasourceFlow",paramsMap:{ParentFolderUri:e.URI}})},FileResource:function(e,t){return new repositorySearch.RedirectAction(repositorySearch.RedirectType.FLOW_REDIRECT,{flowId:"addFileResourceFlow",paramsMap:{expectedFileType:t,parentFolder:e.URI}})},ReportUnit:function(e){return new repositorySearch.RedirectAction(repositorySearch.RedirectType.FLOW_REDIRECT,{flowId:"reportUnitFlow",paramsMap:{ParentFolderUri:e.URI}})},Query:function(e){return new repositorySearch.RedirectAction(repositorySearch.RedirectType.FLOW_REDIRECT,{flowId:"queryFlow",paramsMap:{ParentFolderUri:e.URI}})},InputControl:function(e){return new repositorySearch.RedirectAction(repositorySearch.RedirectType.FLOW_REDIRECT,{flowId:"addInputControlFlow",paramsMap:{ParentFolderUri:e.URI}})},DataType:function(e){return new repositorySearch.RedirectAction(repositorySearch.RedirectType.FLOW_REDIRECT,{flowId:"dataTypeFlow",paramsMap:{ParentFolderUri:e.URI}})},ListOfValues:function(e){return new repositorySearch.RedirectAction(repositorySearch.RedirectType.FLOW_REDIRECT,{flowId:"addListOfValuesFlow",paramsMap:{ParentFolderUri:e.URI}})},XMLAConnection:function(e){return new repositorySearch.RedirectAction(repositorySearch.RedirectType.FLOW_REDIRECT,{flowId:"mondrianXmlaSourceFlow",paramsMap:{ParentFolderUri:e.URI}})}},repositorySearch.RedirectAction.createCreateResourceAction=function(e,t){var o=repositorySearch.model.getContextFolder(),r=repositorySearch.createActionFactory[e];return r?r(o,t):new repositorySearch.Action(function(){alert("Create action for resource type suffix '"+e+"' is not implemented!")})},repositorySearch.confirmAndLeave=function(){return new repositorySearch.Action(function(){return!isPropertiesChanged()&&!isPermissionsChanged()||confirm(repositorySearch.getMessage("RM_CANCEL_EDIT_MESSAGE"))}).invokeAction()},define("component.repository.search",["repository.search.main","repository.search.components","prototype","actionModel.modelGenerator","utils.common","core.ajax"],function(e){return function(){var t;return t||e.repositorySearch}}(this)),window,define("localContext",function(e){return function(){var t;return t||e.window}}(this)),dialogs.dependentResources={dependenciesPanel:null,show:function(e,t,o){this.dependenciesPanel=jQuery("#dependencies"),this._$title=this.dependenciesPanel.find(".content .header .title"),o.dialogTitle&&(this._titleBackup=this._$title.html(),this._$title.html(o.dialogTitle)),dialogs.popup.show(this.dependenciesPanel[0]),this._changeMessage(o),this._switchButtons(o);var r=this._initList(e);this.dependenciesPanel.on("click",function(e){var o=jQuery(e.target).closest("button").attr("id"),i=t&&t[o];_.include(["dependenciesBtnSave","dependenciesBtnSaveAs","dependenciesBtnOk","dependenciesBtnCancel"],o)&&(dialogs.dependentResources.hide(),r.setItems([]),e.stopPropagation(),i&&i())})},hide:function(){this.dependenciesPanel&&(this.dependenciesPanel.off("click"),dialogs.popup.hide(this.dependenciesPanel[0]),this.dependenciesPanel=null),this._titleBackup&&this._$title&&(this._$title.html(this._titleBackup),this._titleBackup=null)},_changeMessage:function(e){jQuery("#topMessage").html(e.topMessage),jQuery("#bottomMessage").html(e.bottomMessage)},_initList:function(e){var t=new dynamicList.List("dependenciesList",{listTemplateDomId:"tabular_oneColumn",itemTemplateDomId:"tabular_oneColumn:leaf"}),o=[];return e&&(o=e.collect(function(e){var t=new dynamicList.ListItem({cssClassName:layoutModule.LEAF_CLASS,value:e});return t.processTemplate=function(e){var t,o=e.select(".uri")[0];return t="string"==typeof this.getValue()?this.getValue():this.getValue().uristring?this.getValue().uristring:this.getValue().URIString,o.update(xssUtil.escape(t)),e},t})),t.setItems(o),t.show(),t},_switchButtons:function(e){var t,o={save:jQuery("#dependenciesBtnSave"),saveAs:jQuery("#dependenciesBtnSaveAs"),ok:jQuery("#dependenciesBtnOk"),cancel:jQuery("#dependenciesBtnCancel")};t=e.buttons?e.buttons:e.okOnly?["ok"]:e.canSave?["save","saveAs","cancel"]:["ok","cancel"],_.each(o,function(e,o){t.indexOf(o)<0?e.addClass("hidden"):e.removeClass("hidden")})}},define("components.dependent.dialog",["prototype","components.dialogs","jquery","components.list"],function(e){return function(){var t;return t||e.dialogs.dependentResources}}(this));var toolbarButtonModule={UP:"up",DOWN:"down",OVER:"over",DISABLED:"disabled",PRESSED:"pressed",CONTENT_PREFIX:"toolbar_",MenuClass:"menu vertical dropDown",TOOLBAR_MENU_CLASS:"menu vertical dropDown fitable",ACTION_MODEL_TAG:"adhocActionModel",CAPSULE_PATTERN:"capsule",showButtonMenu:function(e,t){t=jQuery(t);var o=this.CONTENT_PREFIX+t.attr("id"),r="adhocActionModel"==this.ACTION_MODEL_TAG?this.actionModel:this.ACTION_MODEL_TAG;actionModel.showDropDownMenu(e,t,o,this.TOOLBAR_MENU_CLASS,r)},setActionModel:function(e){this.actionModel=e},isToolBarButton:function(e){return e?jQuery(e).hasClass("capsule"):!1},enable:function(e,t){buttonManager.enable(e)},disable:function(e){buttonManager.disable(e)},setButtonState:function(e,t){t?this.enable(e):this.disable(e)}};define("components.toolbarButtons",["jquery","prototype"],function(e){return function(){var t;return t||e.toolbarButtonModule}}(this)),toolbarButtonModule.initialize=function(e){toolbarButtonModule.actionMap=e,jQuery(".toolbar").on("mouseup mouseover mouseout","button",function(e){jQuery(this).prop("disabled")||toolbarButtonModule["mouse"+e.type.substring(5,6).toUpperCase()+e.type.substring(6)+"Handler"](e,this)}),isFirefox()&&jQuery(".toolbar li").each(function(e,t){jQuery(t).css("padding","0 2px")})},toolbarButtonModule.mouseUpHandler=function(e,t){var o=t.className.indexOf("capsule")>=0?toolbarButtonModule.actionMap[t.id]:null;if(o){var r=getAsFunction(o);r(e),e.stopPropagation()}},toolbarButtonModule.mouseOverHandler=function(e,t){t.className.indexOf("capsule")>=0&&t.className.indexOf("mutton")>=0&&!buttonManager.isDisabled(t)&&toolbarButtonModule.showButtonMenu(e.originalEvent,t)},toolbarButtonModule.mouseOutHandler=function(e,t){},define("components.toolbar",["jquery","prototype","utils.common","components.toolbarButtons"],function(e){return function(){var t;return t||e.toolbarButtonModule}}(this)),define("text!common/component/dialog/template/confirmDialogTemplate.htm",[],function(){return"<p class='confirmationText'>\n    {{ print(_.xssEscape(text, {softHTMLEscape: true})) }}\n</p>"}),define("common/component/dialog/ConfirmationDialog",["require","underscore","./Dialog","text!./template/confirmDialogTemplate.htm","bundle!js-sdk/CommonBundle"],function(e){"use strict";var t=e("underscore"),o=e("./Dialog"),r=e("text!./template/confirmDialogTemplate.htm"),i=e("bundle!js-sdk/CommonBundle");return o.extend({constructor:function(e){e||(e={}),this.confirmDialogTemplate=t.template(r),o.prototype.constructor.call(this,{modal:!0,additionalCssClasses:e.additionalCssClasses||"confirmationDialog",title:e.title||i["dialog.confirm.title"],content:this.confirmDialogTemplate({text:e.text}),buttons:[{label:i["button.yes"],action:"yes",primary:!0},{label:i["button.no"],action:"no",primary:!1}]})},initialize:function(){o.prototype.initialize.apply(this,arguments),this.on("button:yes",this.close),this.on("button:no",this.close)},setContent:function(e){o.prototype.setContent.call(this,this.confirmDialogTemplate({text:e}))}})});var orgModule={TREE_ID:"orgTree",COOKIE_NAME:"selectedTenant",messages:[],ActionMap:{SEARCH:"search",BROWSE:"browse",NEXT:"next",SELECT_AND_GET_DETAILS:"selectAndGetDetails",SEARCH_AVAILABLE:"searchAvailable",SEARCH_ASSIGNED:"searchAssigned",NEXT_AVAILABLE:"nextAvailable",NEXT_ASSIGNED:"nextAssigned",CREATE:"create",UPDATE:"update",DELETE:"delete",DELETE_ALL:"deleteAll",
EXIST:"exist"},Event:{ORG_BROWSE:"org:browse",ENTITY_SEARCH:"entity:search",ENTITY_NEXT:"entity:next",ENTITY_SELECT_AND_GET_DETAILS:"entity:selectAndGetDetails",RESULT_CHANGED:"result:changed",RESULT_NEXT:"result:next",ENTITY_DETAILS_LOADED:"entity:detailsLoaded",SEARCH_AVAILABLE_LOADED:"searchAvailable:loaded",SEARCH_ASSIGNED_LOADED:"searchAssigned:loaded",NEXT_AVAILABLE_LOADED:"nextAvailable:loaded",NEXT_ASSIGNED_LOADED:"nextAssigned:loaded",SERVER_ERROR:"server:error",SERVER_UNAVAILABLE:"server:unavailable",ENTITY_CREATED:"entity:created",ENTITY_UPDATED:"entity:updated",ENTITY_DELETED:"entity:deleted",ENTITIES_DELETED:"entities:deleted"},observe:function(e,t){this._getContainer().observe(e,t)},stopObserving:function(e,t){this._getContainer().stopObserving(e,t)},fire:function(e,t){this._getContainer().fire(e,t)},getMessage:function(e,t){var o=orgModule.messages[e];return o?new Template(o).evaluate(t?t:{}):""},_comparator:function(e,t){return e>t?1:t>e?-1:0},_getContainer:function(){return this._container||(this._container=document.body),this._container},Configuration:{nameSeparator:"|",userDefaultRole:"ROLE_USER",userNameNotSupportedSymbols:"[|]",roleNameNotSupportedSymbols:"[|]",emailRegExpPattern:"^[\\p{L}\\p{M}\\p{N}._%'-\\@\\,\\;\\s]+$",superuserRole:"ROLE_SUPERUSER",adminRole:"ROLE_ADMINISTRATOR",anonymousRole:"ROLE_ANONYMOUS"}};orgModule.systemRoles=[orgModule.Configuration.userDefaultRole,orgModule.Configuration.superuserRole,orgModule.Configuration.adminRole,orgModule.Configuration.anonymousRole],orgModule.Organization=function(e){if(!e)throw new Error("Can't create Organization from undefined json or node");e.param?(this.id=e.param.id,this.name=e.name,this.uri=e.param.uri,this.treeNode=e):(this.id=e.tenantId||e.id,this.name=e.tenantName,this.alias=e.tenantAlias||e.alias,this.desc=e.tenantDesc,this.uri=e.tenantUri,this.parentId=e.parentId,this.subTenantCount=e.subTenantCount)},orgModule.Organization.addMethod("isRoot",function(e){return"organizations"==this.id}),orgModule.Organization.addMethod("getNameWithTenant",function(){return this.id}),orgModule.Organization.addMethod("getDisplayName",function(){return this.name}),orgModule.Organization.addMethod("equals",function(e){return e&&this.id==e.id}),orgModule.Organization.addMethod("toJSON",function(e){return{tenantId:this.id,tenantName:this.name,tenantAlias:this.alias,tenantDesc:this.desc,parentId:this.parentId,tenantUri:this.uri}}),orgModule.Organization.addMethod("navigateToManager",function(){primaryNavModule.navigationPaths.tempNavigateToManager=deepClone(primaryNavModule.navigationPaths.organization),primaryNavModule.navigationPaths.tempNavigateToManager.params+="&"+Object.toQueryString({tenantId:this.id}),primaryNavModule.navigationOption("tempNavigateToManager")}),orgModule.Permission=function(e){this.isInherited=!!e.isInherited,e.permission&&(this.permission=e.permission),e.inheritedPermission&&(this.inheritedPermission=e.inheritedPermission),this.isDisabled=!!e.isDisabled},orgModule.Permission.addMethod("getResolvedPermission",function(){return this.isInherited?this.inheritedPermission:this.permission}),orgModule.Permission.addMethod("toJSON",function(){return{permission:this.permission,isInherited:this.isInherited,inheritedPermission:this.inheritedPermission,newPermission:this.newPermission}}),orgModule.Permission.addMethod("toData",function(){return{permission:this.permission,isInherited:this.isInherited,inheritedPermission:this.inheritedPermission,newPermission:this.newPermission}}),orgModule.User=function(e){e&&(this.userName=e.userName,this.fullName=e.fullName,this.password=e.password||"",this.confirmPassword=e.confirmPassword||"",this.tenantId=e.tenantId,this.email=e.email,this.enabled=e.enabled,this.external=e.external,this.roles=[],e.roles&&e.roles.each(function(e){this.roles.push(new orgModule.Role(e))}.bind(this)),e.permissionToDisplay&&(this.permission=new orgModule.Permission(e.permissionToDisplay)))},orgModule.User.addVar("FLOW_ID","userListFlow"),orgModule.User.addMethod("getDisplayName",function(){return this.userName}),orgModule.User.addMethod("getNameWithTenant",function(){return this.tenantId&&!this.tenantId.blank()?this.userName+orgModule.Configuration.userNameSeparator+this.tenantId:this.userName}),orgModule.User.addMethod("getManagerURL",function(){return"flow.html?"+Object.toQueryString({_flowId:this.FLOW_ID,text:"undefined"!=typeof this.userName?encodeURIComponent(this.userName):this.userName,tenantId:"undefined"!=typeof this.tenantId?encodeURIComponent(this.tenantId):this.tenantId})}),orgModule.User.addMethod("navigateToManager",function(){primaryNavModule.navigationPaths.tempNavigateToManager=deepClone(primaryNavModule.navigationPaths.user),primaryNavModule.navigationPaths.tempNavigateToManager.params+="&"+Object.toQueryString({text:this.userName,tenantId:this.tenantId}),primaryNavModule.navigationOption("tempNavigateToManager")}),orgModule.User.addMethod("equals",function(e){return e&&this.userName==e.userName&&this.tenantId==e.tenantId}),orgModule.User.addMethod("toPermissionData",function(e){return{userName:this.userName,tenantId:this.tenantId,permissionToDisplay:this.permission.toData()}}),orgModule.Role=function(e){e&&(this.roleName=e.roleName,this.external=e.external,this.tenantId=e.tenantId),e.permissionToDisplay&&(this.permission=new orgModule.Permission(e.permissionToDisplay))},orgModule.Role.addVar("FLOW_ID","roleListFlow"),orgModule.Role.addMethod("getDisplayName",function(){return this.roleName}),orgModule.Role.addMethod("getNameWithTenant",function(){return this.tenantId&&!this.tenantId.blank()?this.roleName+orgModule.Configuration.userNameSeparator+this.tenantId:this.roleName}),orgModule.Role.addMethod("getManagerURL",function(){return"flow.html?"+Object.toQueryString({_flowId:this.FLOW_ID,text:"undefined"!=typeof this.roleName?encodeURIComponent(this.roleName):this.roleName,tenantId:"undefined"!=typeof this.tenantId?encodeURIComponent(this.tenantId):this.tenantId})}),orgModule.Role.addMethod("navigateToManager",function(){primaryNavModule.navigationPaths.tempNavigateToManager=deepClone(primaryNavModule.navigationPaths.role),primaryNavModule.navigationPaths.tempNavigateToManager.params+="&"+Object.toQueryString({text:this.roleName,tenantId:this.tenantId}),primaryNavModule.navigationOption("tempNavigateToManager")}),orgModule.Role.addMethod("equals",function(e){return e&&this.roleName==e.roleName&&this.tenantId==e.tenantId}),orgModule.Role.addMethod("toPermissionData",function(e){return{roleName:this.roleName,tenantId:this.tenantId,permissionToDisplay:this.permission.toData()}}),orgModule.initTenantsTreeEvents=function(){orgModule.manager.tenantsTree.on("selection:change",function(e){if(!orgModule.manager.lastSelectedOrg||orgModule.manager.lastSelectedOrg.id!==e.id){var t=new orgModule.Organization(e),o=orgModule.properties;orgModule.manager.tenantsTree.setTenant(t),window.localStorage&&localStorage.setItem(orgModule.COOKIE_NAME,JSON.stringify(e)),orgModule.fire(orgModule.Event.ORG_BROWSE,{organization:t,entityEvent:!1}),orgModule.orgManager&&(o.changeDisable(!1,["#"+o._EDIT_BUTTON_ID]),orgModule.fire(orgModule.Event.ENTITY_SELECT_AND_GET_DETAILS,{entityId:t.id,entityEvent:!1})),(orgModule.userManager||orgModule.roleManager)&&(o.hide(),o.unlock())}}),orgModule.manager.tenantsTree.on("import:finished",function(e){var t=orgModule.properties;orgModule.fire(orgModule.Event.ORG_BROWSE,{force:!0,entityEvent:!1}),orgModule.orgManager&&(t.changeDisable(!1,["#"+t._EDIT_BUTTON_ID]),orgModule.fire(orgModule.Event.ENTITY_SELECT_AND_GET_DETAILS,{refreshAttributes:!0,entityId:e,entityEvent:!1}))})},orgModule.entityList={ID_PATTERN:".ID > a",_listId:"entitiesList",_containerId:"listContainer",_searchBoxId:"secondarySearchBox",initialize:function(e){this.list=new dynamicList.List(this._listId,{listTemplateDomId:e.listTemplateId,itemTemplateDomId:e.itemTemplateId,multiSelect:!0,selectionDefaultsToCursor:!0,comparator:function(e,t){return orgModule._comparator(e.getLabel(),t.getLabel())}}),this._initEvents(),this._infiniteScroll=new InfiniteScroll({id:this._containerId,contentId:this._listId}),this._searchBox=new SearchBox({id:this._searchBoxId}),e.text&&this._searchBox.setText(e.text),this._infiniteScroll.onLoad=function(){orgModule.fire(orgModule.Event.ENTITY_NEXT,{})},this._searchBox.onSearch=function(e){orgModule.fire(orgModule.Event.ENTITY_SEARCH,{text:e})},orgModule.toolbar.initialize(e.toolbarModel),this.toolbar=orgModule.toolbar,this.list.show()},_initEvents:function(){this.list.observe("item:selected",function(e){var t=e.memo.item,o=orgModule.properties;this.lastSelectedName=t.getValue().getNameWithTenant(),orgModule.fire(orgModule.Event.ENTITY_SELECT_AND_GET_DETAILS,{entityId:t.getValue().id,entityEvent:!0}),o.changeDisable(!1,["#"+o._EDIT_BUTTON_ID])}.bindAsEventListener(this)),this.list.observe("item:unselected",function(e){var t=orgModule.manager.tenantsTree,o=orgModule.properties;o.changeDisable(!1,["#"+o._EDIT_BUTTON_ID]),!o.locked&&t?orgModule.fire(orgModule.Event.ENTITY_SELECT_AND_GET_DETAILS,{entityId:t.getTenant().id,entityEvent:!0,isCtrlHeld:e.memo.isCtrlHeld}):(o.hide(),this.toolbar.refresh())}.bindAsEventListener(this)),this.list.observe("item:beforeSelectOrUnselect",function(e){var t=e.memo.item;e.stopSelectOrUnselect=!invokeClientAction("cancelIfEdit",{entity:t.getValue(),showConfirm:e.memo.showConfirm})}.bindAsEventListener(this))},_createEntityItem:function(e){var t=new dynamicList.ListItem({label:e.getDisplayName(),value:e}),o=this;return t.processTemplate=function(e){var t=e.select(o.ID_PATTERN)[0];return t.update(xssUtil.escape(this.getValue().getDisplayName())),e},t},getSearchText:function(){return this._searchBox.getText()},setSearchText:function(e){return this._searchBox.setText(e)},getSelectedEntities:function(){return this.list?this.list.getSelectedItems().collect(function(e){return e.getValue()}):[]},setEntities:function(e){var t=e.collect(this._createEntityItem.bind(this));this._infiniteScroll.reset(),this.list.setItems(t),this.list.show(),this.toolbar.refresh()},findEntity:function(e){var t=this.list.getItems(),o=orgModule.properties.options||orgModule.userManager.options;return o._.find(t,function(t){return t.getValue().fullName===e})},addEntities:function(e){var t=e.collect(this._createEntityItem.bind(this));this.list.addItems(t),this.list.refresh(),this.toolbar.refresh()},selectEntity:function(e){var t=this.list.getItems(),o=t.detect(function(t){return t.getValue().getNameWithTenant()==e});o&&(o.isSelected()&&o.deselect(),o.select(),this.lastSelectedName=o.getValue().getNameWithTenant())},restoreSelectedEntity:function(e){this.selectEntity(this.lastSelectedName?this.lastSelectedName:e)},deselectAll:function(){this.list.resetSelected()},update:function(e,t){var o=this.list.getItems(),r=o.findAll(function(t){return t.getValue().getNameWithTenant()==e});r.each(function(e){e.setValue(t),e.refresh()})},remove:function(e){var t,o=this.list.getItems();t=isArray(e)?o.findAll(function(t){return e.include(t.getValue().getNameWithTenant())}):o.findAll(function(t){return t.getValue().getNameWithTenant()==e}),this.list.resetSelected(),this.list.removeItems(t)}},orgModule.properties={_EDIT_MODE_CLASS:"editMode",_moveButtonsId:"moveButtons",_id:"properties",_value:null,isEditMode:!1,_NOTHING_TO_DISPLAY_ID:"nothingToDisplay",_ASSIGNED_VIEW_ID:"assignedView",_ASSIGNED_VIEW_LIST_ID:"assignedViewList",_ASSIGNED_ID:"assigned",_AVAILABLE_ID:"available",_ASSIGNED_LIST_ID:"assignedList",_AVAILABLE_LIST_ID:"availableList",_ATTRIBUTES_LIST_ID:"attributesTab",_EDIT_BUTTON_ID:"edit",_SAVE_BUTTON_ID:"save",_CANCEL_BUTTON_ID:"cancel",_DELETE_BUTTON_ID:"delete",_REMOVE_FROM_ASSIGNED_BUTTON_ID:"removeFromAssigned",_ADD_TO_ASSIGNED_BUTTON_ID:"addToAssigned",_BUTTONS_CONTAINER_ID:"propertiesButtons",_MOVE_BUTTONS_CONTAINER_ID:"moveButtons",_DND_CLASS:".draggable",_DROP_CLASS:"wrap",buttonsFunctions:{},initialize:function(e){var t=e.attributesTypesEnum;if(this.options=e,this.locked=!1,this.hide(),this.processTemplate(e),this._toggleButton(),e.attributes){var o=!orgModule.userManager&&orgModule.orgManager?t.TENANT:t.USER,r=e.attributesViewOptionsFactory,i=e.scrollEventTrait,n=e.AttributesViewFacade;this.options._.extend(this,i),this.attributesFacade=new n(r({context:e.attributes.context,container:jQuery("#attributesTab"),type:o}))}this.options.showAssigned&&this.initDnD(),this.initEvents(),this.initButtonsFunctions(),this.options.ConfirmationDialog&&this._initConfirmationDialog()},_initConfirmationDialog:function(){var e=this,t=this.options.i18n;this.confirmationDialog=new this.options.ConfirmationDialog({title:t["attributes.confirm.dialog.title"],text:t["attributes.confirm.cancel.dialog.text"]}),this.confirmationDialog.on("button:yes",function(){e.cancelOnEdit()})},_toggleButton:function(){var e=this.isChanged(),t=this.attributesFacade&&this.attributesFacade.containsUnsavedItems()||e;t?this.saveButton.removeAttribute("disabled"):this.saveButton.removeClassName("over").setAttribute("disabled","disabled")},show:function(e,t){if(!this.locked){if(this.attributesFacade){var o=this,r=e&&e.isRoot&&e.isRoot(),i=r?this.options._.extend({},e,{id:null}):e;this.attributesFacade.getCurrentView().setContext(i,t).done(function(){o.attributesFacade.render(r)})}var n=$(this._NOTHING_TO_DISPLAY_ID);n.addClassName(layoutModule.HIDDEN_CLASS),document.body.removeClassName(layoutModule.NOTHING_TO_DISPLAY_CLASS),this._value=e,this.changeMode(!1)}},hide:function(){if(!this.locked){var e=$(this._NOTHING_TO_DISPLAY_ID);e.removeClassName(layoutModule.HIDDEN_CLASS),centerElement(e,{horz:!0,vert:!0}),document.body.addClassName(layoutModule.NOTHING_TO_DISPLAY_CLASS),this._value=null,this.changeMode(!1)}},lock:function(){this.locked=!0},unlock:function(){this.locked=!1},setDetailsLoadedEntity:function(e){this.detailsLoadedEntity=e},getDetailsLoadedEntity:function(){return this.detailsLoadedEntity},processTemplate:function(e){if(this.editButton=$(this._EDIT_BUTTON_ID),this.saveButton=$(this._SAVE_BUTTON_ID),this.cancelButton=$(this._CANCEL_BUTTON_ID),this.deleteButton=$(this._DELETE_BUTTON_ID),this.options.showAssigned){this.removeFromAssigned=$(this._REMOVE_FROM_ASSIGNED_BUTTON_ID),this.addToAssigned=$(this._ADD_TO_ASSIGNED_BUTTON_ID),this.assignedViewList=new dynamicList.List(this._ASSIGNED_VIEW_LIST_ID,{listTemplateDomId:e.viewAssignedListTemplateDomId,itemTemplateDomId:e.viewAssignedItemTemplateDomId,comparator:this.assignedComparator,allowSelections:!1,selectionDefaultsToCursor:!1});var t={listTemplateDomId:"list_responsive_collapsible_fields",itemTemplateDomId:"list_responsive_collapsible_fields:fields",comparator:this.assignedComparator,dragPattern:this._DND_CLASS,allowSelections:!0,selectionDefaultsToCursor:!0,multiSelect:!0,selectOnMousedown:!0,setCursorOnMouseDown:!0};this.assignedList=new dynamicList.List(this._ASSIGNED_LIST_ID,Object.extend({},t,{allowSelections:!1,selectionDefaultsToCursor:!1})),this.availableList=new dynamicList.List(this._AVAILABLE_LIST_ID,t),e.searchAssigned&&(this.assignedViewSearchBox=new SearchBox({id:$(this._ASSIGNED_VIEW_ID).select(layoutModule.SEARCH_LOCKUP_PATTERN)[0].identify()}),this.assignedViewSearchBox.onSearch=function(e){invokeServerAction(orgModule.ActionMap.SEARCH_ASSIGNED,{text:e})}),this.availableSearchBox=new SearchBox({id:$(this._AVAILABLE_ID).select(layoutModule.SEARCH_LOCKUP_PATTERN)[0].identify()}),this.availableSearchBox.onSearch=function(e){invokeServerAction(orgModule.ActionMap.SEARCH_AVAILABLE,{text:e})},this.assignedSearchBox=new SearchBox({id:$(this._ASSIGNED_ID).select(layoutModule.SEARCH_LOCKUP_PATTERN)[0].identify()}),this.assignedSearchBox.onSearch=function(e){invokeServerAction(orgModule.ActionMap.SEARCH_ASSIGNED,{text:e})},e.searchAssigned&&(this.assignedViewInfiniteScroll=new InfiniteScroll({id:$($(this._ASSIGNED_VIEW_LIST_ID).parentNode).identify(),contentId:this._ASSIGNED_VIEW_LIST_ID}),this.assignedViewInfiniteScroll.onLoad=function(){invokeServerAction(orgModule.ActionMap.NEXT_ASSIGNED,{})}),this.availableInfiniteScroll=new InfiniteScroll({id:$($(this._AVAILABLE_LIST_ID).parentNode).identify(),contentId:this._AVAILABLE_LIST_ID}),this.availableInfiniteScroll.onLoad=function(){invokeServerAction(orgModule.ActionMap.NEXT_AVAILABLE,{})},this.assignedInfiniteScroll=new InfiniteScroll({id:$($(this._ASSIGNED_LIST_ID).parentNode).identify(),contentId:this._ASSIGNED_LIST_ID}),this.assignedInfiniteScroll.onLoad=function(){invokeServerAction(orgModule.ActionMap.NEXT_ASSIGNED,{})}}},initDnD:function(){Droppables.add($(this._ASSIGNED_LIST_ID).up(),{accept:[this._DROP_CLASS],hoverclass:layoutModule.DROP_TARGET_CLASS,onDrop:function(e,t,o){e.items&&this._addToAssigned()}.bind(this)}),Droppables.add($(this._AVAILABLE_LIST_ID).up(),{accept:[this._DROP_CLASS],hoverclass:layoutModule.DROP_TARGET_CLASS,onDrop:function(e,t,o){e.items&&this._removeFromAssigned()}.bind(this)})},initEvents:function(){function e(){(this.assignedList.getSelectedItems().length>0?buttonManager.enable:buttonManager.disable)(this.removeFromAssigned)}function t(){(this.availableList.getSelectedItems().length>0?buttonManager.enable:buttonManager.disable)(this.addToAssigned)}$(this._BUTTONS_CONTAINER_ID).observe("click",function(e){var t=e.element(),o=matchAny(t,[layoutModule.BUTTON_PATTERN],!0);o&&this.buttonsFunctions[o.identify()]&&this.buttonsFunctions[o.identify()].call(this),e.stop()}.bindAsEventListener(this)),this.options.showAssigned&&($(this._MOVE_BUTTONS_CONTAINER_ID).observe("click",function(e){var t=e.element(),o=matchAny(t,[layoutModule.BUTTON_PATTERN],!0);o&&(o==this.removeFromAssigned?this._removeFromAssigned():o==this.addToAssigned&&this._addToAssigned()),e.stop()}.bindAsEventListener(this)),this.assignedList.observe("item:selected",e.bindAsEventListener(this)),this.assignedList.observe("item:unselected",e.bindAsEventListener(this)),this.assignedList.observe("item:dblclick",function(e){this._removeFromAssigned()}.bindAsEventListener(this)),this.availableList.observe("item:selected",t.bindAsEventListener(this)),this.availableList.observe("item:unselected",t.bindAsEventListener(this)),this.availableList.observe("item:dblclick",function(e){this._addToAssigned()}.bindAsEventListener(this))),this.attributesFacade&&this.attributesFacade.on("change",this.options._.bind(this._toggleButton,this))},initButtonsFunctions:function(){this.buttonsFunctions[this._EDIT_BUTTON_ID]=function(){this.changeMode(!0)},this.buttonsFunctions[this._SAVE_BUTTON_ID]=function(){var e=this,t=new jQuery.Deferred;this.validate()&&(this.attributesFacade?this.attributesFacade.getCurrentView().saveChildren().done(function(){t.resolve()}).fail(function(){t.reject(),jQuery(".tab[tabid='#attributesTab']").trigger("mouseup")}):t.resolve(),t.done(function(){e.save(e._value)}))},this.buttonsFunctions[this._CANCEL_BUTTON_ID]=function(){this.attributesFacade?this.isChanged()?this.confirmationDialog.open():this.cancelOnEdit():invokeClientAction("cancelIfEdit",{entity:this.getValue()})},this.buttonsFunctions[this._DELETE_BUTTON_ID]=function(){this._deleteEntity()},this.buttonsFunctions[this._REMOVE_FROM_ASSIGNED_BUTTON_ID]=function(){this._removeFromAssigned()},this.buttonsFunctions[this._ADD_TO_ASSIGNED_BUTTON_ID]=function(){this._addFromAssigned()}},cancelOnEdit:function(){var e=this;this.isEditMode&&this.cancel().done(function(){e.unlock(),e.changeMode(!1),e._toggleButton()})},changeMode:function(e){this.isEditMode=e;var t,o,r,i;if(this.attributesFacade){o=$("attributesTab");var n=!!this._value&&"organizations"===this._value.id;this.detachScrollEvent(this.attributesFacade.getCurrentView().$container.parent()),this.attributesFacade.toggleMode(e,n),e&&this.initScrollEvent(this.attributesFacade.getCurrentView()),t=$$(".tertiary")[0],r=$("propertiesTab"),i=jQuery(".control.tabSet.anchor")}e?($(this._id).addClassName(this._EDIT_MODE_CLASS),t&&(t.down(".selected").removeClassName("selected"),t.down("li",0).addClassName("selected"),t.addClassName("tabbed"),o.addClassName("hidden"),r.removeClassName("hidden"),i.removeClass("attributesAnchor")),this._assigned=[],this._unassigned=[],this.options.showAssigned&&(centerElement($(this._moveButtonsId),{horz:!0}),$(this._moveButtonsId).style.zIndex=1e3,this.assignedList.setItems([]),this.assignedList.show(),this.availableList.setItems([]),this.availableList.show(),buttonManager.disable(this.removeFromAssigned),buttonManager.disable(this.addToAssigned),this.assignedSearchBox.setText(""),this.availableSearchBox.setText(""),invokeServerAction(orgModule.ActionMap.SEARCH_ASSIGNED,{text:this.assignedSearchBox.getText()}),invokeServerAction(orgModule.ActionMap.SEARCH_AVAILABLE,{text:this.availableSearchBox.getText()})),this._editEntity(),this._toggleButton()):($(this._id).removeClassName(this._EDIT_MODE_CLASS),t&&(o.removeClassName("hidden"),r.removeClassName("hidden"),t.removeClassName("tabbed")),this.options.searchAssigned&&this.assignedViewSearchBox&&this.assignedViewSearchBox.setText(""),this.changeDisable(this.canEdit(),["#"+this._EDIT_BUTTON_ID]),this.changeDisable(this.canDelete(),["#"+this._DELETE_BUTTON_ID]),this._showEntity(),this._assigned=[],this._unassigned=[])},canEdit:function(){return!0},canDelete:function(){var e=orgModule.manager.tree&&orgModule.manager.tree.getOrganization();return e&&"/"===e.uri&&!orgModule.entityList.getSelectedEntities().length?!1:!0},setValuesProperty:function(e,t){this._value[e]=t},getValue:function(){return this._value},setProperties:function(e){},isChanged:function(e){},save:function(e){},validate:function(){return!0},assignedComparator:function(e,t){var o=e.getLabel(),r=t.getLabel();return o>r?1:r>o?-1:0},_moveEntities:function(e){var t,o,r,i;e?(t=this._unassigned,r=this.availableList,o=this._assigned,i=this.assignedList):(t=this._assigned,r=this.assignedList,o=this._unassigned,i=this.availableList);var n=r.getSelectedItems(),s=n.collect(function(e){return e.getValue()});o=o.concat(s.collect(function(t){return t.available==e?t:null})).compact(),t=t.reject(function(e){return s.detect(function(t){return e.equals(t)})}),r.removeItems(n),i.addItems(n,!0),i.refresh(),e?(this._unassigned=t,this._assigned=o):(this._assigned=t,this._unassigned=o)},_addToAssigned:function(){this._moveEntities(!0)},_removeFromAssigned:function(){this._moveEntities(!1)},_entitiesToItems:function(e,t){return e=e?e:[],e.collect(function(e){var o="",r=[],i="orgTooltip";e instanceof orgModule.User?(o=e.userName,e.fullName&&e.fullName.length>0&&(r=[e.fullName]),i=e.tenantId?"fullNameAndOrgTooltip":"fullNameTooltip"):e instanceof orgModule.Role&&(o=e.roleName,i=e.tenantId?"orgTooltip":void 0),e.tenantId&&e.tenantId.length>0&&r.push(e.tenantId),e.available=!!t;var n=new dynamicList.ListItem({label:o,value:e});return this.isEditMode?n.processTemplate=function(e){return r.length>0&&new JSTooltip(e,{text:xssUtil.escape(r),templateId:i}),dynamicList.ListItem.prototype.processTemplate.call(this,e)}:n.processTemplate=function(e){var t=e.select("a")[0];return t.insert(xssUtil.escape(this.getLabel())),t.writeAttribute("href",this.getValue().getManagerURL()),r.length>0&&new JSTooltip(e,{text:xssUtil.escape(r),templateId:i}),e},n}.bind(this))},getAssignedEntities:function(){return this._assigned},getUnassignedEntities:function(){return this._unassigned},setAssignedEntities:function(e){this.assignedViewInfiniteScroll&&this.assignedViewInfiniteScroll.reset(),this.assignedInfiniteScroll&&this.assignedInfiniteScroll.reset();var t=this.isEditMode?this.assignedList:this.assignedViewList,o=this._filterEntities(e,this._unassigned,this._assigned,this.assignedSearchBox.getText());t.setItems(this._entitiesToItems(o)),t.refresh()},addAssignedEntities:function(e){var t=this.isEditMode?this.assignedList:this.assignedViewList,o=this._filterEntities(e,this._unassigned,this._assigned,this.assignedSearchBox.getText());t.addItems(this._entitiesToItems(o)),t.refresh()},setAvailableEntities:function(e){this.availableInfiniteScroll.reset();var t=this._filterEntities(e,this._assigned,this._unassigned,this.availableSearchBox.getText());this.availableList.setItems(this._entitiesToItems(t,!0)),this.availableList.refresh()},addAvailableEntities:function(e){var t=this._filterEntities(e,this._assigned,this._unassigned,this.availableSearchBox.getText());this.availableList.addItems(this._entitiesToItems(t,!0)),this.availableList.refresh()},_filterEntities:function(e,t,o,r){var i=e.reject(function(e){return t.detect(function(t){return t.equals(e)})});return r=r.toLowerCase(),i=i.concat(o.findAll(function(e){return e.getDisplayName().toLowerCase().include(r)}))},changeReadonly:function(e,t){t.each(function(t){$(this._id).select(t)[0].writeAttribute(layoutModule.READONLY_ATTR_NAME,e?null:layoutModule.READONLY_ATTR_NAME)}.bind(this))},resetValidation:function(e){var t=$(this._id);e.each(function(e){ValidationModule.hideError(t.select(e)[0])}.bind(this))},changeDisable:function(e,t){t.each(function(t){e?buttonManager.enable($(this._id).select(t)[0]):buttonManager.disable($(this._id).select(t)[0])}.bind(this))},_deleteEntity:function(){},_editEntity:function(){},_showEntity:function(){}},orgModule.addDialog={show:function(e){},hide:function(e){}},orgModule.Action=function(e,t){Object.isFunction(e)&&(t=t&&Object.isFunction(t)?t:this.beforeInvoke,this.invokeAction=function(){return t()?e.apply(this,arguments):void 0})},orgModule.Action.addMethod("invokeAction",doNothing),orgModule.Action.addMethod("beforeInvoke",function(){return!0}),orgModule.ServerAction=function(e,t){this.actionURL="flow.html?_flowExecutionKey="+localContext.flowExecutionKey+"&_eventId="+e,this.data=Object.toQueryString(t),this.onSuccess=doNothing(),this.onError=doNothing()},orgModule.ServerAction.addMethod("invokeAction",function(){this.beforeInvoke()&&ajaxTargettedUpdate(this.actionURL,{postData:this.data,callback:function(e){e.error?this.onError(e.error):this.onSuccess(e.data)}.bind(this),errorHandler:function(e){return e.getResponseHeader("LoginRequested")?(orgModule.fire(orgModule.Event.SERVER_UNAVAILABLE,{}),!0):baseErrorHandler(e)},mode:AjaxRequester.prototype.EVAL_JSON})}),orgModule.ServerAction.addMethod("beforeInvoke",function(){return!0}),orgModule.toolbar={_actionModel:{},initialize:function(e){this._actionModel=e,toolbarButtonModule.initialize(this._toActionMap(this._actionModel)),this.refresh()},refresh:function(){for(var e in this._actionModel){var t=this._actionModel[e].buttonId,o=toFunction(this._actionModel[e].test);toolbarButtonModule.setButtonState($(t),o())}},_toActionMap:function(e){var t={};for(var o in e){var r=e[o],i=r.buttonId;t[i]=function(e,t){return function(){var o=getAsFunction(e),r=t,i=localContext&&localContext[e];r&&isArray(r)?o.apply(i?localContext:null,r):o.call(i?localContext:null,r)}}(r.action,r.actionArgs)}return t}},orgModule.createInputRegExValidator=function(e){return{validator:function(t){var o=e.regExp.test(t),r=!o,i=r?"":orgModule.getMessage("unsupportedSymbols",{symbols:e.unsupportedSymbols});return e.isValid=r,{isValid:r,errorMessage:i}},element:e}},orgModule.createBlankValidator=function(e,t,o,r){return{validator:function(e){var o=!e.blank(),r=o?"":orgModule.getMessage(t);return{isValid:o,errorMessage:r}},element:e,onValid:o,onInvalid:r}},orgModule.createMaxLengthValidator=function(e,t,o){return{validator:function(r){var i=e.hasAttribute("maxlength")?e.readAttribute("maxlength"):e.maxlength,n=r.length<parseInt(i),s=n?"":orgModule.getMessage(t);return o&&(s=s.replace(o,i)),{isValid:n,errorMessage:s}},element:e}},orgModule.createSameValidator=function(e,t,o){return{validator:function(e){var r=e===t.getValue(),i=r?"":orgModule.getMessage(o);return{isValid:r,errorMessage:i}},element:e}},orgModule.createRegExpValidator=function(e,t,o){return"string"==typeof o&&(o=window.XRegExp?XRegExp(o):new RegExp(o)),{validator:function(e){var r=o.exec(e),i=!r&&0===e.length||r&&e==r[0],n=i?"":orgModule.getMessage(t);return{isValid:i,errorMessage:n}},element:e}},orgModule.truncateOrgName=function(e){return e&&e.length>0?e.truncate(15):""},RegExpRepresenter.addMethod("__parse",function(e){for(var t=$A(),o=1;o<e.length-1;o++){var r=e.charAt(o);"\\"==r&&(r+=e.charAt(++o)),"\\u"==r&&(r+=e.substring(++o,o+4),o+=3),t.push(r)}return t}),RegExpRepresenter.addMethod("getCharacters",function(){var result=$A();return this.expressionTokens.each(function(token){if(token.startsWith("\\u"))result.push(eval('"'+token+'"'));else if(token.startsWith("\\")){var ch=this.charMap[token];result.push(ch?ch:token.substring(1,token.length))}else result.push(token)}.bind(this)),result}),RegExpRepresenter.addMethod("getRepresentedString",function(){for(var e="",t=this.getCharacters(),o=t.length,r=0;o>r;r++){var i=t[r];e+=" "==i||"."==i||","==i?"["+i+"]":i,o-1>r&&(e+=", ")}return e}),define("mng.common",["jquery","underscore","prototype","utils.common","tools.infiniteScroll","components.list","components.dynamicTree","components.toolbar","common/component/dialog/ConfirmationDialog"],function(e){return function(){var t;return t||e.orgModule}}(this)),define("repository/repositoryMain",["require","!domReady","namespace","component.repository.search","jrs.configs","components.list","underscore","localContext","backbone","components.dependent.dialog","components.toolbar","components.tooltip","tools.infiniteScroll","mng.common"],function(e){"use strict";var t=e("!domReady"),o=(e("namespace"),e("component.repository.search")),r=e("jrs.configs"),i=e("components.list"),n=e("underscore"),s=e("localContext");e("backbone"),e("components.dependent.dialog"),e("components.toolbar"),e("components.tooltip"),e("tools.infiniteScroll"),e("mng.common"),t(function(){n.extend(o.messages,r.repositorySearch.i18n),n.extend(i.messages,r.dynamicList.i18n),n.extend(s,r.repositorySearch.localContext),o.initialize(s)})});