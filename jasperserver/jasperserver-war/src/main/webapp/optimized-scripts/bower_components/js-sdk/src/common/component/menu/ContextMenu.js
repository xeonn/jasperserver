define(["require","./Menu","jquery","json3","underscore"],function(t){"use strict";var e=t("./Menu"),i=t("jquery"),o=t("json3"),s=t("underscore");return e.extend({constructor:function(t,i){e.call(this,t,i),this.topPadding=i&&i.topPadding||5,this.leftPadding=i&&i.leftPadding||5,this.hideOnMouseLeave=i&&i.hideOnMouseLeave||!1,this.hideOnMouseLeave&&this.$el.on("mouseleave",this._tryHide),s.bindAll(this,"_tryHide")},_tryHide:function(){this.hide(),i(document.body).off("click.contextMenu",this._tryHide)},show:function(t,n){if(!t||!s.isNumber(t.top)||!s.isNumber(t.left))throw new Error("Required params (top, left) missing: "+o.stringify(t));i(document.body).on("click.contextMenu",this._tryHide);var h=t.top,d=t.left,r=this.topPadding,u=this.leftPadding,f=i("body"),l=this.$el.height(),c=this.$el.width(),p=n?n.height():f.height(),a=n?n.width():f.width(),y=n?n.offset():f.offset(),g=p-t.top,m=a-t.left;return l>g&&(h=t.top-l-r,h<y.top&&(h+=y.top-h+r),h=0>h?p/2-l/2:h),c>m&&(d=t.left-c-u,d<y.left&&(d+=y.left-d+u),d=0>d?a/2-c/2:d),s.extend(this,{top:h,left:d}),this.$el.css({top:this.top,left:this.left}),e.prototype.show.apply(this,arguments)},remove:function(){i(document.body).off("click.contextMenu",this._tryHide),this.hideOnMouseLeave&&this.$el.off("mouseleave",this._tryHide),e.prototype.remove.apply(this,arguments)}})});