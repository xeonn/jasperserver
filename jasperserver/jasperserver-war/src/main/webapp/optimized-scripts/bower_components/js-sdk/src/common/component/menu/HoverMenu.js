define(["require","./AttachableMenu","underscore"],function(e){"use strict";var t=e("./AttachableMenu"),o=e("underscore");return t.extend({_isVisible:!1,_elementHovered:!1,_menuHovered:!1,TIME_BETWEEN_MOUSE_OVERS:200,constructor:function(e,i,s,n){this.padding=s||{top:0,left:0},t.call(this,e,i,this.padding,n),this.on("mouseover",this._onMenuItemMouseOver),this.on("mouseout",this._onMenuItemMouseOut),this.on("selectionMade",this._hide),o.bindAll(this,"_onAttachToMouseOver","_onAttachToMouseOut"),this.$attachTo.on("mouseover",this._onAttachToMouseOver),this.$attachTo.on("mouseout",this._onAttachToMouseOut)},_onMenuItemMouseOver:function(){this._menuHovered=!0},_onMenuItemMouseOut:function(){this._menuHovered=!1,this._hideByTimeout()},_onAttachToMouseOver:function(){this.$attachTo.is(":disabled")||(this._elementHovered=!0,this._isVisible||(this.show(),this._isVisible=!0))},_onAttachToMouseOut:function(){this._elementHovered=!1,this._hideByTimeout()},_hideByTimeout:function(){this._elementHovered||this._menuHovered||setTimeout(o.bind(this._tryHide,this),this.TIME_BETWEEN_MOUSE_OVERS)},_tryHide:function(){this._elementHovered||this._menuHovered||this._hide()},_hide:function(){this.hide(),this._isVisible=!1,this.trigger("hidden")},remove:function(){this.$attachTo.off("mouseover",this._onAttachToMouseOver),this.$attachTo.off("mouseout",this._onAttachToMouseOut),t.prototype.remove.apply(this,arguments)}})});