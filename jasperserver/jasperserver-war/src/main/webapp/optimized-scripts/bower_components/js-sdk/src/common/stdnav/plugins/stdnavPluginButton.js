define(["require","exports","module","jquery","underscore","common/util/eventAutomation","logger","stdnav"],function(e,t,n){"use strict";var i=e("jquery"),o=(e("underscore"),e("common/util/eventAutomation")),r=e("logger").register(n),s=e("stdnav"),u=0,a=function(){u++,this.serial=u};i.extend(a.prototype,{zinit:function(e){return r.debug("stdnavPluginButton.init("+e+")\n"),this},activate:function(){this.behavior={enter:[this,this._onEnterOrEntered,null],entered:[this,this._onEnterOrEntered,null],inherit:!1,inheritable:!0},s.registerNavtype(this.navtype,this.behavior,this.navtype_tags)},deactivate:function(){s.unregisterNavtype("button",this.behavior)},_fixSubfocus:function(e){var t,n=i(e);if(n.is("BUTTON,[role='button']"))t=n;else if(t=i(e).closest("BUTTON,[role='button']"),void 0===t)return;return t.find(".ghostfocus").removeClass(".ghostfocus"),t.children().find(".subfocus").removeClass(".subfocus"),t},_onFocusIn:function(e){var t,n=i(e).children(".ghostfocus");if(n.length>0)n.removeClass("ghostfocus"),t=this._fixSubfocus(n[0]);else{var o=i(e).children('li[js-navigable!="false"]');t=o.length>0?this._fixSubfocus(o[0]):e}return t},_onSubfocusIn:function(e){if("BUTTON"!=i(e).prop("nodeName")){var t=this._fixSubfocus(e);s.setSubfocus(t,!1)}},_onEnterOrEntered:function(e){var t=i(e);return t.is("BUTTON,[role='button']")&&o.simulateClickSequence(e),e}}),i.extend(a.prototype,{navtype:"button",navtype_tags:["BUTTON"]});var c=new a;return c});