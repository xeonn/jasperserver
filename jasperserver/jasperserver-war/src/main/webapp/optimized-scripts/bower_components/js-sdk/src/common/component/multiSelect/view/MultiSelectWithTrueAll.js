define(["require","underscore","common/component/multiSelect/dataprovider/DelegatingDataProvider","common/component/multiSelect/dataprovider/SelectedItemsDataProvider","common/component/multiSelect/view/AvailableItemsListWithTrueAll","common/component/multiSelect/view/MultiSelect"],function(e){"use strict";var t=e("underscore"),i=e("common/component/multiSelect/dataprovider/DelegatingDataProvider"),l=e("common/component/multiSelect/dataprovider/SelectedItemsDataProvider"),a=e("common/component/multiSelect/view/AvailableItemsListWithTrueAll"),s=e("common/component/multiSelect/view/MultiSelect"),n=s.extend({_createAvailableItemsList:function(e){return this.availableItemsListDataProvider=e.getData,e.availableItemsList||new a({model:this.availableItemsListModel,getData:e.getData,bufferSize:e.bufferSize,loadFactor:e.loadFactor,chunksTemplate:e.chunksTemplate,scrollTimeout:e.scrollTimeout,trueAll:e.trueAll})},_createSelectedItemsListDataProvider:function(e){return this.selectedListOptions=e?e.selectedListOptions:{},new i},selectionRemoved:function(e){if(this.getTrueAll()){var t;for(var i in e)if(e.hasOwnProperty(i)){t={value:e[i],index:i};break}this.availableItemsList.selectionAdd(t)}else s.prototype.selectionRemoved.call(this,e)},selectionChangeInternal:function(e){var i=this.getTrueAll();if(i){this.selectedItemsDataProvider.setGetData(this.availableItemsListDataProvider),this.selectedItemsDataProvider.setData=null;var a=this;this.selectedItemsList.fetch(function(){a._updateSelectedItemsCountLabel(),a.selectedItemsList.resize()}),this.silent?delete this.silent:this.triggerSelectionChange()}else{var n=new l(this.selectedListOptions);this.selectedItemsDataProvider.setGetData(n.getData),this.selectedItemsDataProvider.setData=t.bind(n.setData,n),s.prototype.selectionChangeInternal.call(this,e)}},triggerSelectionChange:function(){this.trigger("selection:change",this.getValue(),{isTrueAll:this.getTrueAll()})},setTrueAll:function(e,t){t=t||{},t.silent&&(this.silent=!0),delete t.silent,this.availableItemsList.setTrueAll(e,t)},getTrueAll:function(){return this.availableItemsList.getTrueAll()}});return n});