define(["require","underscore","common/component/multiSelect/view/AvailableItemsList","common/component/list/model/listWithNavigationModelTrait","common/component/list/model/ListWithSelectionAsObjectHashModel"],function(e){var t=e("underscore"),i=e("common/component/multiSelect/view/AvailableItemsList"),o=e("common/component/list/model/listWithNavigationModelTrait"),l=e("common/component/list/model/ListWithSelectionAsObjectHashModel"),n=i.extend({_createListViewModel:function(e){this.getData=e.getData;var t=l.extend(o);return e.listViewModel||new t({getData:e.getData,bufferSize:e.bufferSize,loadFactor:e.loadFactor})},selectionAdd:function(e){this.model.get("value")[e.value]=!0,this.model.trigger("change:value")},selectionAddRange:function(e){for(var t=e.selection,i=this.model.get("value"),o=0;o<t.length;o++)i[t[o]]=!0;this.model.trigger("change:value")},selectionRemove:function(e){delete this.model.get("value")[e.value],this.model.trigger("change:value")},selectionClear:function(){this.model.attributes.value={}},changeFilter:function(e){var t=this;this.listView.scrollTo(0),this.getData({criteria:this.model.get("criteria"),offset:0,limit:1}).done(e&&"function"==typeof e?e:function(){t.listView.fetch(function(){t.listView.resize(),t.listView.setValue(t.model.get("value"),{silent:!0})})})},processSelectionThroughApi:function(e){var t={};this.selectionClear();for(var i=0;i<e.length;i++)t[e[i]]=!0;this.model.attributes.value=t,this.model.trigger("change:value")},convertSelectionForListViewModel:function(e){return e},getValue:function(){return t.keys(this.model.get("value"))},setValue:function(e,i){i=i||{},this.listViewModel.once("selection:change",function(){this.selectionClear();for(var e=this.listViewModel.getSelection(),t=0;t<e.length;t++)this.model.attributes.value[e[t]]=!0;i&&i.silent||this.changeValue()},this),t.isArray(e)||"string"==typeof e||(e=this.convertSelectionForListViewModel(e)),this.listViewModel.select(e,i.modelOptions)}});return n});