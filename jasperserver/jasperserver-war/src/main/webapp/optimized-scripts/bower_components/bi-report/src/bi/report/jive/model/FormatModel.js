define(["require","backbone"],function(e){var n=e("backbone"),r="###0",t={LOCALE_SPECIFIC:"¤",USD:"$",GBP:"£",EUR:"€",YEN:"¥"};return n.Model.extend({defaults:function(){return{backgroundColor:void 0,align:void 0,font:{name:void 0,size:11,bold:!1,italic:!1,underline:!1,color:"000000"}}},initialize:function(e,n){n||(n={}),this.dataType=n.dataType},parse:function(e){var n={align:e.fontHAlign.toLowerCase(),backgroundColor:"Opaque"===e.mode?e.fontBackColor:"transparent",font:{name:e.fontName,size:parseFloat(e.fontSize),italic:e.fontItalic,bold:e.fontBold,underline:e.fontUnderline,color:e.fontColor}};if(e.formatPattern)if("numeric"===this.dataType){var t=e.formatPattern,i=new RegExp("0\\.(0+)"),a=!1,o=!1,c=0,l="-"+r,d=null;t.indexOf(",")>-1&&(a=!0,t=t.replace(/,/g,"")),t.indexOf("%")>-1&&(o=!0,t=t.replace(/%/g,"")),t.indexOf("¤")>-1?(d="LOCALE_SPECIFIC",t=t.replace(/\u00A4/g,"")):t.indexOf("$")>-1?(d="USD",t=t.replace(/\u0024/g,"")):t.indexOf("£")>-1?(d="GBP",t=t.replace(/\u00A3/g,"")):t.indexOf("€")>-1?(d="EUR",t=t.replace(/\u20AC/g,"")):t.indexOf("¥")>-1&&(d="YEN",t=t.replace(/\u00A5/g,"")),t=t.replace(/\s/g,"");var f=i.exec(t);f&&2==f.length&&(c=f[1].length,t=t.replace(new RegExp("\\."+Array(c+1).join("0"),"g"),""));var p=t.split(";");p&&2===p.length&&(l=p[1]),n.pattern={negativeFormat:l,currency:d,precision:c,grouping:a,percentage:o}}else n.pattern=e.formatPattern,(n.pattern&&"datetime"===this.dataType||"time"===this.dataType)&&(-1!==n.pattern.indexOf("hide")||-1!==n.pattern.indexOf("medium"))&&delete n.pattern;return n},toJiveFormat:function(){if(this.has("pattern")){if("numeric"!==this.dataType)return this.get("pattern");var e=this.get("pattern"),n=r,i=e.negativeFormat||"-"+r;if(e.percentage&&(n+=" %",i+=" %"),e.currency&&t[e.currency]&&(n=t[e.currency]+" "+n,i=t[e.currency]+" "+i),e.grouping){var a=n.indexOf("#");n=n.slice(0,a)+"#,"+n.slice(a+1),a=i.indexOf("#"),i=i.slice(0,a)+"#,"+i.slice(a+1)}if(e.precision){var a=n.indexOf("##0");n=n.slice(0,a)+"##0."+Array(e.precision+1).join("0")+n.slice(a+3),a=i.indexOf("##0"),i=i.slice(0,a)+"##0."+Array(e.precision+1).join("0")+i.slice(a+3)}return n+";"+i}return""}})});