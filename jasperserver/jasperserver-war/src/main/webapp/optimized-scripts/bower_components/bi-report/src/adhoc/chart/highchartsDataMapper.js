!function(e,t){"function"==typeof define&&define.amd?define(["underscore","adhoc/chart/adhocDataProcessor","adhoc/chart/palette/defaultPalette","adhoc/chart/enum/dateTimeFormats","adhoc/chart/enum/adhocToHighchartsTypes","highcharts"],e):t.highchartsDataMapper=e(_,AdhocDataProcessor,hcDefaultPalette,hcDateTimeFormats,adhocToHighchartsTypes,Highcharts)}(function(e,t,a,i,r,s){var n=e.chain({}).extend(a).extend(i).value();return e.extend(n,{SeriesType:{COMMON:0,PIE:1,DUAL_LEVEL_PIE:2,HEAT_MAP:3,HEAT_MAP_TIME_SERIES:4},chartType:null,fullGroupHierarchyNames:!0,defaultPiesPerRow:8,maxPieRows:4,HEATMAP_LEGEND_TICK_INTERVAL:150,categories:[],categoryNames:{},groupedCategories:!1,highchartsCategories:[],measureMin:null,measureMax:null,getSeriesByType:function(e,a,i,r){var s,o;r.metadata.isOLAP?(s=t.getNodeListForDimLevelRadio(0,a),o=t.getNodeListForDimLevelRadio(1,i)):(s=t.getNodeListForSliderLevel(0,a),o=t.getNodeListForSliderLevel(1,i));var l;switch(e){case n.SeriesType.COMMON:l=n.getCommonSeries(s,o,r);break;case n.SeriesType.PIE:l=n.getPieSeries(s,o,a,i,r);break;case n.SeriesType.DUAL_LEVEL_PIE:l=n.getDualLevelPieSeries(s,o,a,i,r);break;case n.SeriesType.HEAT_MAP:l=n.getHeatMapOptions(s,o,r);break;case n.SeriesType.HEAT_MAP_TIME_SERIES:l=n.getHeatMapTimeSeriesOptions(s,o,r);break;default:throw"Unknown series type!"}return l},getColor:function(e){return n.colors[e%n.colors.length]},getColorWithAlpha:function(e,t){var a=n.rgbColors[e%n.colors.length];return"rgba("+a[0]+", "+a[1]+", "+a[2]+", "+t+")"},generateXAxisLabelsOptions:function(t){var a={step:t.step,maxStaggerLines:1,style:{fontSize:"1em"}};return 0!=t.rotation&&(e.extend(a,{rotation:t.rotation}),t.adjustPosition&&90===t.rotation?a.x=-4:270===t.rotation&&(a.x=4)),a},doAxisSwap:function(e){return-1!=e.indexOf("bar")},getLegendOptions:function(e){var t={borderWidth:e.chartState.legendBorder?1:0,itemStyle:{fontWeight:"normal",fontSize:"1em"}};switch(t.enabled="none"===e.chartState.legend?!1:n.isScatterOrBubbleChart(e.chartState.chartType)?!n.isTotalSelectedOnly(e,1):!0,e.chartState.legend){case"top":t.align="center",t.verticalAlign="top";break;case"left":case"right":t.align=e.chartState.legend,t.verticalAlign="middle",t.layout="vertical"}return t},getGeneralOptions:function(e){return{chart:{renderTo:"chartContainer",zoomType:"xy",type:n.adHocToHighchartsChartTypeMap[e.chartState.chartType],polar:n.isSpiderChart(e.chartState.chartType),style:{fontSize:"1em"}},credits:{enabled:!1},title:{text:null},tooltip:{valueDecimals:2,useHTML:!0,style:{fontSize:"1em"}}}},getCommonSeriesGeneralOptions:function(t){var a=n.doAxisSwap(t.chartState.chartType),i=e.extend(n.getGeneralOptions(t),{xAxis:n.getXAxisOptions(a,t),yAxis:n.isDualOrMultiAxisChart(t.chartState.chartType)?[]:n.getYAxisOptions(a,t),plotOptions:{series:{marker:{enabled:t.chartState.showDataPoints},tooltip:{dateTimeLabelFormats:t.isTimeSeries?n.getDateTimeLabelFormats(t.chartState.timeSeriesCategorizerName):void 0,xDateFormat:t.isTimeSeries?n.getDateTimeTooltipFormats(t.chartState.timeSeriesCategorizerName):void 0}}},series:[],legend:n.getLegendOptions(t)});return n._isTooltipFollowPointerEnabled(t.chartState.chartType)&&(i.tooltip.followPointer=!0),i.tooltip.shared=n.isDualOrMultiAxisChart(t.chartState.chartType)||n.isSpiderChart(t.chartState.chartType)?!0:!1,i},isTotalSelectedOnly:function(t,a){var i=0==a?t.chartState.rowsSelectedLevels:t.chartState.columnsSelectedLevels,r=!0;return t.metadata.isOLAP?e.each(i,function(e){"(All)"!=e.name&&(r=!1)}):r=0==i.length,r},getXAxisOptions:function(e,t){var a={categories:[],title:{text:n.isScatterOrBubbleChart(t.chartState.chartType)?t.metadata.measures[0]:""}};return n.isSpiderChart(t.chartState.chartType)&&(a.tickmarkPlacement="on",a.lineWidth=0),a.labels=n.generateXAxisLabelsOptions({rotation:e?t.chartState.yAxisRotation:t.chartState.xAxisRotation,adjustPosition:!e,step:e?t.chartState.yAxisStep:t.chartState.xAxisStep}),e&&Math.abs(t.chartState.xAxisRotation)>=75&&(a.labels.align="right"),a.offset=Math.abs(t.chartState.xAxisRotation)>60?5:0,t.isTimeSeries&&(a.dateTimeLabelFormats=n.getDateTimeLabelFormats(t.chartState.timeSeriesCategorizerName),a.type="datetime"),a},getYAxisOptions:function(e,t){var a={title:{text:" "},labels:{rotation:e?t.chartState.xAxisRotation:t.chartState.yAxisRotation,step:e?t.chartState.xAxisStep:t.chartState.yAxisStep,style:{fontSize:"1em"}}};return n.isScatterOrBubbleChart(t.chartState.chartType)?a.title.text=t.metadata.measures[1]:t.chartState.showMeasureOnValueAxis&&1==t.metadata.measures.length&&(a.title.text=t.metadata.measures[0]),n.isSpiderChart(t.chartState.chartType)&&(a.gridLineInterpolation="polygon",a.lineWidth=0,a.min=0,a.labels.rotation>0&&(a.labels.x=-(a.labels.rotation/90*10))),a},getDateTimeLabelFormats:function(e){return n.dateTimeLabelFormatsMap[e]},getDateTimeTooltipFormats:function(e){return n.dateTimeTooltipFormatsMap[e]},getCommonSeries:function(e,t,a){var i=a.isTimeSeries,r=a.chartState.chartType;n.groupedCategories=!1,n.highchartsCategories=[],n.measureMin=null,n.measureMax=null;var s=this.getCommonSeriesGeneralOptions(a);return n.setupOptionsSeries(t,s,r,a),n.setupOptionsYAxis(t,s,r,a),n.populateOptionsDataAndCategories(e,t,s,r,i,a),n.setCategories(s,i||n.isScatterOrBubbleChart(r),r),s},setupOptionsSeries:function(e,t,a,i){for(var r=n.isScatterOrBubbleChart(a),s=i.metadata.measures.length,o=r?e.length/s:e.length,l=0;o>l;l++){var u,c=r&&!n._isMeasureFirst(i.metadata)?e[l*s]:e[l],h=n.assembleFullGroupLinearName(1,c,i),p=l==o-1;if(n.isScatterOrBubbleChart(a)){var m=(i.chartState.columnsSelectedLevels.length>0,i.chartState.rowsSelectedLevels.length>0);u={headerFormat:m?"{point.key}<br/>":"",pointFormat:n.constructTooltipPointFormat(a,i),followPointer:!0}}t.series.push({name:h,data:[],color:r?n.getColorWithAlpha(l,.75):n.getColor(l),type:n.isDualOrMultiAxisChart(a)?n.getDualOrMultiAxisHighchartsType(a,p):void 0,yAxis:n.isMultiAxisChart(a)?l:0,tooltip:u})}},constructTooltipPointFormat:function(e,t){var a=t.chartState.columnsSelectedLevels.length>0,i=n.isTotalSelectedOnly(t,1),r="";return a&&!i&&(r+='<span style="color:{series.color}">{series.name}</span> <br/>'),r+=t.metadata.measures[0]+" : <b>{point.x:,.2f}</b><br/>"+t.metadata.measures[1]+" : <b>{point.y:,.2f}</b>"+(n.isBubbleChart(e)?"<br/>"+t.metadata.measures[2]+" : <b>{point.z:,.2f}</b> ":"")},setupOptionsYAxis:function(e,t,a,i){if(n.isDualAxisChart(a)){t.series[e.length-1].yAxis=1;var r=i.chartState.showMeasureOnValueAxis&&2==t.series.length?t.series[0].name:"";t.yAxis.push(n.getYAxisForDualOrMultiAxisChart(i,0,r)),t.yAxis.push(n.getYAxisForDualOrMultiAxisChart(i,e.length-1,t.series[e.length-1].name))}else if(n.isMultiAxisChart(a))for(var s=0;s<e.length;s++)t.yAxis.push(n.getYAxisForDualOrMultiAxisChart(i,s,t.series[s].name))},populateOptionsDataAndCategories:function(t,a,i,r,s,o){for(var l=n.isScatterOrBubbleChart(r),u=o.metadata.measures.length,c=l?a.length/u:a.length,h=0;h<t.length;h++){for(var p=t[h],m=0;c>m;m++){var g=i.series[m];if(l){var d=[];if(n._isMeasureFirst(o.metadata))for(var x=0;u>x;x++){var y=n.getDataValue(p,a[m+x*c],!0);d.push(y)}else for(var f=0;u>f;f++)d.push(n.getDataValue(p,a[m*u+f],!0));var M=e.every(d,function(e){return null==e});if(!M){d=e.map(d,function(e){return null==e?0:e}),n.measureMinMax(d[0]),n.measureMinMax(d[1]);var S;if(n.isScatterChart(r))S={x:d[0],y:d[1],name:n.assembleFullGroupHierarchyName(0,p,o)};else{if(!n.isBubbleChart(r))throw"Unexpected chart type";S={x:d[0],y:d[1],z:d[2],name:n.assembleFullGroupHierarchyName(0,p,o)}}g.data.push(S)}}else{var T=n.getDataValue(p,a[m],s);s?null!=T.value&&null!=T.timestamp&&(n.measureMinMax(T.value),g.data.push([T.timestamp,T.value])):(n.measureMinMax(T),g.data.push(T))}}if(!s&&!l){var b=n.assembleFullGroupHierarchyName(0,p,o);i.xAxis.categories.push(b)}}if(n.isScatterOrBubbleChart(r)){var C=1e3;e.each(i.series,function(e){C=Math.max(C,e.data.length)}),i.plotOptions.series.turboThreshold=C}n.isBubbleChart(r)&&1===c&&(i.xAxis.startOnTick=!0,i.xAxis.endOnTick=!0)},getYAxisForDualOrMultiAxisChart:function(e,t,a){var i=n.getYAxisOptions(n.doAxisSwap(e.chartState.chartType),e);return i.opposite=0!=t,i.labels.style={color:n.getColor(t),fontSize:"1em"},i.title={text:a,style:{color:n.getColor(t)}},i.opposite===!1&&(i.offset=Math.abs(e.chartState.yAxisRotation)>60?5:0),i},setCategories:function(e,t,a){t?e.xAxis.categories=void 0:n.groupedCategories&&this.areCategoriesSupported(a)&&(e.xAxis.categories=n.highchartsCategories)},areCategoriesSupported:function(e){return-1==e.indexOf("spider")&&(e.indexOf("column")>=0||e.indexOf("area")>=0||e.indexOf("line")>=0||e.indexOf("spline")>=0)},getPieSeries:function(a,i,r,s,o){n.measureMin=null,n.measureMax=null;var l,u=(e.isArray(s)?s.length:s)+o.metadata.measureAxis,c=15,h=10,p=c*u+h,m=o.width,g=o.height,d=t.getDataStyle(),x=e.extend(n.getGeneralOptions(o),{xAxis:{categories:[]},plotOptions:{pie:{slicedOffset:0,point:{events:{legendItemClick:n._getLegendItemClickHandler}}}},series:[],labels:{items:[]},legend:n.getLegendOptions(o)});if(0==d)if(o.metadata.axes[0].length>0){var y=i[0],f=1,M=f+1,S=100/M,T=S,b=50,C=[],A=T+"%",O=b+"%";C.push(A),C.push(O);var v=t.getMessage("totalsLabelForChart");o.metadata.measures[0].name&&(v=o.metadata.measures[0].name),x.series.push({type:"pie",name:v,data:[],center:C,size:2*S+"%",showInLegend:!0,dataLabels:{enabled:!1}});for(var _=0;_<a.length;_++){var L=a[_],P=n.getDataValue(L,y);n.measureMinMax(P),l=n.assembleFullGroupLinearName(0,L,o),x.series[0].data.push([l,P])}}else{var D=a[0],k=o.metadata.axes[1].length<=1?!0:!1,H=t.isMeasuresLastOnAxis(1),N=o.metadata.measures.length,f=1;k||(f=H?i.length/N:i.length);for(var B=n.getSquareSideLength(f,m,g),F=0;f>F;F++){var w=n.computePieParams(F+1,B,m,g,p,f),E=F;if(l=t.getMessage("allLabelForChart"),!k)if(H){E=F*N;var I=i[E];l=I.parent.label}else l=i[F].label;var C=[],A=w.xAxisPositionPercent+"%",O=w.yAxisPositionPercent+"%";C.push(A),C.push(O);var E=F;H&&(k||(E=F*N));var z=F>0?!1:!0;x.series.push({type:"pie",name:i[E].label,data:[],center:C,size:w.pieSizePercent+"%",showInLegend:z,dataLabels:{enabled:!1},title:{text:l,verticalAlign:"top",y:-p}})}if(k)for(var _=0;_<i.length;_++){var G=i[_],P=n.getDataValue(D,G);n.measureMinMax(P),l=n.assembleFullGroupLinearName(1,G,o),x.series[0].data.push([l,P])}else if(H)for(var V=(i[0].label,0),R=0,_=0;_<i.length;_++){var G=i[_];if(R++,R>N){if(V++,V>=f)throw"highchart.datamapper getPieSeries: exceeded numberOfPies="+numberOfPies;R=1}var P=n.getDataValue(D,G);n.measureMinMax(P),l=G.label,x.series[V].data.push([l,P])}else for(var _=0;_<i.length;_++){var G=i[_],P=n.getDataValue(D,G);n.measureMinMax(P),l=n.assembleFullGroupHierarchyName(1,G,o),x.series[_].data.push([l,P])}}if(2==d||1==d){for(var B=n.getSquareSideLength(i.length,m,g),F=0;F<i.length;F++){var w=n.computePieParams(F+1,B,m,g,p,i.length),U=i[F].label,l=n.assembleFullGroupHierarchyName(1,i[F],o),j=U,C=[],A=w.xAxisPositionPercent+"%",O=w.yAxisPositionPercent+"%";C.push(A),C.push(O);var z=F>0?!1:!0;x.series.push({type:"pie",name:j,data:[],center:C,size:w.pieSizePercent+"%",showInLegend:z,dataLabels:{enabled:!1},title:{text:l,verticalAlign:"top",y:-p}})}for(var _=0;_<i.length;_++)for(var G=i[_],W=0;W<a.length;W++){var L=a[W],P=n.getDataValue(L,G);n.measureMinMax(P),l=n.assembleFullGroupLinearName(0,L,o),x.series[_].data.push([l,P])}}return x},getDualLevelPieSeries:function(a,i,r,o,l){n.measureMin=null,n.measureMax=null;var u,c,h,p,m,g=[],d=i[0],x="(empty axis)"===d.label?"Value":d.label,y=n.colors,f=y.length,M=0,S=-1,T=1e3;l.metadata.isOLAP?"(All)"!==l.metadata.axes[0][0].name&&(r[0].level-=1,g=t.getNodeListForDimLevelRadio(0,r)):n._isMeasureFirst(l.metadata)&&(g=t.getNodeListForSliderLevel(0,r-1));var b=e.extend(n.getGeneralOptions(l),{xAxis:{categories:[]},plotOptions:{pie:{slicedOffset:0,point:{events:{legendItemClick:n._getLegendItemClickHandlerDisabled}}}},series:[],labels:{items:[]},legend:n.getLegendOptions(l)});b.series.push({name:x,data:[],center:["50%","50%"],size:"60%",showInLegend:!1,dataLabels:{color:"white",distance:-30,style:{fontSize:"1em"}}});for(var C=0;C<g.length;C++)p=g[C],c=n.getDataValue(p,i[0]),u=n.assembleFullGroupLinearName(0,p,l),p.parent.color=y[C%f],b.series[0].data.push({name:u,y:c,color:y[C%f]});if(0===b.series[0].data.length)var A=!0;b.series.push({name:x,data:[],center:["50%","50%"],size:"90%",innerSize:"60%",showInLegend:!0,dataLabels:{enabled:!1,style:{fontSize:"1em"}}});for(var C=0;C<a.length;C++)h=a[C],h===h.parent.children[0]||l.metadata.isOLAP&&h===h.parent.children[0].children[0]?(M=0,S++,A&&(b.series[0].data.push({name:n.assembleFullGroupLinearName(0,h.parent,l),y:0,color:y[S%f]}),h.parent.color=y[S%f])):M++,c=n.getDataValue(h,d),u=n.assembleFullGroupLinearName(0,h,l),m=.2-M/h.parent.children.length/5,b.series[1].data.push({name:u,y:c,color:s.Color(h.parent.color||y[0]).brighten(m).get()}),A&&(b.series[0].data[S].y+=c);return a.length||(b.series[0].data=[]),e.each(b.series,function(e){T=Math.max(T,e.data.length)}),b.plotOptions.pie.turboThreshold=T,b},getCommonHeatMapOptions:function(t,a,i,r){{var o=n.getCommonSeriesGeneralOptions(i);e.include(["bottom","top"],i.chartState.legend)}return o=e.extend(o,{colorAxis:e.extend(e.clone(n.colorAxis),{labels:{style:{fontSize:"1em"}},tickPixelInterval:n.HEATMAP_LEGEND_TICK_INTERVAL}),series:[{borderWidth:1,data:[],dataLabels:{enabled:!1}}],tooltip:{valueDecimals:2,formatter:function(){return this.series.yAxis.categories[this.point.y]+", "+this.series.xAxis.categories[this.point.x]+"<br/>"+a[0].label+": <b>"+(r&&null===this.point.value?null:s.numberFormat(this.point.value,2))+"</b>"},useHTML:!0,style:{fontSize:"1em"}}}),o.yAxis.title=null,o.xAxis.gridLineWidth=o.yAxis.gridLineWidth=r?0:1,o},getHeatMapOptions:function(e,t,a){var i=!0;n.measureMin=null,n.measureMax=null;var r=n.getCommonHeatMapOptions(e,t,a,i),s=n.computeHeatMapMatrixData(e,t,i);return r.series[0].data=s.data,r.xAxis.categories=s.xCategories,r.yAxis.categories=s.yCategories,1!==s.xCategories.length&&(r.xAxis.minRange=1),1!==s.yCategories.length&&(r.yAxis.minRange=1),r.colorAxis.min=n.measureMin,r.colorAxis.max=n.measureMax,r.plotOptions.series.turboThreshold=Math.max(r.series[0].data.length,1e3),r},computeHeatMapMatrixData:function(t,a,i){var r,s,o=!1,l={data:[],xCategories:[],yCategories:[]};return e.each(a,function(a,u){s=a.parent,l.xCategories.push(s.label),e.each(t,function(e,t){o||l.yCategories.push(e.label),r=n.getDataValue(e,s.children[0],!0),(null!==r||i)&&(n.measureMinMax(r),l.data.push([u,t,r]))}),o=!0}),l},getHeatMapTimeSeriesOptions:function(t,a,i){var r=!0,o=n.getCommonHeatMapOptions(t,a,i,r);if(!t.length)return o;var l,u,c,h,p={},m=new Date,g={},d=864e5,x=n.getDataValue(t[0],a[0]);n.measureMin=n.measureMax=x.value,l=u=x.timestamp,e.each(t,function(e){var t=n.getDataValue(e,a[0],!0),i=t.value;p[t.timestamp]=i,l=Math.min(l,t.timestamp),u=Math.max(u,t.timestamp),n.measureMinMax(i)});var y=new Date(u);m.setTime(l);do{if(p.hasOwnProperty(m.getTime()))c=p[m.getTime()];else{if(!r){m.setUTCHours(m.getUTCHours()+1);continue}c=null}h=m.getUTCHours(),g[h]=!0,m.setUTCHours(0),o.series[0].data.push([m.getTime(),h,c]),m.setUTCHours(h+1)}while(y>=m);o.colorAxis.min=n.measureMin,o.colorAxis.max=n.measureMax,g=e.map(g,function(e,t){return parseInt(t,10)}),o.yAxis=e.extend(o.yAxis,{startOnTick:!1,endOnTick:!1,reversed:!0,tickPositioner:function(e,t){return g.slice(Math.round(e),Math.round(t)+1)},minRange:8,labels:e.extend(o.yAxis.labels,{format:"{value}:00"})}),o.series[0].name=a[0].label,o.series[0].colsize=d,o.series[0].borderWidth=0,m.setTime(l),m.setUTCHours(0),o.xAxis.min=m.getTime(),m.setTime(u),m.setUTCHours(0),o.xAxis.max=m.getTime(),o.xAxis.minRange=30*d,o.xAxis.type="datetime",o.xAxis.categories=null,o.xAxis.endOnTick=!1,o.xAxis.labels=e.extend(o.xAxis.labels,{format:"{value:%B}"}),o.xAxis.tickPositions=[],m.setTime(l);do o.xAxis.tickPositions.push(m.getTime()),1!==m.getUTCDate()&&m.setUTCDate(1),m.setUTCMonth(m.getUTCMonth()+1);while(m.getTime()<=u);return o.tooltip=e.extend(o.tooltip,{backgroundColor:null,borderWidth:0,shadow:!1,useHTML:!0,style:{padding:0,color:"black",fontSize:"1em"},formatter:function(){return'<span style="color:{series.color}">●</span> '+a[0].label+"<br/>"+s.dateFormat("%e %b %Y",this.point.x)+" "+this.point.y+":00 <b>"+(r&&null===this.point.value?null:s.numberFormat(this.point.value,2))+"</b>"}}),o.plotOptions.series.turboThreshold=Math.max(o.series[0].data.length,1e3),o.chart.isHeatMapTimeSeriesChart=!0,o},_getLegendItemClickHandler:function(t){t.preventDefault();var a=e.flatten(e.pluck(this.series.chart.series,"data")),i=this;e.each(a,function(e){e.name==i.name&&e.setVisible(!e.visible)})},_getLegendItemClickHandlerDisabled:function(e){e.preventDefault()},getSquareSideLength:function(e,t,a){if(e>t*a)return 0;var i=a/t,r=Math.sqrt(e/i),s=r*i,n=Math.max(1,Math.floor(r)),o=Math.max(1,Math.floor(s)),l=Math.floor(t/n),u=Math.floor(a/o),c=Math.min(l,u);if(n=Math.floor(t/c),o=Math.floor(a/c),e>n*o)if(e>(n+1)*o&&e>n*(o+1))l=Math.floor(t/(n+1)),u=Math.floor(a/(o+1)),c=Math.min(l,u);else{var h=Math.ceil(e/o),p=Math.ceil(e/n);l=Math.min(Math.floor(t/h),Math.floor(a/o)),u=Math.min(Math.floor(t/n),Math.floor(a/p)),c=Math.max(l,u)}return c},computePieParams:function(e,t,a,i,r,s){var n=10,o=5,l=Math.min(Math.floor(a/t),s),u=Math.min(Math.floor(i/t),s),c=(a-t*l)/l,h=(i-t*u)/u,p=e%l==0?l:e%l,m=Math.floor(e/l)+(e%l==0?0:1),g=t*p-t/2+c*p/2,d=t*m-t/2+h*m/2,x=r+n;return{xAxisPositionPercent:100*(g-x/2)/a,yAxisPositionPercent:100*(d+x/2+o)/i,pieSizePercent:100*(t-x)/a}},measureMinMax:function(e){null!==e&&(null===n.measureMin?(n.measureMin=e,n.measureMax=e):(n.measureMin=Math.min(e,n.measureMin),n.measureMax=Math.max(e,n.measureMax)))},yAxisTickAdjust:function(t){if(!(n.measureMin<0)&&t.yAxis){var a=e.isArray(t.yAxis)?t.yAxis:[t.yAxis];0!=n.measureMin&&n.measureMin--,e.each(a,function(e){e.min||(e.min=n.measureMin,e.startOnTick=!0)})}},assembleFullGroupName:function(e,a,i,r){var s=r.chartState.chartType,o="",l=t.getLabelNameArray(e,a);if(1==e&&n.isScatterOrBubbleChart(s)&&(n._isMeasureFirst(r.metadata)?l.pop():l.shift()),!r.chartState.showSingleMeasuresLabels&&1===r.metadata.measures.length&&r.metadata.measureAxis===e){l=l.reverse();for(var u=0,c=r.metadata.axes[r.metadata.measureAxis].length;c>u;u++)"Measures"===r.metadata.axes[r.metadata.measureAxis][u].dimension&&(u<l.length?l.splice(u,1):l.pop());l=l.reverse(),l.length||l.push(" ")}var h="<br>";n.isBarChart(s)?(l=l.reverse(),h=", "):n.isScatterOrBubbleChart(s)&&(h=", ");for(var p=l.length,m=0;p>m;m++)o+=l[m],p-1>m&&(o+=i?h:", ");return 0==e&&p>1&&(n.groupedCategories=!0,n.addLeaf2HighchartsCategory(l)),o},assembleFullGroupHierarchyName:function(e,t,a){return n.assembleFullGroupName(e,t,!0,a)},assembleFullGroupLinearName:function(e,t,a){return n.assembleFullGroupName(e,t,!1,a)},addLeaf2HighchartsCategory:function(e){if(null==n.highchartsCategories&&(n.highchartsCategories=[]),e.length<=1)return void n.highchartsCategories.push(e[0]);for(var t=n.highchartsCategories,a=e.length-1;a>=0;a--){var i=e[a];if(0==a)return void t.push(i);for(var r=null,s=0;s<t.length;s++)t[s].name===e[a]&&(r=t[s]);null==r&&(r={name:e[a],categories:[]},t.push(r)),t=r.categories}},getDataValue:function(e,a,i){var r=t.getDataFromRowColumn(e,a);return i?r:null==r?0:r}}),e.extend(n,{_isTooltipFollowPointerEnabled:function(t){return!e.contains(["line","spline","area","stacked_area","percent_area","spline_area","line_time_series","spline_time_series","area_time_series","spline_area_time_series","pie","dual_level_pie","heat_map","heat_map_time_series"],t)},_isMeasureFirst:function(e){var t=e.axes[e.measureAxis];return t.length>0&&"Measures"==t[0].dimension}}),e.extend(n,{isDualOrMultiAxisChart:function(e){return n.isDualAxisChart(e)||n.isMultiAxisChart(e)},isDualLevelPieChart:function(e){return"dual_level_pie"===e},isSpiderChart:function(t){return e.contains(["spider_column","spider_line","spider_area"],t)},isDualAxisChart:function(t){return e.contains(["column_line","column_spline","stacked_column_line","stacked_column_spline"],t)},isMultiAxisChart:function(t){return e.contains(["multi_axis_line","multi_axis_spline","multi_axis_column"],t)},isScatterChart:function(t){return e.contains(["scatter"],t)},isBubbleChart:function(t){return e.contains(["bubble"],t)},isScatterOrBubbleChart:function(e){return n.isScatterChart(e)||n.isBubbleChart(e)},isBarChart:function(e){return-1!=e.indexOf("bar")},isHeatMapChart:function(e){return"heat_map"===e},isHeatMapTimeSeriesChart:function(e){return"heat_map_time_series"===e}}),e.extend(n,{getHighchartsOptions:function(t,a,i,r){var s=n.typeToOptionsMap[t](a,i,r);n.defaultPlotShadow(s,!n.isDualLevelPieChart(t)&&!n.isHeatMapChart(t)&&!n.isBubbleChart(t));var o=function(a){var i=n.isSpiderChart(t)||n.isBarChart(t)?150:29;if(a.length>0)if(e.isObject(a[0]))e.each(a,function(e){e.name=e.name.substring(0,i),e.categories&&o(e.categories)});else for(var r=0;r<a.length;r++)a[r]=a[r].substring(0,i)};return e.each(["xAxis","yAxis"],function(t){var a=e.isArray(s[t])?s[t]:[s[t]];e.each(a,function(e){e&&e.categories&&o(e.categories)})}),n.isSpiderChart(t)&&(s.chart.spacingTop=1.8*(s.xAxis.categories[0].split("<br>").length-1),s.chart.spacingTop*=8*(1+Math.abs(Math.sin((s.xAxis.labels.rotation||0)*Math.PI/180)))),s.colors=n.colors,s},defaultPlotShadow:function(t,a){var i=t.plotOptions,r=t.chart?t.chart.type:void 0,s=r?[r]:[];0==s.length&&(s=e.pluck(t.series,"type")),i||(i={}),e.each(s,function(e){i[e]||(i[e]={}),i[e].shadow=a})},typeToOptionsMap:{column:function(e,t,a){return n.getSeriesByType(n.SeriesType.COMMON,e,t,a)},stacked_column:function(e,t,a){var i=n.getSeriesByType(n.SeriesType.COMMON,e,t,a);return i.plotOptions.series.stacking="normal",i},percent_column:function(e,t,a){var i=n.getSeriesByType(n.SeriesType.COMMON,e,t,a);return i.plotOptions.series.stacking="percent",i},bar:function(e,t,a){return n.getSeriesByType(n.SeriesType.COMMON,e,t,a)},stacked_bar:function(e,t,a){var i=n.getSeriesByType(n.SeriesType.COMMON,e,t,a);return i.plotOptions.series.stacking="normal",i},percent_bar:function(e,t,a){var i=n.getSeriesByType(n.SeriesType.COMMON,e,t,a);return i.plotOptions.series.stacking="percent",i},spider_column:function(e,t,a){var i=n.getSeriesByType(n.SeriesType.COMMON,e,t,a);return i.plotOptions.series.pointPlacement="on",i},line:function(e,t,a){var i=n.getSeriesByType(n.SeriesType.COMMON,e,t,a);return n.yAxisTickAdjust(i),i},area:function(e,t,a){return n.getSeriesByType(n.SeriesType.COMMON,e,t,a)},spline_area:function(e,t,a){return n.getSeriesByType(n.SeriesType.COMMON,e,t,a)},stacked_area:function(e,t,a){var i=n.getSeriesByType(n.SeriesType.COMMON,e,t,a);return i.plotOptions.series.stacking="normal",i},percent_area:function(e,t,a){var i=n.getSeriesByType(n.SeriesType.COMMON,e,t,a);return i.plotOptions.series.stacking="percent",i},spider_line:function(e,t,a){var i=n.getSeriesByType(n.SeriesType.COMMON,e,t,a);return i.plotOptions.series.pointPlacement="on",i},spider_area:function(e,t,a){var i=n.getSeriesByType(n.SeriesType.COMMON,e,t,a);return i.plotOptions.series.pointPlacement="on",i},pie:function(e,t,a){return n.getSeriesByType(n.SeriesType.PIE,e,t,a)},dual_level_pie:function(e,t,a){return n.getSeriesByType(n.SeriesType.DUAL_LEVEL_PIE,e,t,a)},spline:function(e,t,a){var i=n.getSeriesByType(n.SeriesType.COMMON,e,t,a);return n.yAxisTickAdjust(i),i},line_time_series:function(e,t,a){a.isTimeSeries=!0;var i=n.getSeriesByType(n.SeriesType.COMMON,e,t,a);return n.yAxisTickAdjust(i),i},spline_time_series:function(e,t,a){a.isTimeSeries=!0;var i=n.getSeriesByType(n.SeriesType.COMMON,e,t,a);return n.yAxisTickAdjust(i),i},area_time_series:function(e,t,a){return a.isTimeSeries=!0,n.getSeriesByType(n.SeriesType.COMMON,e,t,a)},spline_area_time_series:function(e,t,a){return a.isTimeSeries=!0,n.getSeriesByType(n.SeriesType.COMMON,e,t,a)},column_line:function(e,t,a){var i=n.getSeriesByType(n.SeriesType.COMMON,e,t,a);return n.yAxisTickAdjust(i),i},column_spline:function(e,t,a){var i=n.getSeriesByType(n.SeriesType.COMMON,e,t,a);return n.yAxisTickAdjust(i),i},stacked_column_line:function(e,t,a){var i=n.getSeriesByType(n.SeriesType.COMMON,e,t,a);return i.plotOptions.series.stacking="normal",n.yAxisTickAdjust(i),i},stacked_column_spline:function(e,t,a){var i=n.getSeriesByType(n.SeriesType.COMMON,e,t,a);return i.plotOptions.series.stacking="normal",n.yAxisTickAdjust(i),i},multi_axis_line:function(e,t,a){var i=n.getSeriesByType(n.SeriesType.COMMON,e,t,a);return n.yAxisTickAdjust(i),i},multi_axis_spline:function(e,t,a){var i=n.getSeriesByType(n.SeriesType.COMMON,e,t,a);return n.yAxisTickAdjust(i),i},multi_axis_column:function(e,t,a){return n.getSeriesByType(n.SeriesType.COMMON,e,t,a)},scatter:function(e,t,a){var i=n.getSeriesByType(n.SeriesType.COMMON,e,t,a);return n.yAxisTickAdjust(i),i},bubble:function(e,t,a){return n.getSeriesByType(n.SeriesType.COMMON,e,t,a)},heat_map:function(e,t,a){return n.getSeriesByType(n.SeriesType.HEAT_MAP,e,t,a)},heat_map_time_series:function(e,t,a){return n.getSeriesByType(n.SeriesType.HEAT_MAP_TIME_SERIES,e,t,a)}},adHocToHighchartsChartTypeMap:r,getDualOrMultiAxisHighchartsType:function(e,t){var a,i={column_line:"column",column_spline:"column",stacked_column_line:"column",stacked_column_spline:"column"},r={column_line:"line",column_spline:"spline",stacked_column_line:"line",stacked_column_spline:"spline"},s={multi_axis_line:"line",multi_axis_spline:"spline",multi_axis_column:"column"};if(n.isDualAxisChart(e))a=t?r[e]:i[e];else{if(!n.isMultiAxisChart(e))throw"Unsupported chart type [chartType="+e+"]";a=s[e]}return a}}),{getHighchartsOptions:n.getHighchartsOptions,isDualOrMultiAxisChart:n.isDualOrMultiAxisChart,isDualAxisChart:n.isDualAxisChart,isMultiAxisChart:n.isMultiAxisChart,isScatterChart:n.isScatterChart,isBubbleChart:n.isBubbleChart,isScatterOrBubbleChart:n.isScatterOrBubbleChart,isBarChart:n.isBarChart,isSpiderChart:n.isSpiderChart,isDualLevelPieChart:n.isDualLevelPieChart,isHeatMapChart:n.isHeatMapChart,isHeatMapTimeSeriesChart:n.isHeatMapTimeSeriesChart,_getLegendItemClickHandler:n._getLegendItemClickHandler,_getLegendItemClickHandlerDisabled:n._getLegendItemClickHandlerDisabled,_HDM:n}},this);