define(["require","backbone","../enum/reportStatuses","json3"],function(t){var e=t("backbone"),r=t("../enum/reportStatuses"),a=t("json3"),s="{contextPath}/rest_v2/reportExecutions/{reportExecutionId}/exports/{exportExecutionId}/attachments/";return e.Model.extend({defaults:function(){return{reportUnitUri:void 0,async:!0,allowInlineScripts:!1,markupType:"embeddable",outputFormat:void 0,interactive:!0,freshData:!1,saveDataSnapshot:!1,transformerKey:null,pages:1,attachmentsPrefix:void 0,baseUrl:void 0,parameters:void 0}},urlRun:function(){var t=this.get("baseUrl");return"/"!==t[t.length-1]&&(t+="/"),t+="rest_v2/reportExecutions"},urlUpdate:function(){if(!this.report.has("requestId"))throw new Error("You must execute report before requesting it's execution details or status.");return this.urlRun()+"/"+this.report.get("requestId")},urlParameters:function(t){return this.urlUpdate()+"/parameters?freshData="+!!t},urlStatus:function(){return this.urlUpdate()+"/status"},initialize:function(t,e){e||(e={}),this.report=e.report,this.on("change:baseUrl",function(){this.set("attachmentsPrefix",s.replace("{contextPath}",this.get("baseUrl")))},this)},run:function(){return e.ajax({url:this.urlRun(),type:"POST",processData:!1,dataType:"json",contentType:"application/json",headers:{Accept:"application/json","x-jrs-base-url":this.get("baseUrl")},data:a.stringify(this.toJSON())})},status:function(){return e.ajax({type:"GET",url:this.urlStatus(),dataType:"json",contentType:"application/json",headers:{Accept:"application/status+json","x-jrs-base-url":this.get("baseUrl")}})},update:function(){return e.ajax({url:this.urlUpdate(),type:"GET",dataType:"json",contentType:"application/json",headers:{Accept:"application/json","x-jrs-base-url":this.get("baseUrl")}})},cancel:function(){return e.ajax({url:this.urlStatus(),type:"PUT",dataType:"json",contentType:"application/json",headers:{Accept:"application/json","x-jrs-base-url":this.get("baseUrl")},data:a.stringify({value:r.CANCELLED})})},applyParameters:function(t){return e.ajax({url:this.urlParameters(t),type:"POST",dataType:"json",contentType:"application/json",headers:{Accept:"application/json","x-jrs-base-url":this.get("baseUrl")},data:a.stringify(this.has("parameters")?this.get("parameters").reportParameter:[])})}})});