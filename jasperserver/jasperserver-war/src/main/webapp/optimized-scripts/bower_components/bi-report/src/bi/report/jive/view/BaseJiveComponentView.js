define(["require","backbone","jquery","underscore","logger"],function(e){var o=e("backbone"),t=e("jquery"),n=e("underscore"),i=e("logger").register("Report");return o.View.extend({initialize:function(e){this.stateModel=e.stateModel,this.report=e.report,this.model.has("module")&&this._discoverModuleType(),this.listenTo(this.model,"change:module",n.bind(this._discoverModuleType,this)),i.debug("Create jive view",this)},render:function(e){var o,i=new t.Deferred;return this.model.collection?(this.model.has("moduleType")?this._renderComponent(e).done(function(){i.resolve()}):(o=new t.Deferred,o.done(n.bind(function(){this._renderComponent(e).done(function(){i.resolve()})},this)),this.model.once("change:moduleType",o.resolve,o)),i):(i.resolve(),i)},_renderComponent:function(e){var o=this.model.get("moduleType"),i=new t.Deferred,r=this.model.collection?this.model.collection.linkOptions:null;return this.component=new o(r?n.extend(this.model.toJSON(),{linkOptions:r}):this.model.toJSON(),e),this.component.render?(this.component.render(e),this.component.rdy?this.component.rdy.done(function(){i.resolve()}):i.resolve()):i.resolve(),i},_getModulesToLoad:function(){function e(e){return 0===e.indexOf("jive")||0===e.indexOf("adhocHighchartsSettingService")||e.indexOf("defaultSettingService")?"../jr/"+e:e}var o=[];return this.model.has("module")&&(o.push(e(this.model.get("module"))),this.model.has("uimodule")&&this.stateModel.isDefaultJiveUiEnabled()&&o.push(e(this.model.get("uimodule")))),o},_discoverModuleType:function(){var o=this,t=this._getModulesToLoad();e(t,function(e,t){var n={};e&&(n.moduleType=e),t&&(n.uiModuleType=t),o.model.set(n)})},remove:function(){o.View.prototype.remove.apply(this,arguments)}})});