define(["require","dataSource/model/CustomDataSourceModel","dataSource/enum/connectionTypes","dataSource/enum/mongoJdbcFileSourceTypes","common/enum/repositoryResourceTypes","restResource!hypermedia/workflows?parentName=admin","jrs.configs","underscore","bundle!jasperserver_messages"],function(e){"use strict";var r=e("dataSource/model/CustomDataSourceModel"),o=(e("dataSource/enum/connectionTypes"),e("dataSource/enum/mongoJdbcFileSourceTypes")),t=(e("common/enum/repositoryResourceTypes"),e("restResource!hypermedia/workflows?parentName=admin")),i=(e("jrs.configs"),e("underscore")),n=e("bundle!jasperserver_messages"),a=r.extend({fileTypes:["pdf","config"],defaults:function(){var e={};return i.extend(e,r.prototype.defaults,{dataSourceName:"mongoDbJDBCDataSource",fileSourceType:"repository"}),e}(),validation:function(){var e={};return i.extend(e,r.prototype.validation,{serverAddress:[{required:!0,msg:n["ReportDataSourceValidator.error.not.empty.host"]}],portNumber:[{required:!0,msg:n["ReportDataSourceValidator.error.not.empty.server.port"]}],repositoryFileName:[{fn:function(e,r,o){return"repository"===o.fileSourceType&&(i.isNull(e)||i.isUndefined(e)||i.isString(e)&&""===e)?n["fillParameters.error.mandatoryField"]:null}},{fn:function(e,r,o){return"repository"!==o.fileSourceType||i.isString(e)&&""!==e&&0===e.indexOf("/")?null:n["resource.file.invalid.path"]}}],serverFileName:[{fn:function(e,r,o){return"serverFileSystem"===o.fileSourceType&&(i.isNull(e)||i.isUndefined(e)||i.isString(e)&&""===e)?n["fillParameters.error.mandatoryField"]:null}}]}),e}(),isLocalFileSystemAccessAllowed:function(){return t&&t._embedded&&t._embedded.workflow&&i.find(t._embedded.workflow,function(e){return"serverSettings"===e.name})},parse:function(){var e=r.prototype.parse.apply(this,arguments);if(i.isString(e.fileName)){if(-1!==e.fileName.indexOf("repo:")){var t=e.fileName.split(":");e.fileSourceType=o.REPOSITORY.name,e.repositoryFileName=t[1]}else e.fileSourceType=o.SERVER_FILE_SYSTEM.name,e.serverFileName=e.fileName;delete e.fileName}return e},toJSON:function(){var e=r.prototype.toJSON.apply(this,arguments);return e.fileName=e.serverFileName,e},customFieldsToJSON:function(e,t){return e.fileSourceType===o.REPOSITORY.name?e.fileName="repo:"+e.repositoryFileName:e.fileSourceType===o.SERVER_FILE_SYSTEM.name&&(e.fileName=e.serverFileName),delete e.repositoryFileName,delete e.serverFileName,e=r.prototype.customFieldsToJSON.call(this,e,t)},resetValidation:function(){this.validation=i.clone(a.prototype.validation)}});return a});