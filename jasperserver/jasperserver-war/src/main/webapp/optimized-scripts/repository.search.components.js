repositorySearch.secondarySearchBox={_searchBox:null,initialize:function(e){this._searchBox=new SearchBox({id:"secondarySearchBox"}),this._searchBox.onSearch=function(e){repositorySearch.fire(repositorySearch.Event.SEARCH_SEARCH,{text:e})},this.setText(e)},setText:function(e){this._searchBox.setText(e)}},repositorySearch.toolbar={_bulkActions:{},initialize:function(e){this._bulkActions=e,toolbarButtonModule.initialize(this._toActionMap(this._bulkActions)),this.refresh()},refresh:function(){for(var e in this._bulkActions){var t=this._bulkActions[e].buttonId,i=toFunction(this._bulkActions[e].test);toolbarButtonModule.setButtonState($(t),i())}},_toActionMap:function(e){var t={};for(var i in e){var s=e[i],o=s.buttonId;t[o]=function(e,t){return function(){var i=getAsFunction(e),s=t,o=localContext&&localContext[e];s&&isArray(s)?i.apply(o?localContext:null,s):i.call(o?localContext:null,s)}}(s.action,s.actionArgs)}return t}},repositorySearch.foldersPanel={_treeId:"foldersTree",_uri:"/",_cookieName:"lastFolderUri",_canDoBrowse:!0,_touchController:null,initialize:function(e){if(e.isFolderSet)this._uri=e.state.folderUri;else{var t=new JSCookie(this._cookieName).value;this._uri=t&&t.length>0?t:"/"}return this._container=$(this.getTreeId()).up(1),this.tree=new dynamicTree.createRepositoryTree(this.getTreeId(),{providerId:"repositoryExplorerTreeFoldersProvider",rootUri:repositorySearch.model.getRootFolderUri(),organizationId:e.organizationId,publicFolderUri:e.publicFolderUri,urlGetNode:"flow.html?_flowId=searchFlow&method=getNode",urlGetChildren:"flow.html?_flowId=searchFlow&method=getChildren",dragPattern:".draggable",selectOnMousedown:!1}),disableSelectionWithoutCursorStyle($(this.getTreeId()).up(1)),this.tree.observe("key:contextMenu",function(e){var t=e.memo.node,i=getBoxOffsets(t,!0);repositorySearch.actionModel.showFolderMenu(e,{menuLeft:i[0]+100,menuTop:i[1]+20}),Event.stop(e)}),this.tree.observe("key:escape",function(e){actionModel.hideMenu(),Event.stop(e)}),this.tree.observe("tree:mouseover",function(e){this.tree._overNode=e.memo.node}.bindAsEventListener(this)),this.tree.observe("tree:mouseout",function(e){this.tree.refreshDropTarget(!1),this.tree._overNode==e.memo.node&&(this.tree._overNode=null)}.bindAsEventListener(this)),this.tree.setDragStartState=function(e,t,i){dynamicTree.Tree.prototype.setDragStartState.call(this,e,t,i);var s=new Folder(e);isMetaHeld(i,!0)?(canFolderBeCopied(s)&&invokeFolderAction("CopyFolder",s),$(document.body).addClassName(layoutModule.COPY_CLASS)):canFolderBeMoved(s)&&invokeFolderAction("MoveFolder",s)},this.tree.setDragEndState=function(e,t,i){repositorySearch.CopyMoveController.cancel(),this.refreshDropTarget(!1),$(document.body).removeClassName(layoutModule.COPY_CLASS),dynamicTree.Tree.prototype.setDragEndState.call(this,e,t,i)},this.tree.refreshDropTarget=function(e){this._overNode&&(this._overNode.isDropTarget=e,this._overNode.refreshStyle())},Droppables.remove(this.getTreeId()),Droppables.add(this.getTreeId(),{accept:["dragging","wrap"],onHover:function(e){if(this.tree._overNode){var t=new Folder(this.tree._overNode),i=e.node&&canFolderBeCopiedOrMovedToFolder(t)||e.items&&canAllBeCopiedOrMovedToFolder(t);this.tree.refreshDropTarget(i)}}.bind(this),onDrop:function(e,t,i){var s;if(Draggables.supportsTouch){var o=i.changedTouches[0];s=this.tree.getTreeNodeByElement($(document.elementFromPoint(o.pageX,o.pageY)))}else s=this.tree.getTreeNodeByEvent(i);if(s&&(this.tree._overNode=s),this.tree._overNode){var r=new Folder(this.tree._overNode);e.node&&canFolderBeCopiedOrMovedToFolder(r)&&invokeFolderAction("PasteFolder",r),e.items&&canAllBeCopiedOrMovedToFolder(r)&&invokeFolderAction("PasteResources",r)}}.bind(this)}),this.tree.observe("server:error",function(){window.console&&alert("Tree load error.")}),this.tree.observe("childredPrefetched:loaded",function(){this.tree.openAndSelectNode(this._uri)}.bindAsEventListener(this)),this.tree.observe("tree:loaded",function(){this._canDoBrowse=!1,"/"==this._uri?this.tree.rootNode.select():this.tree.openAndSelectNode(this._uri),this._canDoBrowse=!0;var e=this.tree.getSelectedNode();e&&e.scroll($(this._treeId).parentNode),this.doBrowse()}.bindAsEventListener(this)),this.tree.observe("node:selected",function(e){this._uri=e.memo.node.param.uri,new JSCookie(this._cookieName,this._uri),repositorySearch.model.setSelectedFolder(new Folder(e.memo.node)),this.doBrowse()}.bindAsEventListener(this)),this.tree.observe("node:mouseup",function(e){repositorySearch.model.setContextFolder(new Folder(e.memo.node))}),this.tree.showTreePrefetchNodes(this._uri),this},doBrowse:function(){this._canDoBrowse&&repositorySearch.fire(repositorySearch.Event.SEARCH_BROWSE,{uri:this._uri})},getSelectedUri:function(){return this._uri},getTreeId:function(){return this._treeId},selectFolder:function(e){this.tree.openAndSelectNode(e.URI)},reselectFolder:function(e){e.node.isSelected()&&(e.node.deselect(),e.node.select())},refreshFolder:function(e){this.selectFolder(e),this.updateSubFolders(e)},updateFolder:function(e,t,i){e.label=t,e.description=i,e.node.changeName(e.label),e.node.param.extra.desc=e.description,this.tree.resortSubtree(e.node.parent),e.node.parent.refreshNode()},updateSubFolders:function(e){e.node.hasChilds()||e.node.setHasChilds(!0),e.node.isOpen()&&e.node.handleNode(),e.node.isloaded=!1,e.node.handleNode()},isFolderContextMenu:function(e){return this.tree.getTreeNodeByEvent(e)&&!this.tree.isIconEvent(e)},moveOrCopyFolder:function(e,t,i){var s=e.getParentFolder().node;return i||s.removeChild(e.node),this.tree.getTreeNodeChildren(t.node,function(t){if(t){var i=t.detect(function(t){return t.param.id==e.name});i&&this.tree.openAndSelectNode(i.param.uri)}}.bind(this))}},repositorySearch.resultsPanel={_list:null,_infiniteScroll:null,_resultListHeaderId:"resultsListHeader",_resultListId:"resultsList",_resultsContainerId:"resultsContainer",_touchScroller:null,_folderDisplayPathCache:{},NOTHING_TO_DISPLAY_ID:"nothingToDisplay",RESOURCE_NAME_TOOLTIP_ID:"resourceNameTooltip",NAME_PATTERN:".resourceName",LINK_NAME_PATTERN:".resourceName > a",DISCLOSURE_PATTERN:".disclosure",SCHEDULED_PATTERN:".scheduled",LOADING_CLASS_NAME:"loading",initialize:function(e){var t=this;return this._container=$(this._resultListId).up(),this._header=$(this._resultListHeaderId),this._list=new dynamicList.List(this._resultListId,{listTemplateDomId:"tabular_fourColumn_resources",itemTemplateDomId:"tabular_fourColumn_resources:leaf",dragPattern:e.enableDnD?".draggable":"",multiSelect:!0,selectOnMousedown:!isIPad()}),this._intiListEvents(),this._initDnD(),this.getList().show(),isSupportsTouch()&&(this._touchController=new TouchController(document.getElementById(this._resultListId),document.getElementById(this._resultsContainerId),{scrollbars:!0}),jQuery("#"+this._resultListId).on("layout_update orientationchange",function(){jQuery("#"+t._resultListId).css("min-width",jQuery("#"+t._resultsContainerId).width()+"px"),jQuery("#"+t._resultListId).width(jQuery("#"+t._resultsContainerId).width())})),this._infiniteScroll=new InfiniteScroll(isIPad()?{id:this._container.identify(),contentId:this._resultListId,scroll:this._touchController}:{id:this._container.identify(),contentId:this._resultListId}),this._infiniteScroll.onLoad=function(){repositorySearch.fire(repositorySearch.Event.SEARCH_NEXT)},disableSelectionWithoutCursorStyle(this._container),Event.observe($(window),"resize",function(){this.refresh()}.bind(this)),this._fixHeaderWidth(),this},_fixHeaderWidth:function(){isIPad()||this._header.setStyle({marginRight:this._container.getWidth()-$(this._resultListId).getWidth()+"px"})},_createResourceItem:function(e){var t;e.hasChildren?(t=new dynamicList.CompositeItem({cssClassName:layoutModule.NODE_CLASS,label:e.label.escapeHTML(),value:e,openHandlerPattern:".disclosure.icon",closeHandlerPattern:".disclosure.icon",excludeFromSelectionTriggers:[".disclosure.icon"],listOptions:{listTemplateDomId:"tabular_fourColumn_resources_sublist",itemTemplateDomId:"tabular_fourColumn_resources_sublist:leaf",multiSelect:!0}}),t.setLoading=function(e){this.isLoading=e,this.refreshStyle(),repositorySearch.resultsPanel.refresh()}):t=new dynamicList.ListItem({cssClassName:layoutModule.LEAF_CLASS,label:e.label.escapeHTML(),value:e}),t.processTemplate=function(e){var t=canBeRun(this.getValue())||canBeOpened(this.getValue()),i=t?repositorySearch.resultsPanel.LINK_NAME_PATTERN:repositorySearch.resultsPanel.NAME_PATTERN,s=e.select(i)[0],o=e.select(repositorySearch.resultsPanel.NAME_PATTERN)[0],r=e.select(".resourceDescription")[0];s.update(this.getValue().label.escapeHTML());var n=this;new JSTooltip(o,{text:[this.getValue().label.escapeHTML(),repositorySearch.messages.loading],templateId:repositorySearch.resultsPanel.RESOURCE_NAME_TOOLTIP_ID,loadTextCallback:function(e){var t=n.getValue().parentFolder,i=repositorySearch.resultsPanel._folderDisplayPathCache[t];if(repositorySearch.resultsPanel._folderDisplayPathCache[t])e.updateText([n.getValue().label.escapeHTML(),i+repositorySearch.model.getFolderSeparator()+n.getValue().label]);else{var s=new repositorySearch.ServerAction(repositorySearch.InfoAction.GET_DISPLAY_PATH,{data:{resourceUri:t,isFolder:!0}});s.onSuccess=function(i){repositorySearch.resultsPanel._folderDisplayPathCache[t]=i,e.updateText([n.getValue().label.escapeHTML(),i+repositorySearch.model.getFolderSeparator()+n.getValue().label])},s.onError=repositorySearch.defaultErrorHandler,s.invokeAction()}}}),r.update(this.getValue().description.escapeHTML()),new JSTooltip(r,{text:this.getValue().description.escapeHTML()});var a=e.select(".resourceType")[0],l=e.select(".modifiedDate")[0],c=e.select(".createdDate")[0];return a.update(this.getValue().type),l.update(this.getValue().updateDate),new JSTooltip(l,{text:this.getValue().updateDateTime.escapeHTML()}),c.update(this.getValue().date),new JSTooltip(c,{text:this.getValue().dateTime.escapeHTML()}),e};var i=t.refreshStyle;return t.refreshStyle=function(){i.call(this);var e=this._getElement();this.getValue().isScheduled&&e.addClassName(layoutModule.SCHEDULED_CLASS),this.isLoading&&e.addClassName(layoutModule.LOADING_CLASS)},t},_initDnD:function(){var e=this.getList();e.setDragStartState=function(e,t,i){dynamicList.List.prototype.setDragStartState.call(this,e,t,i),isMetaHeld(i,!0)&&$(document.body).addClassName(layoutModule.COPY_CLASS).setStyle({cursor:null}),invokeBulkAction(isMetaHeld(i,!0)?"Copy":"Move")},e.setDragEndState=function(e,t,i){repositorySearch.CopyMoveController.cancel(),repositorySearch.foldersPanel.tree.refreshDropTarget(!1),$(document.body).removeClassName(layoutModule.COPY_CLASS),dynamicList.List.prototype.setDragEndState.call(this,e,t,i)}},_intiListEvents:function(){this.getList().observe("item:click",function(e){var t=e.memo.item,i=e.memo.targetEvent,s=t.getValue();this._isLinkEvent(i)&&(canBeRun(s)?invokeRedirectAction("RunResourceAction"):canBeOpened(s)&&invokeRedirectAction("OpenResourceAction")),this._isScheduleIconEvent(i)&&canBeScheduled(s)&&invokeRedirectAction("ScheduleAction")}.bindAsEventListener(this)),this.getList().observe("item:selected",function(e){var t=(e.memo.item,this.getList().getSelectedItems().collect(function(e){return e.getValue()}));repositorySearch.model.setSelectedResources(t),repositorySearch.actionModel.refreshToolbar()}.bindAsEventListener(this)),this.getList().observe("item:unselected",function(e){var t=(e.memo.item,this.getList().getSelectedItems().collect(function(e){return e.getValue()}));repositorySearch.model.setSelectedResources(t),repositorySearch.actionModel.refreshToolbar()}.bindAsEventListener(this)),this.getList().observe("item:mouseup",function(){}),this.getList().observe("item:open",function(e){var t=e.memo.item,i=t.getValue();i.isLoaded()||(t.setLoading(!0),repositorySearch.fire(repositorySearch.Event.SEARCH_CHILDREN,{resource:i,item:t})),this.refresh()}.bindAsEventListener(this)),this.getList().observe("item:closed",function(){this.refresh()}.bindAsEventListener(this)),this.getList().observe("key:contextMenu",function(e){var t=e.memo.node,i=getBoxOffsets(t,!0),s={menuLeft:i[0]+100,menuTop:i[1]+20};this.getList().getSelectedItems().length>1?repositorySearch.actionModel.showResourceBulkMenu(e,s):repositorySearch.actionModel.showResourceMenu(e,s),Event.stop(e)}.bindAsEventListener(this)),this.getList().observe("key:escape",function(e){actionModel.hideMenu(),Event.stop(e)})},_isLinkEvent:function(e){var t=Event.element(e);return null!=matchAny(t,[this.LINK_NAME_PATTERN])},_isScheduleIconEvent:function(e){var t=Event.element(e);return t.match(this.SCHEDULED_PATTERN)},_isDisclosureEvent:function(e){var t=Event.element(e);return null!=matchAny(t,[this.DISCLOSURE_PATTERN])},_refreshEmptyListMessage:function(){var e=$(this.NOTHING_TO_DISPLAY_ID);0==this._list.getItems().length?(e.removeClassName(layoutModule.HIDDEN_CLASS),centerElement(e,{horz:!0,vert:!0})):e.addClassName(layoutModule.HIDDEN_CLASS)},getList:function(){return this._list},removeResources:function(e){var t=e.findAll(function(e){return e.isChild}),i=e.findAll(function(e){return!e.isChild}),s=this.getList().getItems(),o=[],r=[];s.each(function(e){e.isComposite&&r.push(e),i.include(e.getValue())&&o.push(e)}),r.each(function(e){e.getItems()&&e.removeItems(e.getItems().findAll(function(e){return t.include(e.getValue())}))}),this.getList().removeItems(o),this._refreshEmptyListMessage(),this.refresh()},setResources:function(e,t){var i=e.collect(this._createResourceItem);t?(t.setItems(i),t.refresh()):(this._infiniteScroll&&this._infiniteScroll.reset(),this.getList().setItems(i),this.getList().show(),this._refreshEmptyListMessage()),this.refresh(),this._infiniteScroll.stopWaiting()},addResources:function(e){var t=e.collect(this._createResourceItem);this.getList().addItems(t),this.getList().refresh(),this.refresh(),this._infiniteScroll.stopWaiting()},isResourceContextMenu:function(e){return this.getList().getItemByEvent(e)},updateResource:function(e){var t=this.getList().getItems();t.each(function(t){t.getValue().URIString==e.URIString&&(t.setValue(e),t.refresh(),this.getList().isItemSelected(t)&&this.getList().selectItem(t))}.bind(this))},findResource:function(e){var t=this.getList().getItems(),i=t.detect(function(t){return t.getValue().URIString===e});return i?i.getValue():null},refresh:function(){this._fixHeaderWidth(),tooltipModule.cleanUp()}},repositorySearch.filtersPanel={_id:"filtersPanel",_container:void 0,_filtersLists:{},_cookieName:"filtersPopularity",_ignoreFilterEvent:!1,initialize:function(e,t){this._getContainer().update(),e.each(function(e,t){this._getContainer().insert(new Element("ul",{id:e.id,"data-tab-index":5+t,"data-component-type":"list"}));var i=this._createFiltersList(e.id,e);i.show(),this._filtersLists[e.id]=i}.bind(this));for(var i in t)this.select(i,t[i]);return isSupportsTouch()&&(this._touchController=new TouchController(document.getElementById(this._id),$(this._id).up())),this},_refreshScroll:function(){var e=layoutModule.scrolls.get(this._id);e&&e.refresh()},_createItemsList:function(e){var t=e.options,i=0,s=t.collect(function(e){return new dynamicList.ListItem({value:e,cssClassName:layoutModule.LEAF_CLASS,label:repositorySearch.getMessage(e.labelId)})}).partition(function(){return i++,-1===e.showCount||e.showCount>i});return s[1].length>0&&s[0].push(new dynamicList.CompositeItem({value:{isMore:!0},templateDomId:"list_responsive_filters:node",openUp:!0,openHandlerPattern:".more.launcher",closeHandlerPattern:".fewer.launcher",respondOnItemEvents:!1,items:s[1]})),s[0]},_createFiltersList:function(e,t){var i=new dynamicList.List(e,{listTemplateDomId:"list_responsive_filters",itemTemplateDomId:"list_responsive_filters:leaf",items:this._createItemsList(t)});return i.addItems([new dynamicList.CompositeItem({templateDomId:"list_responsive_filters:separator",respondOnItemEvents:!1,value:{isSeparator:!0}})].compact()),i.observe("item:selected",function(e){var t=e.memo.item;t.getValue().isSeparator||t.getValue().isMore||this._ignoreFilterEvent||(this._increasePopularity(i.getId(),t.getValue().id),repositorySearch.fire(repositorySearch.Event.SEARCH_FILTER,{filterId:i.getId(),optionId:t.getValue().id}))}.bindAsEventListener(this)),i},_increasePopularity:function(e,t){var i=new JSCookie(this._cookieName),s=i.value?i.value.evalJSON():{},o=this._filtersLists[e],r=o.getId();s[r]||(s[r]={}),o.getItems().each(function(i){var o=i.getValue().id,n=s[r][o]?s[r][o]:0;s[r][o]=r===e&&o===t?n+1:n}),new JSCookie(this._cookieName,Object.toJSON(s))},select:function(e,t,i){var s=this._filtersLists[e],o=function(e){if(e.getValue().id==t)throw e.isSelected()||(this._ignoreFilterEvent=i,e.select(),this._ignoreFilterEvent=!1),$break;if(e.isComposite){var s=e._getElement();baseList.isItemOpen(s)||baseList.openItem(s),e.getItems()&&e.getItems().each(o)}}.bind(this);s.getItems().each(o)},_getContainer:function(){return this._container||(this._container=$(this._id),this._container.hasClassName(layoutModule.SWIPE_SCROLL_PATTERN)&&(this._container=this._container.down())),this._container}},repositorySearch.filterPath={_containerId:"filterPath",_contentBodySelector:".primary.column>.content>.body",initialize:function(){return this._filterPathList=new dynamicList.List(this._containerId,{listTemplateDomId:"list_control_path",itemTemplateDomId:"list_control_path:step"}),this._filterPathList.observe("item:selected",function(e){var t=e.memo.item;t.getValue().isLast||repositorySearch.fire(repositorySearch.Event.SEARCH_ROLLBACK,{position:t.getValue().position})}),this},setPathItems:function(e){if(e.length>1){var t=e.length-1,i=e.collect(function(e,i){return e.isLast=i==t,new dynamicList.ListItem({label:e.label,value:e})});this._filterPathList.setItems(i),this._filterPathList.show(),$(this._containerId).up().removeClassName("hidden"),$(document.body).select(this._contentBodySelector)[0].addClassName("showingSubHeader")}else this._filterPathList.setItems([]),this._filterPathList.show(),$(this._containerId).up().addClassName("hidden"),$(document.body).select(this._contentBodySelector)[0].removeClassName("showingSubHeader")}},repositorySearch.sortersPanel={_LABEL_TEMPLATE_DOM_ID:"sortPanelLabelTemplate",_containerId:"sortMode",_ignoreSortEvent:!1,sortersList:null,initialize:function(e,t){var i=new dynamicList.ListItem({label:repositorySearch.getMessage("SEARCH_SORT_BY")+":",value:{isLabel:!0},templateDomId:"tabSet_control_horizontal_responsive:label",respondOnItemEvents:!1}),s=e.collect(function(e){return new dynamicList.ListItem({label:repositorySearch.getMessage(e.labelId),value:e})});return this.sortersList=new dynamicList.List(this._containerId,{listTemplateDomId:"tabSet_control_horizontal_responsive",itemTemplateDomId:"tabSet_control_horizontal_responsive:tab",items:[i].concat(s)}),this.sortersList.observe(this.sortersList.Event.ITEM_SELECTED,function(e){var t=e.memo.item;t.getValue().isLabel||this._ignoreSortEvent||repositorySearch.fire(repositorySearch.Event.SEARCH_SORT,{sorterId:t.getValue().id})}),this.sortersList.show(),i.disable(),this.select(t),this},select:function(e,t){this.sortersList.getItems().each(function(i){return i.getValue().id!=e||i.isSelected()?void 0:(this._ignoreSortEvent=t,this.sortersList.selectItem(i),void(this._ignoreSortEvent=!1))}.bind(this))},_getContainer:function(){return this._container||(this._container=$(this._containerId)),this._container},_getLabelTemplate:function(){var e=$(this._LABEL_TEMPLATE_DOM_ID).cloneNode(!0);return e.removeAttribute("id"),e}};var ResourcePermissions=function(e){this._resource=e,this._isVisible=!1,this._listId=this.ENTITY_LIST_ID,this._listContainerId=this.LIST_CONTAINER_ID,this._searchBoxId=this.SEARCH_BOX_ID,this.viewBy="USER",this._processTemplate()};ResourcePermissions.addVar("TEMPLATE_DOM_ID","permissions"),ResourcePermissions.addVar("TOOLTIP_TEMPLATE_DOM_ID","orgTooltip"),ResourcePermissions.addVar("LIST_TEMPLATE_ID","tabular_twoColumn_setLeft"),ResourcePermissions.addVar("ITEM_TEMPLATE_ID","tabular_twoColumn_setLeft:leaf"),ResourcePermissions.addVar("WAIT_ITEM_TEMPLATE_ID","tabular_twoColumn_setLeft:loading"),ResourcePermissions.addVar("ENTITY_LIST_ID","permissionsList"),ResourcePermissions.addVar("LIST_CONTAINER_ID","permissionsListContainer"),ResourcePermissions.addVar("SEARCH_BOX_ID","searchPermissionsBox"),ResourcePermissions.addVar("NAME_TOOLTIP_PATTERN",".one"),ResourcePermissions.addVar("NAME_PATTERN",".one>a.launcher"),ResourcePermissions.addVar("PERMISSIONS_PATTERN",".two>select"),ResourcePermissions.addVar("VIEW_BY_TAB_SET_PATTERN","#permissionsViewBy"),ResourcePermissions.addVar("TAB_PATTERN",".tab>p"),ResourcePermissions.addVar("PATH_PATTERN",".path"),ResourcePermissions.addVar("SUBMIT_BUTTON","#permissionsOk"),ResourcePermissions.addVar("APPLAY_BUTTON","#permissionsApply"),ResourcePermissions.addVar("CANCEL_BUTTON","#permissionsCancel"),ResourcePermissions.addVar("BODY_PATTERN","div.body"),ResourcePermissions.addMethod("_processTemplate",function(){this._dom=$(this.TEMPLATE_DOM_ID).cloneNode(!0),this._dom.writeAttribute("id",null),this._dom.down(".body").writeAttribute("id","");var e=this._dom.select(this.PATH_PATTERN)[0];e.update(this._resource.URIString.truncate(50).escapeHTML()),e.writeAttribute("title",this._resource.URIString.escapeHTML()),this._viewByTabSet=this._dom.select(this.VIEW_BY_TAB_SET_PATTERN)[0],this._byUsersButton=this._dom.select(this.TAB_PATTERN)[0],this._byRolesButton=this._dom.select(this.TAB_PATTERN)[1],this._submitButton=this._dom.select(this.SUBMIT_BUTTON)[0],this._applyButton=this._dom.select(this.APPLAY_BUTTON)[0],this._cancelButton=this._dom.select(this.CANCEL_BUTTON)[0],this._byUsersButton.viewType="USER",this._byRolesButton.viewType="ROLE",this._submitButton.writeAttribute("id",null),this._applyButton.writeAttribute("id",null),this._cancelButton.writeAttribute("id",null);var t=this._dom.select("#"+this.ENTITY_LIST_ID)[0],i=this._dom.select("#"+this.LIST_CONTAINER_ID)[0],s=this._dom.select("#"+this.SEARCH_BOX_ID)[0];this._listId=t.writeAttribute("id",null).identify(),this._listContainerId=i.writeAttribute("id",null).identify(),this._searchBoxId=s.writeAttribute("id",null).identify()}),ResourcePermissions.addMethod("_updateValueAndLabel",function(e,t,i,s){var o=e.select(t)[0];return o.writeAttribute("id",null),o.setValue(i),e.select(s)[0].writeAttribute("for",o.identify()),o}),ResourcePermissions.addMethod("_updateContentAndLabel",function(e,t,i,s){var o=e.select(t)[0];return o.writeAttribute("id",null),o.update(i),e.select(s)[0].writeAttribute("for",o.identify()),o}),ResourcePermissions.addMethod("_buttonClickHandler",function(e){var t=e.element();if(!this._waiting){var i=matchAny(t,[layoutModule.BUTTON_PATTERN],!0),s=this._resource.URIString;[this._submitButton,this._applyButton].include(i)&&(this._byUsersButton.addClassName(layoutModule.BUTTON_CLASS),this._byRolesButton.addClassName(layoutModule.BUTTON_CLASS),repositorySearch.fire(repositorySearch.PermissionEvent.UPDATE,{uri:s,entities:this.getChangedEntities(),finishEdit:i==this._submitButton})),[this._byUsersButton,this._byRolesButton].include(i)&&(this.isChanged()?(this._showWarning(),e.stop()):(this._hideWarning(),this.viewBy=i.viewType,repositorySearch.fire(repositorySearch.PermissionEvent.BROWSE,{uri:s,type:this.viewBy}))),[this._cancelButton].include(i)&&this.hide()}}),ResourcePermissions.addMethod("_showWarning",function(){this._dom.select(this.BODY_PATTERN)[0].addClassName(layoutModule.ERROR_CLASS)}),ResourcePermissions.addMethod("_hideWarning",function(){this._dom.select(this.BODY_PATTERN)[0].removeClassName(layoutModule.ERROR_CLASS)}),ResourcePermissions.addMethod("_launcherClickHandler",function(e){var t=e.element();if(!this._waiting){var i=matchAny(t,[this.NAME_PATTERN],!0);if(i){var s=t.up("li");if(s&&s.listItem){var o=s.listItem.getValue();o.navigateToManager()}}}e.stop()}),ResourcePermissions.addMethod("_selectChangeHandler",function(e){var t=e.element();if(e.stop(),!this._waiting){if("select"==t.tagName.toLowerCase()){var i=t.options[t.selectedIndex].value,s=t.up("li");if(s&&s.listItem){var o=s.listItem.getValue();s.listItem.getValue().permission.newPermission=i!=o.permission.getResolvedPermission()?i:void 0,s.listItem.refresh()}}this.isChanged()?(this._byUsersButton.removeClassName(layoutModule.BUTTON_CLASS),this._byRolesButton.removeClassName(layoutModule.BUTTON_CLASS)):(this._byUsersButton.addClassName(layoutModule.BUTTON_CLASS),this._byRolesButton.addClassName(layoutModule.BUTTON_CLASS))}}),ResourcePermissions.addMethod("_selectMouseOverHandler",function(e){var t=matchAny(e.element(),[this.PERMISSIONS_PATTERN],!0);t&&e.stop()}),ResourcePermissions.addMethod("_initControls",function(){this.list=new dynamicList.List(this._listId,{listTemplateDomId:this.LIST_TEMPLATE_ID,itemTemplateDomId:this.ITEM_TEMPLATE_ID});var e=$(this._listId).up();isSupportsTouch()&&(this._touchController||(this._touchController=new TouchController($(this._listId),$(this._listId).up(),{forceLayout:!0}))),this._infiniteScroll=new InfiniteScroll({id:e.identify(),contentId:this._listId,scroll:this._touchController||void 0}),this._searchBox=new SearchBox({id:this._searchBoxId});var t=this._resource.URIString;this._infiniteScroll.onLoad=function(){this._waiting||repositorySearch.fire(repositorySearch.PermissionEvent.NEXT,{text:this._searchBox.getText(),uri:t,type:this.viewBy})}.bind(this),this._searchBox.onSearch=function(e){this._waiting||(this.isChanged()?this._showWarning():(this._hideWarning(),repositorySearch.fire(repositorySearch.PermissionEvent.SEARCH,{text:e,uri:t,type:this.viewBy})))}.bind(this)}),ResourcePermissions.addMethod("show",function(){this._isVisible||(document.body.insert(this._dom),this._initControls(),this.list.setItems([]),this.list.show(),orgModule.entityList._createEntityItem=this._createEntityItem,this.viewBy="ROLE",repositorySearch.fire(repositorySearch.PermissionEvent.BROWSE,{initialize:!0,uri:this._resource.URIString,type:this.viewBy,isFolder:this._resource.isFolder()}),this._isVisible=!0,document.getElementById(this._listId).parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.style.height="360px",dialogs.popup.show(this._dom),this._dom.observe("click",this._buttonClickHandler.bindAsEventListener(this)),isSupportsTouch()&&this._viewByTabSet.observe("touchstart",this._buttonClickHandler.bindAsEventListener(this)),this._dom.observe("click",this._launcherClickHandler.bindAsEventListener(this)),this._dom.observe("mouseover",this._selectMouseOverHandler.bindAsEventListener(this)))}),ResourcePermissions.addMethod("showAndWait",function(){this._isVisible||(this._waiting=!0,this.show(),this._waitingItem=new dynamicList.ListItem({templateDomId:this.WAIT_ITEM_TEMPLATE_ID}),this.list.addItems([this._waitingItem]),this.list.refresh(),this.disable())}),ResourcePermissions.addMethod("stopWaiting",function(){this._waiting&&(this._waiting=!1,this.list.removeItems([this._waitingItem]),this.enable())}),ResourcePermissions.addMethod("hide",function(){dialogs.popup.hide(this._dom),this._dom.remove(),this._dom.stopObserving("click"),this._dom.stopObserving("change"),this._dom.stopObserving("mouseover"),isSupportsTouch()&&this._viewByTabSet.stopObserving("touchstart"),repositorySearch.dialogsPool.removePermissionsDialog(this._resource)}),ResourcePermissions.addMethod("enable",function(){this._searchBox.enable(),buttonManager.enable(this._byUsersButton),buttonManager.enable(this._byRolesButton)}),ResourcePermissions.addMethod("disable",function(){this._searchBox.disable(),buttonManager.disable(this._byUsersButton),buttonManager.disable(this._byRolesButton)}),ResourcePermissions.addMethod("_createItem",function(e){var t=new dynamicList.ListItem({label:e.getDisplayName().escapeHTML(),value:e}),i=this.NAME_TOOLTIP_PATTERN,s=this.NAME_PATTERN,o=this.PERMISSIONS_PATTERN,r=this.TOOLTIP_TEMPLATE_DOM_ID,n=this;return t.processTemplate=function(e){var t=e.select(i)[0],a=e.select(s)[0],l=e.select(o)[0],c=this.getValue().permission,d=this.getValue().tenantId;if(c.newPermission?a.addClassName(layoutModule.EMPHASIS_CLASS):a.removeClassName(layoutModule.EMPHASIS_CLASS),a.update(this.getValue().getDisplayName().escapeHTML()),d&&d.length>0){new JSTooltip(t,{text:d,templateId:r});var h=e.remove;e.remove=function(){tooltipModule.hideJSTooltip(t),tooltipModule.cleanUp(),h.apply(this)}}l.update("");for(var u=0,_=repositorySearch.model.getConfiguration().permissions,p=0;p<_.length;p++){var m=repositorySearch.getMessage(_[p].labelId),f=new Element("option",{value:_[p].name});l.insert(f.update(c.inheritedPermission==_[p].name?m+" *":m)),c.newPermission?c.newPermission==_[p].name&&(u=p):c.getResolvedPermission()==_[p].name&&(u=p)}return l.observe("change",n._selectChangeHandler.bindAsEventListener(n)),l.selectedIndex=u,this.getValue().permission.isDisabled&&l.writeAttribute("disabled","disabled"),e},t}),ResourcePermissions.addMethod("addEntities",function(e){var t=e.collect(this._createItem.bind(this));this.list.addItems(t),this.list.refresh(),this._infiniteScroll.stopWaiting()}),ResourcePermissions.addMethod("setEntities",function(e){this.list.setItems([]),this._touchController&&this._touchController.reset(),this.addEntities(e)}),ResourcePermissions.addMethod("getChangedEntities",function(){var e=this.list.getItems(),t=[];return e.each(function(e){var i=e.getValue();i.permission&&i.permission.newPermission&&t.push(i)}),t}),ResourcePermissions.addMethod("updateEntities",function(e){var t=this.list.getItems();t.each(function(t){var i=t.getValue(),s=e.detect(function(e){return e.equals(i)});s&&(t.setValue(s),t.refresh())})}),ResourcePermissions.addMethod("isChanged",function(){return this.getChangedEntities().length>0}),repositorySearch.dialogsPool={POOL_NOT_FOUND_EXCEPTION:"PoolNotFoundException",DIALOD_EXIST_EXCEPTION:"DialodExistException",NULL_RESOURCE_EXCEPTION:"NullResourceException",_permissionsDialogPool:{},_propertiesDialogPool:{},_getPool:function(e){var t;if(e==ResourcePermissions&&(t=this._permissionsDialogPool),e==ResourceProperties&&(t=this._propertiesDialogPool),t)return t;throw{name:this.POOL_NOT_FOUND_EXCEPTION,message:"Can't find pool for "+e.toString()}},_createDialog:function(e,t,i){var s=t.URIString,o=this._getPool(e);if(null==t)throw{name:this.NULL_RESOURCE_EXCEPTION,message:"Resource is null."};if(o[s])throw{name:this.DIALOD_EXIST_EXCEPTION,message:e.toString()+" dilaog for resource '"+s+"' arleady exist."};return o[s]=new e(t,i),o[s]},_createOrGetDialog:function(e,t,i){try{return this._createDialog(e,t,i)}catch(s){if(s.name==this.DIALOD_EXIST_EXCEPTION)return this._getDialog(e,t);throw s}},_getDialog:function(e,t){var i=Object.isString(t)?t:t.URIString;return this._getPool(e)[i]},_getAllDialogs:function(e){var t=this._getPool(e),i=[];for(var s in t)t[s]&&i.push(t[s]);return i},_removeDialog:function(e,t){var i=Object.isString(t)?t:t.URIString;this._getPool(e)[i]=void 0},createPermissionsDialog:function(e){return this._createDialog(ResourcePermissions,e)},createPropertiesDialog:function(e){return this._createDialog(ResourceProperties,e)},createOrGetPermissionsDialog:function(e){return this._createOrGetDialog(ResourcePermissions,e)},createOrGetPropertiesDialog:function(e,t){return this._createOrGetDialog(ResourceProperties,e,t)},getAllPermissionsDialogs:function(){return this._getAllDialogs(ResourcePermissions)},getAllPropertiesDialogs:function(){return this._getAllDialogs(ResourceProperties)},getPermissionsDialog:function(e){return this._getDialog(ResourcePermissions,e)},getPropertiesDialog:function(e){return this._getDialog(ResourceProperties,e)},removePermissionsDialog:function(e){return this._removeDialog(ResourcePermissions,e)},removePropertiesDialog:function(e){return this._removeDialog(ResourceProperties,e)}};var ResourceProperties=function(e,t){this._resource=e,this._changedCallback=t.changedCallback,this._showMode=t.showMode,this._processTemplate()};ResourceProperties.addVar("TEMPLATE_DOM_ID","propertiesResource"),ResourceProperties.addMethod("_processTemplate",function(){this._dom=$(this.TEMPLATE_DOM_ID).cloneNode(!0),this._dom.writeAttribute("id",null),this._dom.addClassName("_activeResourcePropertiesDialog");
var e=this._dom.select(".title")[0];e.update(e.innerHTML.strip().escapeHTML()+": "+this._resource.label.truncate(50)),this._label=this._updateValueAndLabel(this._dom,"input#displayName",this._resource.label.unescapeHTML(),'label[for="displayName"]'),this._description=this._updateContentAndLabel(this._dom,"textarea#description",this._resource.description,'label[for="description"]'),this._path=this._updateValueAndLabel(this._dom,"input#path",this._resource.URIString,'label[for="path"]'),this._showMode&&(this._dom.addClassName("showMode"),this._label.writeAttribute("readonly","readonly"),this._description.writeAttribute("readonly","readonly")),this._updateValueAndLabel(this._dom,"div#resourceID",this._resource.name,'label[for="resourceID"]'),this._updateValueAndLabel(this._dom,"input#type",this._resource.type,'label[for="type"]'),this._updateValueAndLabel(this._dom,"input#createdDate",this._resource.date,'label[for="createdDate"]'),this._updateValueAndLabel(this._dom,"input#userAccess",this._resource.permissionsToString(),'label[for="userAccess"]'),this._submitButton=this._dom.select("button.submit")[0],this._cancelButton=this._dom.select("button.cancel")[0],this._okButton=this._dom.select("button.ok")[0]}),ResourceProperties.addMethod("_updateValueAndLabel",function(e,t,i,s){var o=e.select(t)[0];return o.writeAttribute("id",null),o.writeAttribute("value",i),o.setValue?o.setValue(i):o.update(i),e.select(s)[0].writeAttribute("for",o.identify()),o}),ResourceProperties.addMethod("_updateContentAndLabel",function(e,t,i,s){var o=e.select(t)[0];return o.writeAttribute("id",null),o.update(i),e.select(s)[0].writeAttribute("for",o.identify()),o}),ResourceProperties.addMethod("_buttonClickHandler",function(e){var t=matchAny(e.element(),[layoutModule.BUTTON_PATTERN],!0);if(t==this._submitButton){if(this._showMode)this._hide();else if(this._isDataValid()){if(this._changedCallback){var i=this._resource.clone();i.label=this._label.getValue(),i.description=this._description.getValue(),this._changedCallback(i)}this._hide()}}else(t==this._cancelButton||t==this._okButton)&&this._hide()}),ResourceProperties.addMethod("_isDataValid",function(){return ValidationModule.validate([{validator:ResourcesUtils.labelValidator,element:this._label},{validator:ResourcesUtils.descriptionValidator,element:this._description}])}),ResourceProperties.addMethod("show",function(e){document.body.insert(this._dom),e&&e.cascade?dialogs.popup.show(this._dom,!1,e):dialogs.popup.show(this._dom),this._dom.observe("click",this._buttonClickHandler.bindAsEventListener(this))}),ResourceProperties.addMethod("_hide",function(){dialogs.popup.hide(this._dom),this._dom.remove(),this._dom.stopObserving("click"),repositorySearch.dialogsPool.removePropertiesDialog(this._resource)}),ResourceProperties.addMethod("isChanged",function(){return this._resource.label!=this._label.getValue()||this._resource.description!=this._description.getValue()}),repositorySearch.showCreateFolderConfirm=function(e){var t,i=$("addFolder"),s=$("addFolderInputName"),o=$("addFolderInputDescription"),r=$("addFolderBtnAdd"),n=$("addFolderBtnCancel"),a=function(e){t=e,dialogs.popup.show(i),s.setValue(repositorySearch.messages["action.create.folder.name"]),accessibilityModule.disable(),setTimeout(function(){s.focus(),s.select()},500)},l=function(e){s.clear(),o.clear(),ValidationModule.hideError(s),ValidationModule.hideError(o),dialogs.popup.hide(i),accessibilityModule.enable(),e.stop()},c=function(){var e=ValidationModule.validate([{validator:ResourcesUtils.labelValidator,element:s},{validator:ResourcesUtils.descriptionValidator,element:o}]);return e},d=function(e){"disabled"!==r.readAttribute("disabled")&&(new repositorySearch.ServerAction.createFolderAction(repositorySearch.FolderAction.CREATE,{toFolder:t,label:s.getValue(),desc:o.getValue()}).invokeAction(),l(e))};r.observe("click",function(e){c()&&d(e),e.stop()}),n.observe("click",l),repositorySearch.showCreateFolderConfirm=a,a(e)},repositorySearch.DeleteConfirmation={ID_DELETE_DIALOG_CONTAINER:"standardConfirm",ID_DELETE_DIALOG_OK_BUTTON:"deleteResourceOK",ID_DELETE_DIALOG_CANCEL_BUTTON:"deleteResourceCancel"},repositorySearch.showDeleteFolderConfirm=function(e){var t=repositorySearch.getMessage("SEARCH_DELETE_FOLDER_CONFIRM_MSG",{folderUri:e.URI}),i=new repositorySearch.ServerAction.createFolderAction(repositorySearch.FolderAction.DELETE,{folder:e});repositorySearch._showDeleteDialog(t,i)},repositorySearch.showDeleteResourceConfirm=function(e){var t=repositorySearch.getMessage("SEARCH_DELETE_CONFIRM_MSG",{resourceUri:e.URIString}),i=new repositorySearch.ServerAction.createResourceAction(repositorySearch.ResourceAction.DELETE,{resources:[e]});repositorySearch._showDeleteDialog(t,i)},repositorySearch.showBulkDeleteResourcesConfirm=function(e){var t=repositorySearch.getMessage("SEARCH_BULK_DELETE_CONFIRM_MSG",{count:e.length}),i=new repositorySearch.ServerAction.createResourceAction(repositorySearch.ResourceAction.DELETE,{resources:e});repositorySearch._showDeleteDialog(t,i)},repositorySearch._showDeleteDialog=function(e,t){var i=$(repositorySearch.DeleteConfirmation.ID_DELETE_DIALOG_CONTAINER);i.down(".body").update(e),dialogs.popupConfirm.show(i,!0,{okButtonSelector:"#"+repositorySearch.DeleteConfirmation.ID_DELETE_DIALOG_OK_BUTTON,cancelButtonSelector:"#"+repositorySearch.DeleteConfirmation.ID_DELETE_DIALOG_CANCEL_BUTTON}),jQuery("#"+repositorySearch.DeleteConfirmation.ID_DELETE_DIALOG_OK_BUTTON).on("click",function(){t.invokeAction()})},repositorySearch.showResourceProperties=function(e,t){var i=repositorySearch.dialogsPool.createOrGetPropertiesDialog(e,{showMode:!0});i.show(t)},repositorySearch.editResourceProperties=function(e,t){var i=repositorySearch.dialogsPool.createOrGetPropertiesDialog(e,{changedCallback:function(e){var t=new repositorySearch.ServerAction.createResourceAction(repositorySearch.ResourceAction.UPDATE,{resource:e});t.invokeAction()}});i.show(t)},repositorySearch.showFolderProperties=function(e){var t=repositorySearch.dialogsPool.createOrGetPropertiesDialog(e,{showMode:!0});t.show()},repositorySearch.editFolderProperties=function(e){var t=repositorySearch.dialogsPool.createOrGetPropertiesDialog(e,{changedCallback:function(e){var t=new repositorySearch.ServerAction.createFolderAction(repositorySearch.FolderAction.UPDATE,{folder:e});t.invokeAction()}});t.show()},repositorySearch.editResourcePermissions=function(e){var t=repositorySearch.dialogsPool.createOrGetPermissionsDialog(e);t.showAndWait()},repositorySearch.editFolderPermissions=function(e){var t=repositorySearch.dialogsPool.createOrGetPermissionsDialog(e);t.showAndWait()},repositorySearch.showUploadThemeConfirm=function(e,t){var i,s,o=$("uploadTheme"),r=$("themeName"),n=$("themeZip"),a=$("uploadThemeBtnUpload"),l=$("uploadThemeBtnCancel"),c=function(e,t){i=e,s=t,dialogs.popup.show(o),r.removeAttribute("disabled"),r.setValue(repositorySearch.messages.RM_NEW_THEME_NAME),s&&(r.writeAttribute("disabled"),r.setValue(i.name)),r.select(),r.focus()},d=function(e){r.clear(),n.clear(),dialogs.popup.hide(o),e.stop()},h=function(){var e=ValidationModule.validate([{validator:ResourcesUtils.labelValidator,element:r},{validator:ResourcesUtils.zipFileTypeValidator,element:n}]);return e},u=function(e){var t={};if(t.themeName=r.getValue(),t._eventId="uploadTheme",t._flowExecutionKey=repositorySearch.flowExecutionKey,t.folderUri=i.URI,t.folderUri=i.URI,s){var o=i.URI;t.folderUri=o.slice(0,o.lastIndexOf("/")),t.reuploadAction=s,t._eventId="reuploadTheme"}var a=function(e){if(n=$("themeZip"),e)try{var o=e.evalJSON(),o=e.evalJSON();if(o&&"OK"==o.status){if(o.data.themeExist){var r=confirm(repositorySearch.messages.SEARCH_OVERWRITE_THEME_CONFIRM_MSG);if(r){var a=new repositorySearch.ServerAction.createFolderAction(repositorySearch.ThemeAction.REUPLOAD,t);a.invokeAction()}}else if(o.data.isActiveTheme){var l=o.data.themeUri,a=new repositorySearch.ServerAction.createFolderAction(repositorySearch.ThemeAction.SETTHEME,{folderUri:l});a.invokeAction()}}else alert(o&&"ERROR"==o.status?o.data:repositorySearch.messages.RM_UPLOAD_THEME_ERROR)}catch(c){alert(c)}s&&o.data.isActiveTheme||repositorySearch.foldersPanel.refreshFolder(i)};fileSender.upload(n,"searchFlow",t,a),d(e)};a.observe("click",function(e){h()&&u(e),e.stop()}),l.observe("click",d),repositorySearch.showUploadThemeConfirm=c,c(e,t)};var GenerateResource=function(e,t){this._resource=e,this._callback=t.okCallback,this._processTemplate(t);var i=this;repositorySearch.observe("resource:generated",function(){i._hide()})};GenerateResource.addVar("TEMPLATE_DOM_ID","generateResource"),GenerateResource.addVar("TEMPLATE_TITLE_TEXT",!1),GenerateResource.addVar("LABEL_MAX_LEN",94),GenerateResource.addVar("DESC_MAX_LEN",200),GenerateResource.addMethod("_processTemplate",function(e){this._dom=$(this.TEMPLATE_DOM_ID);var t=this._dom.select(".title")[0];this.TEMPLATE_TITLE_TEXT||(GenerateResource.prototype.TEMPLATE_TITLE_TEXT=t.innerHTML.strip()),t.update((this.TEMPLATE_TITLE_TEXT+" "+this._resource.label.truncate(50)).escapeHTML());var i=e.useDefaultLabel?this._resource.label+" "+repositorySearch.messages["dialog.generateResource.defaultNameSuffix"]:"";this._nameInput=this._dom.select("#generateResourceInputName")[0],this._nameInput.setValue(i),this._descriptionInput=this._dom.select("#generateResourceInputDescription")[0],this._descriptionInput.setValue(this._resource.description),this._tree=dynamicTree.createRepositoryTree("generateResourceFoldersTree",{providerId:"repositorySaveReportProvider",rootUri:repositorySearch.model.getRootFolderUri(),organizationId:localContext.rsInitOptions.organizationId,publicFolderUri:localContext.rsInitOptions.publicFolderUri,urlGetNode:"flow.html?_flowId=searchFlow&method=getNode",urlGetChildren:"flow.html?_flowId=searchFlow&method=getChildren"}),this._cancelButton=this._dom.select("#generateResourceBtnCancel")[0],this._okButton=this._dom.select("#generateResourceBtnCreate")[0],this._okAndRunButton=this._dom.select("#generateResourceBtnCreateAndRun")[0]}),GenerateResource.addMethod("_buttonClickHandler",function(e){var t=matchAny(e.element(),[layoutModule.BUTTON_PATTERN],!0);if(t==this._okButton||t==this._okAndRunButton){var i=this._nameInput.getValue(),s=this._descriptionInput.getValue();if(i.length<=this.LABEL_MAX_LEN&&s.length<=this.DESC_MAX_LEN){var o=this._tree.getSelectedNode();o||alert(repositorySearch.messages.ADH_162_NULL_SAVE_REPORT_FOLDER_MESSAGE),o.param.extra&&!o.param.extra.isWritable&&this.showAccessDenied(o.param.uri),this._callback&&this._callback({label:i,description:s,location:o.param.uri,overwrite:!1,run:t==this._okAndRunButton})}else{var r,n;i.length>this.LABEL_MAX_LEN?(r=repositorySearch.messages.ADH_1001_ADHOC_SAVE_REPORT_LABEL_ERROR,n=this.LABEL_MAX_LEN):s.length>this.DESC_MAX_LEN&&(r=repositorySearch.messages.ADH_1001_ADHOC_SAVE_REPORT_DESCRIPTION_ERROR,n=this.DESC_MAX_LEN),r&&alert(r.replace("{0}",n))}}t==this._cancelButton&&this._hide()}),GenerateResource.addMethod("_focusName",function(){this._nameInput.select(),this._nameInput.focus()}),GenerateResource.addMethod("_enableSave",function(e){this._okButton.disabled=!e,this._okAndRunButton.disabled=!e}),GenerateResource.addMethod("show",function(){var e=this;this._tree.showTreePrefetchNodes("/",function(){e._focusName()}),this._dom.observe("click",this._buttonClickHandler.bindAsEventListener(this)),dialogs.popup.show(this._dom),setTimeout(function(){e._focusName()},500)}),GenerateResource.addMethod("showAccessDenied",function(e){var t=repositorySearch.messages.ADH_1001_SERVER_REPOSITORY_ACCESS_DENIED;alert(t.replace("{0}",e))}),GenerateResource.addMethod("_hide",function(){dialogs.popup.hide(this._dom),this._dom.stopObserving("click")});